var cs=Object.defineProperty;var ms=(R,i,c)=>i in R?cs(R,i,{enumerable:!0,configurable:!0,writable:!0,value:c}):R[i]=c;var tt=(R,i,c)=>(ms(R,typeof i!="symbol"?i+"":i,c),c);import{g as Me,d as fe,o as u,c as g,a as l,p as re,r as O,i as Pe,A as Qt,y as at,B as xt,l as E,C as Ht,e as Q,b as t,k as e,w as s,F as _e,j as ye,m as Fe,t as _,X as es,x as wt,T as fs,D as gs,E as Se,G as yt,H as kt,I as vs,_ as Jt,h as F,n as o,f as _s,v as Re,J as me,K as Zt,L as Oe,M as ys,N as ze,O as bs,P as st,s as ts,z as xs}from"./index-61977f9a.js";import{_ as ss,a as Ce,b as Ve,T as ls}from"./TabsContent.vue_vue_type_script_setup_true_lang-7a82827a.js";import{c as Y,_ as de,a as X,b as K}from"./VirtualScroll.vue_vue_type_style_index_0_scoped_a66a9b3d_lang-c469ee38.js";import{A as ft}from"./AlbertaText-6ea44e06.js";import{A as ws,U as ks}from"./upload-dc43bd01.js";import{S as He,_ as he,E as ot}from"./CardDescription.vue_vue_type_script_setup_true_lang-0023089c.js";import{D as vt,T as hs}from"./trending-up-6e2d3461.js";import{_ as ie}from"./CardTitle.vue_vue_type_script_setup_true_lang-0bb35303.js";import{u as et,_ as q,a as pe,b as Je,c as We,d as Xe,S as $s,M as Rt,P as as,A as os,e as ns,f as Ke,g as Ze,h as Ye}from"./useFormat-be559ba8.js";import{F as ve}from"./file-text-b2c50311.js";import{B as bt}from"./building-880f0edd.js";import{D as we}from"./dollar-sign-179e4237.js";import{C as Ue}from"./calendar-aaa52559.js";import{U as Qe}from"./users-f13f2b3d.js";import{S as Cs,u as rs}from"./useGateMeetings-8a2a231a.js";import{C as ht}from"./clock-a6ff1643.js";import{_ as _t}from"./Badge.vue_vue_type_script_setup_true_lang-3121b11a.js";import{_ as I}from"./Label.vue_vue_type_script_setup_true_lang-ecf31867.js";import{M as Bt}from"./map-pin-31ff5a0e.js";import{P as ds}from"./plus-1536707d.js";/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=Me("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=Me("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=Me("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=Me("file-spreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=Me("git-compare",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=Me("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=Me("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=Me("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=Me("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=Me("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=Me("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=Me("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=Me("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),Ts=["value","placeholder","disabled","rows","cols"],Ne=fe({__name:"Textarea",props:{modelValue:{},placeholder:{},disabled:{type:Boolean},rows:{},cols:{}},emits:["update:modelValue"],setup(R){return(i,c)=>(u(),g("textarea",{value:i.modelValue,onInput:c[0]||(c[0]=b=>i.$emit("update:modelValue",b.target.value)),placeholder:i.placeholder,disabled:i.disabled,rows:i.rows,cols:i.cols,class:"flex min-h-[80px] w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},null,40,Ts))}}),Us=["aria-checked"],Yt=fe({__name:"Switch",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(R){return(i,c)=>(u(),g("button",{type:"button",class:re(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",i.modelValue?"bg-blue-600":"bg-gray-200"]),"aria-checked":i.modelValue,onClick:c[0]||(c[0]=b=>i.$emit("update:modelValue",!i.modelValue))},[l("span",{class:re(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",i.modelValue?"translate-x-5":"translate-x-0"])},null,2)],10,Us))}}),Is={class:"py-1"},nt=fe({__name:"DropdownMenu",setup(R,{expose:i}){const c=O(!1),b=O(),n=()=>{c.value=!c.value},M=()=>{c.value=!1},k=B=>{b.value&&!b.value.contains(B.target)&&M()};return Pe(()=>{document.addEventListener("click",k)}),Qt(()=>{document.removeEventListener("click",k)}),i({toggle:n,close:M}),(B,A)=>(u(),g("div",{class:"relative inline-block text-left",ref_key:"dropdownRef",ref:b},[at(B.$slots,"trigger",{toggle:n}),c.value?(u(),g("div",{key:0,class:"absolute right-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",onClick:A[0]||(A[0]=xt(()=>{},["stop"]))},[l("div",Is,[at(B.$slots,"default")])])):E("",!0)],512))}}),rt=fe({__name:"DropdownMenuTrigger",emits:["click"],setup(R){return(i,c)=>(u(),g("div",{onClick:c[0]||(c[0]=b=>i.$emit("click"))},[at(i.$slots,"default")]))}}),dt=fe({__name:"DropdownMenuContent",setup(R){return(i,c)=>(u(),g("div",null,[at(i.$slots,"default")]))}}),ce=fe({__name:"DropdownMenuItem",emits:["click"],setup(R){return(i,c)=>(u(),g("button",{class:"group flex w-full items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900",onClick:c[0]||(c[0]=b=>i.$emit("click"))},[at(i.$slots,"default")]))}}),Ns={class:"my-1 h-px bg-gray-200"},Ge=fe({__name:"DropdownMenuSeparator",setup(R){return(i,c)=>(u(),g("div",Ns))}}),Rs={key:0,class:"fixed top-4 right-4 z-50 space-y-2 max-w-sm"},Bs={class:"flex items-start"},Os={class:"flex-shrink-0"},Fs={class:"ml-3 flex-1"},Ls={class:"mt-1 text-sm text-gray-600"},Gs={key:0,class:"mt-3 flex space-x-2"},qs=["onClick"],zs={class:"ml-4 flex-shrink-0"},Hs=["onClick"],Js={key:0,class:"mt-3 w-full bg-gray-200 rounded-full h-1"},Ws=fe({__name:"NotificationContainer",setup(R){const{notifications:i,hasNotifications:c,removeNotification:b}=Ht(),n=O(new Map),M=h=>({success:Se,error:yt,warning:kt,info:vs})[h],k=h=>({success:"border-l-4 border-l-green-500",error:"border-l-4 border-l-red-500",warning:"border-l-4 border-l-yellow-500",info:"border-l-4 border-l-blue-500"})[h],B=h=>({success:"text-green-500",error:"text-red-500",warning:"text-yellow-500",info:"text-blue-500"})[h],A=h=>({success:"text-green-900",error:"text-red-900",warning:"text-yellow-900",info:"text-blue-900"})[h],V=(h,d)=>h==="primary"?{success:"bg-green-600 text-white hover:bg-green-700",error:"bg-red-600 text-white hover:bg-red-700",warning:"bg-yellow-600 text-white hover:bg-yellow-700",info:"bg-blue-600 text-white hover:bg-blue-700"}[d]:{success:"bg-green-100 text-green-700 hover:bg-green-200",error:"bg-red-100 text-red-700 hover:bg-red-200",warning:"bg-yellow-100 text-yellow-700 hover:bg-yellow-200",info:"bg-blue-100 text-blue-700 hover:bg-blue-200"}[d],L=h=>({success:"bg-green-500",error:"bg-red-500",warning:"bg-yellow-500",info:"bg-blue-500"})[h],Z=h=>{if(!h.duration||h.persistent)return 100;const d=Date.now()-h.createdAt.getTime();return Math.max(0,100-d/h.duration*100)},x=h=>{if(h.persistent||!h.duration)return;const d=setInterval(()=>{Date.now()-h.createdAt.getTime()>=h.duration&&(clearInterval(d),n.value.delete(h.id))},100);n.value.set(h.id,d)},a=O(null);return Pe(()=>{i.value.forEach(x),a.value=()=>{}}),Qt(()=>{n.value.forEach(h=>clearInterval(h)),n.value.clear(),a.value&&a.value()}),(h,d)=>(u(),Q(gs,{to:"body"},[t(c)?(u(),g("div",Rs,[e(fs,{name:"notification",tag:"div",class:"space-y-2"},{default:s(()=>[(u(!0),g(_e,null,ye(t(i),v=>(u(),g("div",{key:v.id,class:re(["bg-white rounded-lg shadow-lg border border-gray-200 p-4 min-w-80",k(v.type)])},[l("div",Bs,[l("div",Os,[(u(),Q(Fe(M(v.type)),{class:re(["h-5 w-5",B(v.type)])},null,8,["class"]))]),l("div",Fs,[l("h4",{class:re(["text-sm font-medium",A(v.type)])},_(v.title),3),l("p",Ls,_(v.message),1),v.actions&&v.actions.length>0?(u(),g("div",Gs,[(u(!0),g(_e,null,ye(v.actions,f=>(u(),g("button",{key:f.label,onClick:f.action,class:re(["text-xs font-medium px-3 py-1 rounded-md transition-colors",V(f.variant||"secondary",v.type)])},_(f.label),11,qs))),128))])):E("",!0)]),l("div",zs,[l("button",{onClick:f=>t(b)(v.id),class:"inline-flex text-gray-400 hover:text-gray-600 transition-colors"},[e(t(es),{class:"h-4 w-4"})],8,Hs)])]),!v.persistent&&v.duration?(u(),g("div",Js,[l("div",{class:re(["h-1 rounded-full transition-all duration-100 ease-linear",L(v.type)]),style:wt({width:Z(v)+"%"})},null,6)])):E("",!0)],2))),128))]),_:1})])):E("",!0)]))}}),Xs=Jt(Ws,[["__scopeId","data-v-fa319724"]]);function Wt(){const R=r=>({Overdue:"bg-red-100 text-red-800 border-red-200",Today:"bg-orange-100 text-orange-800 border-orange-200",Soon:"bg-yellow-100 text-yellow-800 border-yellow-200",Upcoming:"bg-blue-100 text-blue-800 border-blue-200",Completed:"bg-green-100 text-green-800 border-green-200",Cancelled:"bg-gray-100 text-gray-800 border-gray-200"})[r]||"bg-gray-100 text-gray-800 border-gray-200",i=r=>({draft:"bg-yellow-100 text-yellow-800 border-yellow-200",submitted:"bg-blue-100 text-blue-800 border-blue-200",approved:"bg-green-100 text-green-800 border-green-200",rejected:"bg-red-100 text-red-800 border-red-200",Draft:"bg-yellow-100 text-yellow-800 border-yellow-200",PendingApproval:"bg-blue-100 text-blue-800 border-blue-200",Approved:"bg-green-100 text-green-800 border-green-200",Rejected:"bg-red-100 text-red-800 border-red-200"})[r]||"bg-gray-100 text-gray-800 border-gray-200",c=r=>({active:"bg-green-100 text-green-800 border-green-200",planning:"bg-blue-100 text-blue-800 border-blue-200",design:"bg-purple-100 text-purple-800 border-purple-200",construction:"bg-orange-100 text-orange-800 border-orange-200",completion:"bg-green-100 text-green-800 border-green-200",on_hold:"bg-yellow-100 text-yellow-800 border-yellow-200",cancelled:"bg-red-100 text-red-800 border-red-200",completed:"bg-blue-100 text-blue-800 border-blue-200"})[r.toLowerCase()]||"bg-gray-100 text-gray-800 border-gray-200",b=r=>({pending:"bg-yellow-100 text-yellow-800 border-yellow-200",in_progress:"bg-blue-100 text-blue-800 border-blue-200",completed:"bg-green-100 text-green-800 border-green-200",blocked:"bg-red-100 text-red-800 border-red-200",cancelled:"bg-gray-100 text-gray-800 border-gray-200"})[r.toLowerCase()]||"bg-gray-100 text-gray-800 border-gray-200",n=r=>({high:"bg-red-100 text-red-800 border-red-200",medium:"bg-yellow-100 text-yellow-800 border-yellow-200",low:"bg-green-100 text-green-800 border-green-200",critical:"bg-red-200 text-red-900 border-red-300"})[r.toLowerCase()]||"bg-gray-100 text-gray-800 border-gray-200",M=r=>({Overdue:"AlertTriangle",Today:"Clock",Soon:"Calendar",Upcoming:"CalendarDays",Completed:"CheckCircle",Cancelled:"XCircle"})[r]||"Calendar",k=r=>({draft:"Edit",submitted:"Send",approved:"CheckCircle",rejected:"XCircle",Draft:"Edit",PendingApproval:"Send",Approved:"CheckCircle",Rejected:"XCircle"})[r]||"FileText",B=r=>({active:"Play",planning:"FileText",design:"Compass",construction:"Hammer",completion:"CheckCircle",on_hold:"Pause",cancelled:"XCircle",completed:"CheckCircle2"})[r.toLowerCase()]||"FileText",A=r=>({high:"ArrowUp",medium:"Minus",low:"ArrowDown",critical:"AlertTriangle"})[r.toLowerCase()]||"Minus",V=r=>({class:R(r),icon:M(r),text:r}),L=r=>({class:i(r),icon:k(r),text:r}),Z=r=>({class:c(r),icon:B(r),text:r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()}),x=r=>({class:n(r),icon:A(r),text:r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()}),a=()=>"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border",h=(r,T="project")=>{if(!r)return"bg-gray-100 text-gray-800";if(T==="meeting")return{scheduled:"bg-blue-100 text-blue-800",overdue:"bg-red-100 text-red-800",today:"bg-orange-100 text-orange-800",soon:"bg-yellow-100 text-yellow-800",upcoming:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800",rescheduled:"bg-yellow-100 text-yellow-800"}[r.toLowerCase()]||"bg-gray-100 text-gray-800";if(T==="version")return{draft:"bg-yellow-100 text-yellow-800",submitted:"bg-blue-100 text-blue-800",pending_approval:"bg-orange-100 text-orange-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"}[r.toLowerCase()]||"bg-gray-100 text-gray-800";if(T==="task")return{pending:"bg-yellow-100 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",blocked:"bg-red-100 text-red-800"}[r.toLowerCase()]||"bg-gray-100 text-gray-800";if(T!=="project"&&T!=="meeting"&&T!=="priority"&&T!=="version"&&T!=="task"&&T!=="workflow")return"bg-gray-100 text-gray-800";let P="";switch(T){case"workflow":P=b(r);break;case"priority":P=n(r);break;default:P=c(r)}return P.replace(/\s*border-\w+-\d+/g,"")},d=(r,T="project")=>{if(!r)return"â—";const P={active:"â–¶",planning:"ðŸ“‹",design:"ðŸŽ¨",construction:"ðŸ”¨",completion:"âœ…",on_hold:"â¸",cancelled:"âœ•",completed:"âœ“",overdue:"ðŸ”´",today:"ðŸŸ ",soon:"ðŸŸ¡",upcoming:"ðŸ”µ",scheduled:"ðŸ“…",rescheduled:"ðŸ”„",high:"ðŸ”´",medium:"ðŸŸ¡",low:"ðŸŸ¢",critical:"ðŸ”´",draft:"ðŸ“",submitted:"ðŸ“¤",pending_approval:"â³",approved:"âœ…",rejected:"âŒ",pending:"â³",in_progress:"ðŸ”„",blocked:"ðŸš«"},ne=r.toLowerCase();return(T==="meeting"||T==="task")&&ne==="completed"?"âœ…":T==="meeting"&&ne==="cancelled"?"âŒ":T!=="project"&&T!=="meeting"&&T!=="priority"&&T!=="version"&&T!=="task"&&T!=="workflow"?"â—":P[ne]||"â—"},v=r=>r?r.includes("_")?r.replace(/_/g," ").replace(/\b\w/g,T=>T.toUpperCase()):r.charAt(0).toUpperCase()+r.slice(1):"";return{getMeetingStatusClass:R,getVersionStatusClass:i,getProjectStatusClass:c,getWorkflowStatusClass:b,getPriorityClass:n,getMeetingStatusIcon:M,getVersionStatusIcon:k,getProjectStatusIcon:B,getPriorityIcon:A,getMeetingBadge:V,getVersionBadge:L,getProjectBadge:Z,getPriorityBadge:x,getBaseBadgeClass:a,getStatusClass:h,getStatusIcon:d,getStatusText:v,formatStatusBadge:(r,T="project")=>({text:v(r),class:h(r,T),icon:d(r,T)})}}const Ks={class:"flex items-center justify-between"},Zs={class:"flex items-center space-x-4"},Ys={class:"flex items-center space-x-2 mt-1"},Qs={key:0,class:"flex items-center space-x-2 ml-4"},el={class:"flex bg-gray-100 rounded-lg p-1"},tl={key:0,class:"ml-1 w-2 h-2 bg-orange-400 rounded-full"},sl={class:"flex items-center space-x-2"},ll={key:0,class:"flex items-center space-x-2"},al={key:1,class:"flex items-center space-x-2"},ol=fe({__name:"ProjectHeader",props:{project:{},viewMode:{},currentVersion:{},versionStatus:{},hasDraftVersion:{type:Boolean},hasSubmittedVersion:{type:Boolean},hasPendingChanges:{type:Boolean},canEdit:{type:Boolean},canViewDraft:{type:Boolean},canCreateDraft:{type:Boolean},canSubmitForApproval:{type:Boolean},canApprove:{type:Boolean},canDelete:{type:Boolean},userRole:{}},emits:["update:viewMode","create-draft","submit-for-approval","approve-version","reject-version","export-project","print-project","view-history","duplicate-project","delete-project"],setup(R,{emit:i}){const c=R,b=i;_s();const{getVersionStatusClass:n}=Wt(),M=A=>{b("update:viewMode",A)},k=F(()=>n(c.versionStatus)),B=F(()=>({draft:"Draft",submitted:"Pending Approval",approved:"Current",rejected:"Rejected"})[c.versionStatus]||"Current");return(A,V)=>(u(),g("div",Ks,[l("div",Zs,[e(t(Y),{variant:"outline",size:"sm",onClick:V[0]||(V[0]=L=>A.$router.back())},{default:s(()=>[e(t(ws),{class:"h-4 w-4 mr-2"}),V[12]||(V[12]=o(" Back to Projects ",-1))]),_:1,__:[12]}),l("div",null,[e(t(ft),{tag:"h1",size:"heading-xl",mb:"xs"},{default:s(()=>[o(_(A.project.name),1)]),_:1}),e(t(ft),{color:"secondary",mb:"xs"},{default:s(()=>[o(_(A.project.contractor)+" â€¢ "+_(A.project.phase),1)]),_:1}),l("div",Ys,[e(t(ft),{size:"body-s",color:"secondary"},{default:s(()=>V[13]||(V[13]=[o("Version:",-1)])),_:1,__:[13]}),e(t(ft),{size:"body-s"},{default:s(()=>[o(_(A.currentVersion),1)]),_:1}),l("span",{class:re(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",k.value])},_(B.value),3),A.hasDraftVersion&&A.canViewDraft?(u(),g("div",Qs,[V[15]||(V[15]=l("span",{class:"text-xs text-gray-500"},"View:",-1)),l("div",el,[l("button",{onClick:V[1]||(V[1]=L=>M("approved")),class:re([A.viewMode==="approved"?"bg-white shadow-sm":"text-gray-600","px-3 py-1 text-xs font-medium rounded-md transition-colors"])}," Approved ",2),l("button",{onClick:V[2]||(V[2]=L=>M("draft")),class:re([A.viewMode==="draft"?"bg-white shadow-sm":"text-gray-600","px-3 py-1 text-xs font-medium rounded-md transition-colors"])},[V[14]||(V[14]=o(" Draft ",-1)),A.hasPendingChanges?(u(),g("span",tl)):E("",!0)],2)])])):E("",!0)])])]),l("div",sl,[A.canEdit?(u(),g("div",ll,[!A.hasDraftVersion&&A.canCreateDraft?(u(),Q(t(Y),{key:0,variant:"outline",size:"sm",onClick:V[3]||(V[3]=L=>A.$emit("create-draft"))},{default:s(()=>[e(t(He),{class:"h-4 w-4 mr-2"}),V[16]||(V[16]=o(" Create Draft ",-1))]),_:1,__:[16]})):E("",!0),A.hasDraftVersion&&A.canSubmitForApproval?(u(),Q(t(Y),{key:1,variant:"default",size:"sm",onClick:V[4]||(V[4]=L=>A.$emit("submit-for-approval"))},{default:s(()=>[e(t(Ot),{class:"h-4 w-4 mr-2"}),V[17]||(V[17]=o(" Submit for Approval ",-1))]),_:1,__:[17]})):E("",!0)])):E("",!0),A.canApprove&&A.hasSubmittedVersion?(u(),g("div",al,[e(t(Y),{variant:"outline",size:"sm",onClick:V[5]||(V[5]=L=>A.$emit("reject-version"))},{default:s(()=>[e(t(yt),{class:"h-4 w-4 mr-2"}),V[18]||(V[18]=o(" Reject ",-1))]),_:1,__:[18]}),e(t(Y),{variant:"default",size:"sm",onClick:V[6]||(V[6]=L=>A.$emit("approve-version"))},{default:s(()=>[e(t(Se),{class:"h-4 w-4 mr-2"}),V[19]||(V[19]=o(" Approve ",-1))]),_:1,__:[19]})])):E("",!0),e(t(nt),null,{default:s(()=>[e(t(rt),{asChild:""},{default:s(()=>[e(t(Y),{variant:"outline",size:"sm"},{default:s(()=>[e(t($t),{class:"h-4 w-4"})]),_:1})]),_:1}),e(t(dt),{align:"end"},{default:s(()=>[e(t(ce),{onClick:V[7]||(V[7]=L=>A.$emit("export-project"))},{default:s(()=>[e(t(vt),{class:"h-4 w-4 mr-2"}),V[20]||(V[20]=o(" Export Project ",-1))]),_:1,__:[20]}),e(t(ce),{onClick:V[8]||(V[8]=L=>A.$emit("print-project"))},{default:s(()=>[e(t(Es),{class:"h-4 w-4 mr-2"}),V[21]||(V[21]=o(" Print Project ",-1))]),_:1,__:[21]}),e(t(Ge)),e(t(ce),{onClick:V[9]||(V[9]=L=>A.$emit("view-history"))},{default:s(()=>[e(t(Ds),{class:"h-4 w-4 mr-2"}),V[22]||(V[22]=o(" View History ",-1))]),_:1,__:[22]}),e(t(ce),{onClick:V[10]||(V[10]=L=>A.$emit("duplicate-project"))},{default:s(()=>[e(t(js),{class:"h-4 w-4 mr-2"}),V[23]||(V[23]=o(" Duplicate Project ",-1))]),_:1,__:[23]}),A.canDelete?(u(),Q(t(Ge),{key:0})):E("",!0),A.canDelete?(u(),Q(t(ce),{key:1,onClick:V[11]||(V[11]=L=>A.$emit("delete-project")),class:"text-red-600"},{default:s(()=>[e(t(Vt),{class:"h-4 w-4 mr-2"}),V[24]||(V[24]=o(" Delete Project ",-1))]),_:1,__:[24]})):E("",!0)]),_:1})]),_:1})])]))}}),nl={class:"space-y-6"},rl={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},dl={class:"flex items-center space-x-2"},il={class:"text-lg font-semibold"},ul={class:"text-2xl font-bold"},pl={class:"text-2xl font-bold"},cl={class:"flex items-center space-x-1 mt-1"},ml={class:"w-full bg-gray-200 rounded-full h-2"},fl={class:"text-xs text-muted-foreground"},gl={class:"text-lg font-semibold"},vl={class:"text-gray-700 leading-relaxed"},_l={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},yl={class:"grid grid-cols-2 gap-4"},bl={class:"text-sm text-gray-900"},xl={class:"text-sm text-gray-900"},wl={class:"text-sm text-gray-900"},kl={class:"text-sm text-gray-900"},hl={class:"grid grid-cols-2 gap-4"},$l={class:"text-sm text-gray-900"},Cl={class:"text-sm text-gray-900"},Vl={key:0},jl={class:"text-sm text-gray-900"},Sl={key:1},Ml={class:"text-sm text-gray-900"},Dl={class:"space-y-3"},El={class:"flex-shrink-0"},Al={class:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center"},Pl={class:"flex-1 min-w-0"},Tl={class:"text-sm text-gray-900"},Ul={class:"text-xs text-gray-500"},Il=fe({__name:"OverviewTab",props:{project:{},recentActivity:{default:()=>[]}},setup(R){const i=R,{formatCurrency:c,formatDate:b,formatRelativeTime:n,formatStatus:M,formatProjectPhase:k}=et(),{getProjectStatusIcon:B}=Wt(),A=F(()=>!i.project.total_approved_funding||!i.project.amount_spent?0:Math.round(i.project.amount_spent/i.project.total_approved_funding*100)),V=F(()=>B(i.project.status)),L=F(()=>({active:"text-green-600",planning:"text-blue-600",design:"text-purple-600",construction:"text-orange-600",completion:"text-green-600",on_hold:"text-yellow-600",cancelled:"text-red-600",completed:"text-gray-600"})[i.project.status.toLowerCase()]||"text-gray-600"),Z=x=>({project_created:bt,budget_updated:we,meeting_scheduled:Ue,document_uploaded:ve,team_updated:Qe,status_changed:Cs,milestone_completed:Se,deadline_approaching:ht,issue_reported:kt})[x]||ve;return(x,a)=>(u(),g("div",nl,[l("div",rl,[e(t(K),null,{default:s(()=>[e(t(de),{class:"pb-2"},{default:s(()=>[e(t(ie),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>a[0]||(a[0]=[o("Project Status",-1)])),_:1,__:[0]})]),_:1}),e(t(X),null,{default:s(()=>[l("div",dl,[(u(),Q(Fe(V.value),{class:re(["h-5 w-5",L.value])},null,8,["class"])),l("span",il,_(t(M)(x.project.status)),1)])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),{class:"pb-2"},{default:s(()=>[e(t(ie),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>a[1]||(a[1]=[o("Total Budget",-1)])),_:1,__:[1]})]),_:1}),e(t(X),null,{default:s(()=>[l("div",ul,_(t(c)(x.project.total_approved_funding||0)),1),a[2]||(a[2]=l("p",{class:"text-xs text-muted-foreground"},"Approved funding",-1))]),_:1,__:[2]})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),{class:"pb-2"},{default:s(()=>[e(t(ie),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>a[3]||(a[3]=[o("Amount Spent",-1)])),_:1,__:[3]})]),_:1}),e(t(X),null,{default:s(()=>[l("div",pl,_(t(c)(x.project.amount_spent||0)),1),l("div",cl,[l("div",ml,[l("div",{class:"bg-blue-600 h-2 rounded-full",style:wt({width:`${A.value}%`})},null,4)]),l("span",fl,_(A.value)+"%",1)])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),{class:"pb-2"},{default:s(()=>[e(t(ie),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>a[4]||(a[4]=[o("Project Phase",-1)])),_:1,__:[4]})]),_:1}),e(t(X),null,{default:s(()=>[l("div",gl,_(t(k)(x.project.project_phase)),1),a[5]||(a[5]=l("p",{class:"text-xs text-muted-foreground"},"Current phase",-1))]),_:1,__:[5]})]),_:1})]),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>a[6]||(a[6]=[o("Project Description",-1)])),_:1,__:[6]})]),_:1}),e(t(X),null,{default:s(()=>[l("p",vl,_(x.project.description||"No description available."),1)]),_:1})]),_:1}),l("div",_l,[e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>a[7]||(a[7]=[o("Project Details",-1)])),_:1,__:[7]})]),_:1}),e(t(X),{class:"space-y-4"},{default:s(()=>[l("div",yl,[l("div",null,[a[8]||(a[8]=l("label",{class:"text-sm font-medium text-gray-500"},"Category",-1)),l("p",bl,_(x.project.category||"Not specified"),1)]),l("div",null,[a[9]||(a[9]=l("label",{class:"text-sm font-medium text-gray-500"},"Ministry",-1)),l("p",xl,_(x.project.ministry||"Not specified"),1)]),l("div",null,[a[10]||(a[10]=l("label",{class:"text-sm font-medium text-gray-500"},"Region",-1)),l("p",wl,_(x.project.region||"Not specified"),1)]),l("div",null,[a[11]||(a[11]=l("label",{class:"text-sm font-medium text-gray-500"},"Project Manager",-1)),l("p",kl,_(x.project.project_manager_name||"Not assigned"),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>a[12]||(a[12]=[o("Timeline",-1)])),_:1,__:[12]})]),_:1}),e(t(X),{class:"space-y-4"},{default:s(()=>[l("div",hl,[l("div",null,[a[13]||(a[13]=l("label",{class:"text-sm font-medium text-gray-500"},"Created",-1)),l("p",$l,_(t(b)(x.project.created_at)),1)]),l("div",null,[a[14]||(a[14]=l("label",{class:"text-sm font-medium text-gray-500"},"Last Updated",-1)),l("p",Cl,_(t(b)(x.project.updated_at)),1)]),x.project.start_date?(u(),g("div",Vl,[a[15]||(a[15]=l("label",{class:"text-sm font-medium text-gray-500"},"Start Date",-1)),l("p",jl,_(t(b)(x.project.start_date)),1)])):E("",!0),x.project.end_date?(u(),g("div",Sl,[a[16]||(a[16]=l("label",{class:"text-sm font-medium text-gray-500"},"End Date",-1)),l("p",Ml,_(t(b)(x.project.end_date)),1)])):E("",!0)])]),_:1})]),_:1})]),x.recentActivity.length>0?(u(),Q(t(K),{key:0},{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>a[17]||(a[17]=[o("Recent Activity",-1)])),_:1,__:[17]})]),_:1}),e(t(X),null,{default:s(()=>[l("div",Dl,[(u(!0),g(_e,null,ye(x.recentActivity,h=>(u(),g("div",{key:h.id,class:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg"},[l("div",El,[l("div",Al,[(u(),Q(Fe(Z(h.type)),{class:"h-4 w-4 text-blue-600"}))])]),l("div",Pl,[l("p",Tl,_(h.description),1),l("p",Ul,_(t(n)(h.created_at)),1)])]))),128))])]),_:1})]),_:1})):E("",!0)]))}}),Nl={class:"space-y-6"},Rl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Bl={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Ol={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Fl={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Ll={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Gl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ql={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},zl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Hl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Jl={class:"flex items-center space-x-2"},Wl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Xl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Kl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Zl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Yl={class:"flex items-center space-x-2"},Ql={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ea={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ta={class:"mt-1"},sa={class:"mt-1 text-sm text-gray-600"},la={key:0},aa={key:1},oa={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},na={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ra={key:0},da={key:0,class:"flex items-center justify-end space-x-2"},ia=fe({__name:"DetailsTab",props:{project:{},viewMode:{},canEdit:{type:Boolean}},emits:["update:project","save-changes"],setup(R,{emit:i}){const c=R,b=i,n=O({...c.project}),M=O({...c.project}),k=F(()=>JSON.stringify(n.value)!==JSON.stringify(M.value)),B=()=>{n.value={...M.value}},A=()=>{const x={};Object.keys(n.value).forEach(a=>{n.value[a]!==M.value[a]&&(x[a]=n.value[a])}),b("save-changes",x),M.value={...n.value}},V=x=>x?new Date(x).toLocaleDateString():"N/A",L=x=>x?x.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"Not Set",Z=x=>{switch(x){case"approved":return"default";case"pending_review":return"secondary";case"update_required":return"destructive";default:return"outline"}};return Re(()=>c.project,x=>{n.value={...x},M.value={...x}},{deep:!0}),Re(n,x=>{b("update:project",{...x})},{deep:!0}),Pe(()=>{n.value={...c.project},M.value={...c.project}}),(x,a)=>{const h=me("SelectValue"),d=me("SelectTrigger"),v=me("SelectItem"),f=me("SelectContent");return u(),g("div",Nl,[e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>a[41]||(a[41]=[o("Project Information",-1)])),_:1,__:[41]}),x.canEdit?(u(),Q(t(he),{key:1},{default:s(()=>[o(" Edit project details and specifications. Changes will be saved to "+_(x.viewMode==="draft"?"draft version":"current version")+". ",1)]),_:1})):(u(),Q(t(he),{key:0},{default:s(()=>a[42]||(a[42]=[o(" View detailed project information and specifications. ",-1)])),_:1,__:[42]}))]),_:1}),e(t(X),{class:"space-y-6"},{default:s(()=>[l("div",Rl,[l("div",null,[e(t(I),{for:"project-name"},{default:s(()=>a[43]||(a[43]=[o("Project Name *",-1)])),_:1,__:[43]}),e(t(q),{id:"project-name",modelValue:n.value.name,"onUpdate:modelValue":a[0]||(a[0]=r=>n.value.name=r),disabled:!x.canEdit,placeholder:"Enter project name",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"project-code"},{default:s(()=>a[44]||(a[44]=[o("Project Code",-1)])),_:1,__:[44]}),e(t(q),{id:"project-code",modelValue:n.value.project_code,"onUpdate:modelValue":a[1]||(a[1]=r=>n.value.project_code=r),disabled:!x.canEdit,placeholder:"Auto-generated or custom code",class:"mt-1"},null,8,["modelValue","disabled"])])]),l("div",null,[e(t(I),{for:"description"},{default:s(()=>a[45]||(a[45]=[o("Project Description",-1)])),_:1,__:[45]}),e(t(Ne),{id:"description",modelValue:n.value.description,"onUpdate:modelValue":a[2]||(a[2]=r=>n.value.description=r),disabled:!x.canEdit,placeholder:"Detailed project description...",rows:"4",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",Bl,[l("div",null,[e(t(I),{for:"category"},{default:s(()=>a[46]||(a[46]=[o("Category",-1)])),_:1,__:[46]}),e(t(pe),{modelValue:n.value.category,"onUpdate:modelValue":a[3]||(a[3]=r=>n.value.category=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select category"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"infrastructure"},{default:s(()=>a[47]||(a[47]=[o("Infrastructure",-1)])),_:1,__:[47]}),e(v,{value:"healthcare"},{default:s(()=>a[48]||(a[48]=[o("Healthcare",-1)])),_:1,__:[48]}),e(v,{value:"education"},{default:s(()=>a[49]||(a[49]=[o("Education",-1)])),_:1,__:[49]}),e(v,{value:"justice"},{default:s(()=>a[50]||(a[50]=[o("Justice",-1)])),_:1,__:[50]}),e(v,{value:"transportation"},{default:s(()=>a[51]||(a[51]=[o("Transportation",-1)])),_:1,__:[51]}),e(v,{value:"environment"},{default:s(()=>a[52]||(a[52]=[o("Environment",-1)])),_:1,__:[52]}),e(v,{value:"other"},{default:s(()=>a[53]||(a[53]=[o("Other",-1)])),_:1,__:[53]})]),_:1})]),_:1},8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"ministry"},{default:s(()=>a[54]||(a[54]=[o("Ministry",-1)])),_:1,__:[54]}),e(t(pe),{modelValue:n.value.ministry,"onUpdate:modelValue":a[4]||(a[4]=r=>n.value.ministry=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select ministry"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"infrastructure"},{default:s(()=>a[55]||(a[55]=[o("Infrastructure",-1)])),_:1,__:[55]}),e(v,{value:"health"},{default:s(()=>a[56]||(a[56]=[o("Health",-1)])),_:1,__:[56]}),e(v,{value:"education"},{default:s(()=>a[57]||(a[57]=[o("Education",-1)])),_:1,__:[57]}),e(v,{value:"justice"},{default:s(()=>a[58]||(a[58]=[o("Justice and Solicitor General",-1)])),_:1,__:[58]}),e(v,{value:"transportation"},{default:s(()=>a[59]||(a[59]=[o("Transportation and Economic Corridors",-1)])),_:1,__:[59]}),e(v,{value:"environment"},{default:s(()=>a[60]||(a[60]=[o("Environment and Protected Areas",-1)])),_:1,__:[60]}),e(v,{value:"municipal"},{default:s(()=>a[61]||(a[61]=[o("Municipal Affairs",-1)])),_:1,__:[61]})]),_:1})]),_:1},8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"region"},{default:s(()=>a[62]||(a[62]=[o("Region",-1)])),_:1,__:[62]}),e(t(pe),{modelValue:n.value.region,"onUpdate:modelValue":a[5]||(a[5]=r=>n.value.region=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select region"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"calgary"},{default:s(()=>a[63]||(a[63]=[o("Calgary",-1)])),_:1,__:[63]}),e(v,{value:"edmonton"},{default:s(()=>a[64]||(a[64]=[o("Edmonton",-1)])),_:1,__:[64]}),e(v,{value:"central"},{default:s(()=>a[65]||(a[65]=[o("Central",-1)])),_:1,__:[65]}),e(v,{value:"north"},{default:s(()=>a[66]||(a[66]=[o("North",-1)])),_:1,__:[66]}),e(v,{value:"south"},{default:s(()=>a[67]||(a[67]=[o("South",-1)])),_:1,__:[67]}),e(v,{value:"provincial"},{default:s(()=>a[68]||(a[68]=[o("Provincial",-1)])),_:1,__:[68]})]),_:1})]),_:1},8,["modelValue","disabled"])])]),l("div",Ol,[l("div",null,[e(t(I),{for:"status"},{default:s(()=>a[69]||(a[69]=[o("Project Status",-1)])),_:1,__:[69]}),e(t(pe),{modelValue:n.value.status,"onUpdate:modelValue":a[6]||(a[6]=r=>n.value.status=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select status"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"planning"},{default:s(()=>a[70]||(a[70]=[o("Planning",-1)])),_:1,__:[70]}),e(v,{value:"design"},{default:s(()=>a[71]||(a[71]=[o("Design",-1)])),_:1,__:[71]}),e(v,{value:"construction"},{default:s(()=>a[72]||(a[72]=[o("Construction",-1)])),_:1,__:[72]}),e(v,{value:"completion"},{default:s(()=>a[73]||(a[73]=[o("Completion",-1)])),_:1,__:[73]}),e(v,{value:"on_hold"},{default:s(()=>a[74]||(a[74]=[o("On Hold",-1)])),_:1,__:[74]}),e(v,{value:"cancelled"},{default:s(()=>a[75]||(a[75]=[o("Cancelled",-1)])),_:1,__:[75]}),e(v,{value:"completed"},{default:s(()=>a[76]||(a[76]=[o("Completed",-1)])),_:1,__:[76]})]),_:1})]),_:1},8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"phase"},{default:s(()=>a[77]||(a[77]=[o("Project Phase",-1)])),_:1,__:[77]}),e(t(pe),{modelValue:n.value.project_phase,"onUpdate:modelValue":a[7]||(a[7]=r=>n.value.project_phase=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select phase"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"initiation"},{default:s(()=>a[78]||(a[78]=[o("Initiation",-1)])),_:1,__:[78]}),e(v,{value:"planning"},{default:s(()=>a[79]||(a[79]=[o("Planning",-1)])),_:1,__:[79]}),e(v,{value:"design"},{default:s(()=>a[80]||(a[80]=[o("Design",-1)])),_:1,__:[80]}),e(v,{value:"procurement"},{default:s(()=>a[81]||(a[81]=[o("Procurement",-1)])),_:1,__:[81]}),e(v,{value:"construction"},{default:s(()=>a[82]||(a[82]=[o("Construction",-1)])),_:1,__:[82]}),e(v,{value:"commissioning"},{default:s(()=>a[83]||(a[83]=[o("Commissioning",-1)])),_:1,__:[83]}),e(v,{value:"closeout"},{default:s(()=>a[84]||(a[84]=[o("Closeout",-1)])),_:1,__:[84]})]),_:1})]),_:1},8,["modelValue","disabled"])])]),l("div",Fl,[l("div",null,[e(t(I),{for:"start-date"},{default:s(()=>a[85]||(a[85]=[o("Start Date",-1)])),_:1,__:[85]}),e(t(q),{id:"start-date",modelValue:n.value.start_date,"onUpdate:modelValue":a[8]||(a[8]=r=>n.value.start_date=r),disabled:!x.canEdit,type:"date",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"end-date"},{default:s(()=>a[86]||(a[86]=[o("End Date",-1)])),_:1,__:[86]}),e(t(q),{id:"end-date",modelValue:n.value.end_date,"onUpdate:modelValue":a[9]||(a[9]=r=>n.value.end_date=r),disabled:!x.canEdit,type:"date",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"completion-date"},{default:s(()=>a[87]||(a[87]=[o("Actual Completion Date",-1)])),_:1,__:[87]}),e(t(q),{id:"completion-date",modelValue:n.value.completion_date,"onUpdate:modelValue":a[10]||(a[10]=r=>n.value.completion_date=r),disabled:!x.canEdit,type:"date",class:"mt-1"},null,8,["modelValue","disabled"])])]),l("div",Ll,[l("div",null,[e(t(I),{for:"priority"},{default:s(()=>a[88]||(a[88]=[o("Priority Level",-1)])),_:1,__:[88]}),e(t(pe),{modelValue:n.value.priority,"onUpdate:modelValue":a[11]||(a[11]=r=>n.value.priority=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select priority"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"low"},{default:s(()=>a[89]||(a[89]=[o("Low",-1)])),_:1,__:[89]}),e(v,{value:"medium"},{default:s(()=>a[90]||(a[90]=[o("Medium",-1)])),_:1,__:[90]}),e(v,{value:"high"},{default:s(()=>a[91]||(a[91]=[o("High",-1)])),_:1,__:[91]}),e(v,{value:"critical"},{default:s(()=>a[92]||(a[92]=[o("Critical",-1)])),_:1,__:[92]})]),_:1})]),_:1},8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"risk-level"},{default:s(()=>a[93]||(a[93]=[o("Risk Level",-1)])),_:1,__:[93]}),e(t(pe),{modelValue:n.value.risk_level,"onUpdate:modelValue":a[12]||(a[12]=r=>n.value.risk_level=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select risk level"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"low"},{default:s(()=>a[94]||(a[94]=[o("Low",-1)])),_:1,__:[94]}),e(v,{value:"medium"},{default:s(()=>a[95]||(a[95]=[o("Medium",-1)])),_:1,__:[95]}),e(v,{value:"high"},{default:s(()=>a[96]||(a[96]=[o("High",-1)])),_:1,__:[96]}),e(v,{value:"critical"},{default:s(()=>a[97]||(a[97]=[o("Critical",-1)])),_:1,__:[97]})]),_:1})]),_:1},8,["modelValue","disabled"])])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>a[98]||(a[98]=[o("Approval & Identification",-1)])),_:1,__:[98]}),e(t(he),null,{default:s(()=>a[99]||(a[99]=[o(" Project approval details and identification numbers. ",-1)])),_:1,__:[99]})]),_:1}),e(t(X),{class:"space-y-6"},{default:s(()=>[l("div",Gl,[l("div",null,[e(t(I),{for:"approval-year"},{default:s(()=>a[100]||(a[100]=[o("Approval Year",-1)])),_:1,__:[100]}),e(t(q),{id:"approval-year",modelValue:n.value.approval_year,"onUpdate:modelValue":a[13]||(a[13]=r=>n.value.approval_year=r),disabled:!x.canEdit,type:"number",min:"2000",max:"2050",placeholder:"e.g., 2024",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"cpd-number"},{default:s(()=>a[101]||(a[101]=[o("CPD Number",-1)])),_:1,__:[101]}),e(t(q),{id:"cpd-number",modelValue:n.value.cpd_number,"onUpdate:modelValue":a[14]||(a[14]=r=>n.value.cpd_number=r),disabled:!x.canEdit,placeholder:"Enter CPD number",class:"mt-1"},null,8,["modelValue","disabled"])])]),l("div",null,[e(t(I),{for:"capital-plan-line"},{default:s(()=>a[102]||(a[102]=[o("Capital Plan Line",-1)])),_:1,__:[102]}),e(t(pe),{modelValue:n.value.capital_plan_line_id,"onUpdate:modelValue":a[15]||(a[15]=r=>n.value.capital_plan_line_id=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select capital plan line"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"loading",disabled:""},{default:s(()=>a[103]||(a[103]=[o("Loading capital plan lines...",-1)])),_:1,__:[103]})]),_:1})]),_:1},8,["modelValue","disabled"])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>a[104]||(a[104]=[o("Project Classification",-1)])),_:1,__:[104]}),e(t(he),null,{default:s(()=>a[105]||(a[105]=[o(" Detailed project classification and delivery information. ",-1)])),_:1,__:[105]})]),_:1}),e(t(X),{class:"space-y-6"},{default:s(()=>[l("div",ql,[l("div",null,[e(t(I),{for:"project-type"},{default:s(()=>a[106]||(a[106]=[o("Project Type",-1)])),_:1,__:[106]}),e(t(pe),{modelValue:n.value.project_type,"onUpdate:modelValue":a[16]||(a[16]=r=>n.value.project_type=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select project type"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"new_construction"},{default:s(()=>a[107]||(a[107]=[o("New Construction",-1)])),_:1,__:[107]}),e(v,{value:"renovation"},{default:s(()=>a[108]||(a[108]=[o("Renovation",-1)])),_:1,__:[108]}),e(v,{value:"expansion"},{default:s(()=>a[109]||(a[109]=[o("Expansion",-1)])),_:1,__:[109]}),e(v,{value:"replacement"},{default:s(()=>a[110]||(a[110]=[o("Replacement",-1)])),_:1,__:[110]}),e(v,{value:"maintenance"},{default:s(()=>a[111]||(a[111]=[o("Major Maintenance",-1)])),_:1,__:[111]}),e(v,{value:"infrastructure"},{default:s(()=>a[112]||(a[112]=[o("Infrastructure",-1)])),_:1,__:[112]}),e(v,{value:"other"},{default:s(()=>a[113]||(a[113]=[o("Other",-1)])),_:1,__:[113]})]),_:1})]),_:1},8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"delivery-type"},{default:s(()=>a[114]||(a[114]=[o("Delivery Type",-1)])),_:1,__:[114]}),e(t(pe),{modelValue:n.value.delivery_type,"onUpdate:modelValue":a[17]||(a[17]=r=>n.value.delivery_type=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select delivery type"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"traditional"},{default:s(()=>a[115]||(a[115]=[o("Traditional",-1)])),_:1,__:[115]}),e(v,{value:"design_build"},{default:s(()=>a[116]||(a[116]=[o("Design-Build",-1)])),_:1,__:[116]}),e(v,{value:"p3"},{default:s(()=>a[117]||(a[117]=[o("P3 (Public-Private Partnership)",-1)])),_:1,__:[117]}),e(v,{value:"cm_at_risk"},{default:s(()=>a[118]||(a[118]=[o("CM at Risk",-1)])),_:1,__:[118]}),e(v,{value:"integrated"},{default:s(()=>a[119]||(a[119]=[o("Integrated Project Delivery",-1)])),_:1,__:[119]}),e(v,{value:"other"},{default:s(()=>a[120]||(a[120]=[o("Other",-1)])),_:1,__:[120]})]),_:1})]),_:1},8,["modelValue","disabled"])])]),l("div",zl,[l("div",null,[e(t(I),{for:"specific-delivery-type"},{default:s(()=>a[121]||(a[121]=[o("Specific Delivery Type",-1)])),_:1,__:[121]}),e(t(pe),{modelValue:n.value.specific_delivery_type,"onUpdate:modelValue":a[18]||(a[18]=r=>n.value.specific_delivery_type=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select specific delivery type"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"lump_sum"},{default:s(()=>a[122]||(a[122]=[o("Lump Sum",-1)])),_:1,__:[122]}),e(v,{value:"unit_price"},{default:s(()=>a[123]||(a[123]=[o("Unit Price",-1)])),_:1,__:[123]}),e(v,{value:"cost_plus"},{default:s(()=>a[124]||(a[124]=[o("Cost Plus",-1)])),_:1,__:[124]}),e(v,{value:"guaranteed_maximum"},{default:s(()=>a[125]||(a[125]=[o("Guaranteed Maximum Price",-1)])),_:1,__:[125]}),e(v,{value:"other"},{default:s(()=>a[126]||(a[126]=[o("Other",-1)])),_:1,__:[126]})]),_:1})]),_:1},8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"delivery-method"},{default:s(()=>a[127]||(a[127]=[o("Delivery Method",-1)])),_:1,__:[127]}),e(t(pe),{modelValue:n.value.delivery_method,"onUpdate:modelValue":a[19]||(a[19]=r=>n.value.delivery_method=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select delivery method"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"competitive_bid"},{default:s(()=>a[128]||(a[128]=[o("Competitive Bid",-1)])),_:1,__:[128]}),e(v,{value:"negotiated"},{default:s(()=>a[129]||(a[129]=[o("Negotiated",-1)])),_:1,__:[129]}),e(v,{value:"sole_source"},{default:s(()=>a[130]||(a[130]=[o("Sole Source",-1)])),_:1,__:[130]}),e(v,{value:"request_for_proposal"},{default:s(()=>a[131]||(a[131]=[o("Request for Proposal",-1)])),_:1,__:[131]}),e(v,{value:"other"},{default:s(()=>a[132]||(a[132]=[o("Other",-1)])),_:1,__:[132]})]),_:1})]),_:1},8,["modelValue","disabled"])])]),l("div",Hl,[l("div",null,[e(t(I),{for:"program"},{default:s(()=>a[133]||(a[133]=[o("Program",-1)])),_:1,__:[133]}),e(t(q),{id:"program",modelValue:n.value.program,"onUpdate:modelValue":a[20]||(a[20]=r=>n.value.program=r),disabled:!x.canEdit,placeholder:"Enter program name",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"geographic-region"},{default:s(()=>a[134]||(a[134]=[o("Geographic Region",-1)])),_:1,__:[134]}),e(t(pe),{modelValue:n.value.geographic_region,"onUpdate:modelValue":a[21]||(a[21]=r=>n.value.geographic_region=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select geographic region"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"calgary_region"},{default:s(()=>a[135]||(a[135]=[o("Calgary Region",-1)])),_:1,__:[135]}),e(v,{value:"edmonton_region"},{default:s(()=>a[136]||(a[136]=[o("Edmonton Region",-1)])),_:1,__:[136]}),e(v,{value:"central_alberta"},{default:s(()=>a[137]||(a[137]=[o("Central Alberta",-1)])),_:1,__:[137]}),e(v,{value:"northern_alberta"},{default:s(()=>a[138]||(a[138]=[o("Northern Alberta",-1)])),_:1,__:[138]}),e(v,{value:"southern_alberta"},{default:s(()=>a[139]||(a[139]=[o("Southern Alberta",-1)])),_:1,__:[139]}),e(v,{value:"provincial"},{default:s(()=>a[140]||(a[140]=[o("Provincial",-1)])),_:1,__:[140]})]),_:1})]),_:1},8,["modelValue","disabled"])])]),l("div",Jl,[e(t(Yt),{id:"funded-to-complete",checked:n.value.funded_to_complete,"onUpdate:checked":a[22]||(a[22]=r=>n.value.funded_to_complete=r),disabled:!x.canEdit},null,8,["checked","disabled"]),e(t(I),{for:"funded-to-complete"},{default:s(()=>a[141]||(a[141]=[o("Funded to Complete",-1)])),_:1,__:[141]})])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>a[142]||(a[142]=[o("Government & School Associations",-1)])),_:1,__:[142]}),e(t(he),null,{default:s(()=>a[143]||(a[143]=[o(" Ministry and school jurisdiction associations for this project. ",-1)])),_:1,__:[143]})]),_:1}),e(t(X),{class:"space-y-6"},{default:s(()=>[l("div",Wl,[l("div",null,[e(t(I),{for:"client-ministry"},{default:s(()=>a[144]||(a[144]=[o("Client Ministry",-1)])),_:1,__:[144]}),e(t(pe),{modelValue:n.value.client_ministry_id,"onUpdate:modelValue":a[23]||(a[23]=r=>n.value.client_ministry_id=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select client ministry"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"loading",disabled:""},{default:s(()=>a[145]||(a[145]=[o("Loading ministries...",-1)])),_:1,__:[145]})]),_:1})]),_:1},8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"school-jurisdiction"},{default:s(()=>a[146]||(a[146]=[o("School Jurisdiction",-1)])),_:1,__:[146]}),e(t(pe),{modelValue:n.value.school_jurisdiction_id,"onUpdate:modelValue":a[24]||(a[24]=r=>n.value.school_jurisdiction_id=r),disabled:!x.canEdit},{default:s(()=>[e(d,{class:"mt-1"},{default:s(()=>[e(h,{placeholder:"Select school jurisdiction"})]),_:1}),e(f,null,{default:s(()=>[e(v,{value:"loading",disabled:""},{default:s(()=>a[147]||(a[147]=[o("Loading jurisdictions...",-1)])),_:1,__:[147]})]),_:1})]),_:1},8,["modelValue","disabled"])])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>a[148]||(a[148]=[o("Facility Metrics",-1)])),_:1,__:[148]}),e(t(he),null,{default:s(()=>a[149]||(a[149]=[o(" Facility-specific measurements and capacity information. ",-1)])),_:1,__:[149]})]),_:1}),e(t(X),{class:"space-y-6"},{default:s(()=>[l("div",Xl,[l("div",null,[e(t(I),{for:"number-of-beds"},{default:s(()=>a[150]||(a[150]=[o("Number of Beds",-1)])),_:1,__:[150]}),e(t(q),{id:"number-of-beds",modelValue:n.value.number_of_beds,"onUpdate:modelValue":a[25]||(a[25]=r=>n.value.number_of_beds=r),disabled:!x.canEdit,type:"number",min:"0",placeholder:"Enter number of beds",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"total-opening-capacity"},{default:s(()=>a[151]||(a[151]=[o("Total Opening Capacity",-1)])),_:1,__:[151]}),e(t(q),{id:"total-opening-capacity",modelValue:n.value.total_opening_capacity,"onUpdate:modelValue":a[26]||(a[26]=r=>n.value.total_opening_capacity=r),disabled:!x.canEdit,type:"number",min:"0",placeholder:"Enter opening capacity",class:"mt-1"},null,8,["modelValue","disabled"])])]),l("div",Kl,[l("div",null,[e(t(I),{for:"capacity-full-build"},{default:s(()=>a[152]||(a[152]=[o("Capacity at Full Build-out",-1)])),_:1,__:[152]}),e(t(q),{id:"capacity-full-build",modelValue:n.value.capacity_at_full_build_out,"onUpdate:modelValue":a[27]||(a[27]=r=>n.value.capacity_at_full_build_out=r),disabled:!x.canEdit,type:"number",min:"0",placeholder:"Enter full build-out capacity",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"square-meters"},{default:s(()=>a[153]||(a[153]=[o("Square Meters",-1)])),_:1,__:[153]}),e(t(q),{id:"square-meters",modelValue:n.value.square_meters,"onUpdate:modelValue":a[28]||(a[28]=r=>n.value.square_meters=r),disabled:!x.canEdit,type:"number",min:"0",step:"0.01",placeholder:"Enter square meters",class:"mt-1"},null,8,["modelValue","disabled"])])]),l("div",Zl,[l("div",null,[e(t(I),{for:"number-of-jobs"},{default:s(()=>a[154]||(a[154]=[o("Number of Jobs",-1)])),_:1,__:[154]}),e(t(q),{id:"number-of-jobs",modelValue:n.value.number_of_jobs,"onUpdate:modelValue":a[29]||(a[29]=r=>n.value.number_of_jobs=r),disabled:!x.canEdit,type:"number",min:"0",placeholder:"Enter number of jobs created",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",Yl,[e(t(Yt),{id:"is-charter-school",checked:n.value.is_charter_school,"onUpdate:checked":a[30]||(a[30]=r=>n.value.is_charter_school=r),disabled:!x.canEdit},null,8,["checked","disabled"]),e(t(I),{for:"is-charter-school"},{default:s(()=>a[155]||(a[155]=[o("Charter School",-1)])),_:1,__:[155]})])]),n.value.is_charter_school?(u(),g("div",Ql,[l("div",null,[e(t(I),{for:"grades-from"},{default:s(()=>a[156]||(a[156]=[o("Grades From",-1)])),_:1,__:[156]}),e(t(q),{id:"grades-from",modelValue:n.value.grades_from,"onUpdate:modelValue":a[31]||(a[31]=r=>n.value.grades_from=r),disabled:!x.canEdit,type:"number",min:"1",max:"12",placeholder:"Starting grade",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"grades-to"},{default:s(()=>a[157]||(a[157]=[o("Grades To",-1)])),_:1,__:[157]}),e(t(q),{id:"grades-to",modelValue:n.value.grades_to,"onUpdate:modelValue":a[32]||(a[32]=r=>n.value.grades_to=r),disabled:!x.canEdit,type:"number",min:"1",max:"12",placeholder:"Ending grade",class:"mt-1"},null,8,["modelValue","disabled"])])])):E("",!0)]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>a[158]||(a[158]=[o("Reporting & Status Metadata",-1)])),_:1,__:[158]}),e(t(he),null,{default:s(()=>a[159]||(a[159]=[o(" Project reporting status and modification tracking. ",-1)])),_:1,__:[159]})]),_:1}),e(t(X),{class:"space-y-6"},{default:s(()=>[l("div",ea,[l("div",null,[e(t(I),{for:"report-status"},{default:s(()=>a[160]||(a[160]=[o("Report Status",-1)])),_:1,__:[160]}),l("div",ta,[e(t(_t),{variant:Z(n.value.report_status),class:"text-sm"},{default:s(()=>[o(_(L(n.value.report_status)),1)]),_:1},8,["variant"])])]),l("div",null,[e(t(I),null,{default:s(()=>a[161]||(a[161]=[o("Last Modified",-1)])),_:1,__:[161]}),l("div",sa,[n.value.modified_by?(u(),g("span",la," by "+_(n.value.modified_by)+" on "+_(V(n.value.modified_date)),1)):(u(),g("span",aa,"No modification data available"))])])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>a[162]||(a[162]=[o("Important Dates",-1)])),_:1,__:[162]}),e(t(he),null,{default:s(()=>a[163]||(a[163]=[o(" Key project dates and reporting milestones. ",-1)])),_:1,__:[163]})]),_:1}),e(t(X),{class:"space-y-6"},{default:s(()=>[l("div",oa,[l("div",null,[e(t(I),{for:"reporting-as-of-date"},{default:s(()=>a[164]||(a[164]=[o("Reporting As Of Date",-1)])),_:1,__:[164]}),e(t(q),{id:"reporting-as-of-date",modelValue:n.value.reporting_as_of_date,"onUpdate:modelValue":a[33]||(a[33]=r=>n.value.reporting_as_of_date=r),disabled:!x.canEdit,type:"date",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"director-review-date"},{default:s(()=>a[165]||(a[165]=[o("Director Review Date",-1)])),_:1,__:[165]}),e(t(q),{id:"director-review-date",modelValue:n.value.director_review_date,"onUpdate:modelValue":a[34]||(a[34]=r=>n.value.director_review_date=r),disabled:!x.canEdit,type:"date",class:"mt-1"},null,8,["modelValue","disabled"])])]),l("div",na,[l("div",null,[e(t(I),{for:"pfmt-data-date"},{default:s(()=>a[166]||(a[166]=[o("PFMT Data Date",-1)])),_:1,__:[166]}),e(t(q),{id:"pfmt-data-date",modelValue:n.value.pfmt_data_date,"onUpdate:modelValue":a[35]||(a[35]=r=>n.value.pfmt_data_date=r),disabled:!x.canEdit,type:"date",class:"mt-1"},null,8,["modelValue","disabled"])]),n.value.status==="archived"?(u(),g("div",ra,[e(t(I),{for:"archived-date"},{default:s(()=>a[167]||(a[167]=[o("Archived Date",-1)])),_:1,__:[167]}),e(t(q),{id:"archived-date",modelValue:n.value.archived_date,"onUpdate:modelValue":a[36]||(a[36]=r=>n.value.archived_date=r),disabled:!x.canEdit,type:"date",class:"mt-1"},null,8,["modelValue","disabled"])])):E("",!0)])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>a[168]||(a[168]=[o("Additional Details",-1)])),_:1,__:[168]})]),_:1}),e(t(X),{class:"space-y-6"},{default:s(()=>[l("div",null,[e(t(I),{for:"objectives"},{default:s(()=>a[169]||(a[169]=[o("Project Objectives",-1)])),_:1,__:[169]}),e(t(Ne),{id:"objectives",modelValue:n.value.objectives,"onUpdate:modelValue":a[37]||(a[37]=r=>n.value.objectives=r),disabled:!x.canEdit,placeholder:"Key project objectives and goals...",rows:"3",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"scope"},{default:s(()=>a[170]||(a[170]=[o("Project Scope",-1)])),_:1,__:[170]}),e(t(Ne),{id:"scope",modelValue:n.value.scope,"onUpdate:modelValue":a[38]||(a[38]=r=>n.value.scope=r),disabled:!x.canEdit,placeholder:"Detailed project scope and deliverables...",rows:"3",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"constraints"},{default:s(()=>a[171]||(a[171]=[o("Constraints & Assumptions",-1)])),_:1,__:[171]}),e(t(Ne),{id:"constraints",modelValue:n.value.constraints,"onUpdate:modelValue":a[39]||(a[39]=r=>n.value.constraints=r),disabled:!x.canEdit,placeholder:"Project constraints, assumptions, and limitations...",rows:"3",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"success-criteria"},{default:s(()=>a[172]||(a[172]=[o("Success Criteria",-1)])),_:1,__:[172]}),e(t(Ne),{id:"success-criteria",modelValue:n.value.success_criteria,"onUpdate:modelValue":a[40]||(a[40]=r=>n.value.success_criteria=r),disabled:!x.canEdit,placeholder:"How will project success be measured...",rows:"3",class:"mt-1"},null,8,["modelValue","disabled"])])]),_:1})]),_:1}),x.canEdit?(u(),g("div",da,[e(t(Y),{variant:"outline",onClick:B},{default:s(()=>a[173]||(a[173]=[o(" Reset Changes ",-1)])),_:1,__:[173]}),e(t(Y),{onClick:A,disabled:!k.value},{default:s(()=>[e(t(Ct),{class:"h-4 w-4 mr-2"}),a[174]||(a[174]=o(" Save Changes ",-1))]),_:1,__:[174]},8,["disabled"])])):E("",!0)])}}}),ua={class:"space-y-6"},pa={class:"space-y-4"},ca={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ma={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fa={class:"space-y-4"},ga={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},va={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},_a={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ya={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ba={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},xa={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},wa={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ka={key:0,class:"mt-4"},ha={class:"mt-2 h-64 bg-gray-100 rounded-lg flex items-center justify-center border"},$a={class:"text-center text-gray-500"},Ca={class:"text-xs"},Va={class:"flex items-center space-x-2 mt-4"},ja={key:0,class:"flex items-center justify-end space-x-2"},Sa=fe({__name:"LocationTab",props:{location:{},viewMode:{},canEdit:{type:Boolean}},emits:["update:location","save-changes"],setup(R,{emit:i}){const c=R,b=i,n=O({...c.location}),M=O({...c.location}),k=O(!1),B=F(()=>JSON.stringify(n.value)!==JSON.stringify(M.value)),A=F(()=>n.value.latitude&&n.value.longitude&&!isNaN(Number(n.value.latitude))&&!isNaN(Number(n.value.longitude))),V=()=>{n.value={...M.value}},L=()=>{const h={};Object.keys(n.value).forEach(d=>{n.value[d]!==M.value[d]&&(h[d]=n.value[d])}),b("save-changes",h),M.value={...n.value}},Z=h=>{let v=h.target.value.replace(/\s/g,"").toUpperCase();v.length>3&&(v=v.slice(0,3)+" "+v.slice(3,6)),n.value.postal_code=v},x=()=>{if(!navigator.geolocation){alert("Geolocation is not supported by this browser.");return}k.value=!0,navigator.geolocation.getCurrentPosition(h=>{n.value.latitude=Number(h.coords.latitude.toFixed(8)),n.value.longitude=Number(h.coords.longitude.toFixed(8)),k.value=!1},h=>{console.error("Error getting location:",h),alert("Unable to get current location. Please check your browser permissions."),k.value=!1},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},a=()=>{n.value.latitude=void 0,n.value.longitude=void 0};return Re(()=>c.location,h=>{n.value={...h},M.value={...h}},{deep:!0}),Re(n,h=>{b("update:location",{...h})},{deep:!0}),Pe(()=>{n.value={...c.location},M.value={...c.location}}),(h,d)=>{const v=me("SelectValue"),f=me("SelectTrigger"),r=me("SelectItem"),T=me("SelectContent");return u(),g("div",ua,[e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>d[21]||(d[21]=[o("Project Location",-1)])),_:1,__:[21]}),e(t(he),null,{default:s(()=>d[22]||(d[22]=[o(" Specify the physical location and address details for this project. ",-1)])),_:1,__:[22]})]),_:1}),e(t(X),{class:"space-y-6"},{default:s(()=>[l("div",pa,[l("div",null,[e(t(I),{for:"address"},{default:s(()=>d[23]||(d[23]=[o("Street Address",-1)])),_:1,__:[23]}),e(t(q),{id:"address",modelValue:n.value.address,"onUpdate:modelValue":d[0]||(d[0]=P=>n.value.address=P),disabled:!h.canEdit,placeholder:"Enter street address",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",ca,[l("div",null,[e(t(I),{for:"municipality"},{default:s(()=>d[24]||(d[24]=[o("Municipality/City",-1)])),_:1,__:[24]}),e(t(q),{id:"municipality",modelValue:n.value.municipality,"onUpdate:modelValue":d[1]||(d[1]=P=>n.value.municipality=P),disabled:!h.canEdit,placeholder:"Enter municipality or city",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"constituency"},{default:s(()=>d[25]||(d[25]=[o("Constituency",-1)])),_:1,__:[25]}),e(t(pe),{modelValue:n.value.constituency,"onUpdate:modelValue":d[2]||(d[2]=P=>n.value.constituency=P),disabled:!h.canEdit},{default:s(()=>[e(f,{class:"mt-1"},{default:s(()=>[e(v,{placeholder:"Select constituency"})]),_:1}),e(T,null,{default:s(()=>[e(r,{value:"calgary-centre"},{default:s(()=>d[26]||(d[26]=[o("Calgary Centre",-1)])),_:1,__:[26]}),e(r,{value:"calgary-north"},{default:s(()=>d[27]||(d[27]=[o("Calgary North",-1)])),_:1,__:[27]}),e(r,{value:"calgary-south"},{default:s(()=>d[28]||(d[28]=[o("Calgary South",-1)])),_:1,__:[28]}),e(r,{value:"edmonton-centre"},{default:s(()=>d[29]||(d[29]=[o("Edmonton Centre",-1)])),_:1,__:[29]}),e(r,{value:"edmonton-north"},{default:s(()=>d[30]||(d[30]=[o("Edmonton North",-1)])),_:1,__:[30]}),e(r,{value:"edmonton-south"},{default:s(()=>d[31]||(d[31]=[o("Edmonton South",-1)])),_:1,__:[31]}),e(r,{value:"red-deer"},{default:s(()=>d[32]||(d[32]=[o("Red Deer",-1)])),_:1,__:[32]}),e(r,{value:"lethbridge"},{default:s(()=>d[33]||(d[33]=[o("Lethbridge",-1)])),_:1,__:[33]}),e(r,{value:"medicine-hat"},{default:s(()=>d[34]||(d[34]=[o("Medicine Hat",-1)])),_:1,__:[34]}),e(r,{value:"grande-prairie"},{default:s(()=>d[35]||(d[35]=[o("Grande Prairie",-1)])),_:1,__:[35]}),e(r,{value:"fort-mcmurray"},{default:s(()=>d[36]||(d[36]=[o("Fort McMurray",-1)])),_:1,__:[36]})]),_:1})]),_:1},8,["modelValue","disabled"])])]),l("div",ma,[l("div",null,[e(t(I),{for:"province"},{default:s(()=>d[37]||(d[37]=[o("Province",-1)])),_:1,__:[37]}),e(t(q),{id:"province",modelValue:n.value.province,"onUpdate:modelValue":d[3]||(d[3]=P=>n.value.province=P),disabled:!h.canEdit,value:"Alberta",readonly:"",class:"mt-1 bg-gray-50"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"postal-code"},{default:s(()=>d[38]||(d[38]=[o("Postal Code",-1)])),_:1,__:[38]}),e(t(q),{id:"postal-code",modelValue:n.value.postal_code,"onUpdate:modelValue":d[4]||(d[4]=P=>n.value.postal_code=P),disabled:!h.canEdit,placeholder:"T0A 0A0",class:"mt-1",onInput:Z},null,8,["modelValue","disabled"])])])]),l("div",fa,[d[52]||(d[52]=l("h4",{class:"text-sm font-medium text-gray-900"},"Building Information",-1)),l("div",ga,[l("div",null,[e(t(I),{for:"building-name"},{default:s(()=>d[39]||(d[39]=[o("Building Name",-1)])),_:1,__:[39]}),e(t(q),{id:"building-name",modelValue:n.value.building_name,"onUpdate:modelValue":d[5]||(d[5]=P=>n.value.building_name=P),disabled:!h.canEdit,placeholder:"Enter building name",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"building-type"},{default:s(()=>d[40]||(d[40]=[o("Building Type",-1)])),_:1,__:[40]}),e(t(pe),{modelValue:n.value.building_type,"onUpdate:modelValue":d[6]||(d[6]=P=>n.value.building_type=P),disabled:!h.canEdit},{default:s(()=>[e(f,{class:"mt-1"},{default:s(()=>[e(v,{placeholder:"Select building type"})]),_:1}),e(T,null,{default:s(()=>[e(r,{value:"office"},{default:s(()=>d[41]||(d[41]=[o("Office Building",-1)])),_:1,__:[41]}),e(r,{value:"hospital"},{default:s(()=>d[42]||(d[42]=[o("Hospital/Healthcare",-1)])),_:1,__:[42]}),e(r,{value:"school"},{default:s(()=>d[43]||(d[43]=[o("School/Educational",-1)])),_:1,__:[43]}),e(r,{value:"courthouse"},{default:s(()=>d[44]||(d[44]=[o("Courthouse/Justice",-1)])),_:1,__:[44]}),e(r,{value:"warehouse"},{default:s(()=>d[45]||(d[45]=[o("Warehouse/Storage",-1)])),_:1,__:[45]}),e(r,{value:"laboratory"},{default:s(()=>d[46]||(d[46]=[o("Laboratory/Research",-1)])),_:1,__:[46]}),e(r,{value:"mixed-use"},{default:s(()=>d[47]||(d[47]=[o("Mixed Use",-1)])),_:1,__:[47]}),e(r,{value:"other"},{default:s(()=>d[48]||(d[48]=[o("Other",-1)])),_:1,__:[48]})]),_:1})]),_:1},8,["modelValue","disabled"])])]),l("div",va,[l("div",null,[e(t(I),{for:"floors"},{default:s(()=>d[49]||(d[49]=[o("Number of Floors",-1)])),_:1,__:[49]}),e(t(q),{id:"floors",modelValue:n.value.floors,"onUpdate:modelValue":d[7]||(d[7]=P=>n.value.floors=P),disabled:!h.canEdit,type:"number",min:"1",placeholder:"1",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"square-footage"},{default:s(()=>d[50]||(d[50]=[o("Square Footage",-1)])),_:1,__:[50]}),e(t(q),{id:"square-footage",modelValue:n.value.square_footage,"onUpdate:modelValue":d[8]||(d[8]=P=>n.value.square_footage=P),disabled:!h.canEdit,type:"number",placeholder:"10000",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"parking-spaces"},{default:s(()=>d[51]||(d[51]=[o("Parking Spaces",-1)])),_:1,__:[51]}),e(t(q),{id:"parking-spaces",modelValue:n.value.parking_spaces,"onUpdate:modelValue":d[9]||(d[9]=P=>n.value.parking_spaces=P),disabled:!h.canEdit,type:"number",min:"0",placeholder:"50",class:"mt-1"},null,8,["modelValue","disabled"])])])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>d[53]||(d[53]=[o("Geographical Classification",-1)])),_:1,__:[53]}),e(t(he),null,{default:s(()=>d[54]||(d[54]=[o(" Geographic and administrative classification details. ",-1)])),_:1,__:[54]})]),_:1}),e(t(X),{class:"space-y-6"},{default:s(()=>[l("div",_a,[l("div",null,[e(t(I),{for:"urban-rural"},{default:s(()=>d[55]||(d[55]=[o("Urban/Rural Classification",-1)])),_:1,__:[55]}),e(t(pe),{modelValue:n.value.urban_rural,"onUpdate:modelValue":d[10]||(d[10]=P=>n.value.urban_rural=P),disabled:!h.canEdit},{default:s(()=>[e(f,{class:"mt-1"},{default:s(()=>[e(v,{placeholder:"Select classification"})]),_:1}),e(T,null,{default:s(()=>[e(r,{value:"urban"},{default:s(()=>d[56]||(d[56]=[o("Urban",-1)])),_:1,__:[56]}),e(r,{value:"rural"},{default:s(()=>d[57]||(d[57]=[o("Rural",-1)])),_:1,__:[57]})]),_:1})]),_:1},8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"mla"},{default:s(()=>d[58]||(d[58]=[o("Member of Legislative Assembly (MLA)",-1)])),_:1,__:[58]}),e(t(q),{id:"mla",modelValue:n.value.mla,"onUpdate:modelValue":d[11]||(d[11]=P=>n.value.mla=P),disabled:!h.canEdit,placeholder:"Enter MLA name or constituency",class:"mt-1"},null,8,["modelValue","disabled"])])]),l("div",ya,[l("div",null,[e(t(I),{for:"location"},{default:s(()=>d[59]||(d[59]=[o("Location Description",-1)])),_:1,__:[59]}),e(t(q),{id:"location",modelValue:n.value.location,"onUpdate:modelValue":d[12]||(d[12]=P=>n.value.location=P),disabled:!h.canEdit,placeholder:"General location description",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"project-address"},{default:s(()=>d[60]||(d[60]=[o("Project Address",-1)])),_:1,__:[60]}),e(t(Ne),{id:"project-address",modelValue:n.value.project_address,"onUpdate:modelValue":d[13]||(d[13]=P=>n.value.project_address=P),disabled:!h.canEdit,placeholder:"Detailed project address (if different from street address)",rows:"2",class:"mt-1"},null,8,["modelValue","disabled"])])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>d[61]||(d[61]=[o("Legal Land Description",-1)])),_:1,__:[61]}),e(t(he),null,{default:s(()=>d[62]||(d[62]=[o(" Legal land description and ownership information. ",-1)])),_:1,__:[62]})]),_:1}),e(t(X),{class:"space-y-6"},{default:s(()=>[l("div",ba,[l("div",null,[e(t(I),{for:"plan"},{default:s(()=>d[63]||(d[63]=[o("Plan",-1)])),_:1,__:[63]}),e(t(q),{id:"plan",modelValue:n.value.plan,"onUpdate:modelValue":d[14]||(d[14]=P=>n.value.plan=P),disabled:!h.canEdit,placeholder:"Enter plan number",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"block"},{default:s(()=>d[64]||(d[64]=[o("Block",-1)])),_:1,__:[64]}),e(t(q),{id:"block",modelValue:n.value.block,"onUpdate:modelValue":d[15]||(d[15]=P=>n.value.block=P),disabled:!h.canEdit,placeholder:"Enter block number",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"lot"},{default:s(()=>d[65]||(d[65]=[o("Lot",-1)])),_:1,__:[65]}),e(t(q),{id:"lot",modelValue:n.value.lot,"onUpdate:modelValue":d[16]||(d[16]=P=>n.value.lot=P),disabled:!h.canEdit,placeholder:"Enter lot number",class:"mt-1"},null,8,["modelValue","disabled"])])]),l("div",xa,[l("div",null,[e(t(I),{for:"building-id"},{default:s(()=>d[66]||(d[66]=[o("Building ID",-1)])),_:1,__:[66]}),e(t(q),{id:"building-id",modelValue:n.value.building_id,"onUpdate:modelValue":d[17]||(d[17]=P=>n.value.building_id=P),disabled:!h.canEdit,placeholder:"Enter building identifier",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"building-owner"},{default:s(()=>d[67]||(d[67]=[o("Building Owner",-1)])),_:1,__:[67]}),e(t(q),{id:"building-owner",modelValue:n.value.building_owner,"onUpdate:modelValue":d[18]||(d[18]=P=>n.value.building_owner=P),disabled:!h.canEdit,placeholder:"Enter building owner name",class:"mt-1"},null,8,["modelValue","disabled"])])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>d[68]||(d[68]=[o("Geographic Coordinates",-1)])),_:1,__:[68]}),e(t(he),null,{default:s(()=>d[69]||(d[69]=[o(" Precise location coordinates for mapping and GIS purposes. ",-1)])),_:1,__:[69]})]),_:1}),e(t(X),{class:"space-y-4"},{default:s(()=>[l("div",wa,[l("div",null,[e(t(I),{for:"latitude"},{default:s(()=>d[70]||(d[70]=[o("Latitude",-1)])),_:1,__:[70]}),e(t(q),{id:"latitude",modelValue:n.value.latitude,"onUpdate:modelValue":d[19]||(d[19]=P=>n.value.latitude=P),disabled:!h.canEdit,type:"number",step:"any",placeholder:"53.5461",class:"mt-1"},null,8,["modelValue","disabled"])]),l("div",null,[e(t(I),{for:"longitude"},{default:s(()=>d[71]||(d[71]=[o("Longitude",-1)])),_:1,__:[71]}),e(t(q),{id:"longitude",modelValue:n.value.longitude,"onUpdate:modelValue":d[20]||(d[20]=P=>n.value.longitude=P),disabled:!h.canEdit,type:"number",step:"any",placeholder:"-113.4938",class:"mt-1"},null,8,["modelValue","disabled"])])]),A.value?(u(),g("div",ka,[e(t(I),null,{default:s(()=>d[72]||(d[72]=[o("Location Preview",-1)])),_:1,__:[72]}),l("div",ha,[l("div",$a,[e(t(Bt),{class:"h-8 w-8 mx-auto mb-2"}),d[73]||(d[73]=l("p",{class:"text-sm"},"Map preview would appear here",-1)),l("p",Ca,"Lat: "+_(n.value.latitude)+", Lng: "+_(n.value.longitude),1)])])])):E("",!0),l("div",Va,[e(t(Y),{variant:"outline",size:"sm",onClick:x,disabled:!h.canEdit||k.value},{default:s(()=>[e(t(Bt),{class:"h-4 w-4 mr-2"}),o(" "+_(k.value?"Getting Location...":"Use Current Location"),1)]),_:1},8,["disabled"]),e(t(Y),{variant:"outline",size:"sm",onClick:a,disabled:!h.canEdit||!A.value},{default:s(()=>[e(t(es),{class:"h-4 w-4 mr-2"}),d[74]||(d[74]=o(" Clear Coordinates ",-1))]),_:1,__:[74]},8,["disabled"])])]),_:1})]),_:1}),h.canEdit?(u(),g("div",ja,[e(t(Y),{variant:"outline",onClick:V},{default:s(()=>d[75]||(d[75]=[o(" Reset Changes ",-1)])),_:1,__:[75]}),e(t(Y),{onClick:L,disabled:!B.value},{default:s(()=>[e(t(Ct),{class:"h-4 w-4 mr-2"}),d[76]||(d[76]=o(" Save Changes ",-1))]),_:1,__:[76]},8,["disabled"])])):E("",!0)])}}}),Ma={class:"flex-shrink-0 space-y-4 border-b pb-4"},Da={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ea={class:"relative"},Aa={class:"flex items-center justify-between"},Pa={class:"text-sm text-gray-600"},Ta={class:"flex-1 overflow-y-auto"},Ua={key:0,class:"flex justify-center py-8"},Ia={key:1,class:"text-center py-8"},Na={class:"text-red-600 mb-2"},Ra={key:2,class:"text-center py-8"},Ba={key:3,class:"space-y-3 p-1"},Oa=["onClick"],Fa={class:"flex items-start justify-between"},La={class:"flex-1"},Ga={class:"flex items-center space-x-3"},qa={class:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0"},za={class:"min-w-0 flex-1"},Ha={class:"text-lg font-medium text-gray-900 truncate"},Ja={class:"text-sm text-gray-600 truncate"},Wa={class:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-2 text-sm"},Xa={key:0,class:"flex items-center text-gray-600"},Ka={class:"truncate"},Za={key:1,class:"flex items-center text-gray-600"},Ya={key:2,class:"flex items-center text-gray-600"},Qa={key:3,class:"flex items-center text-gray-600"},eo={key:0,class:"mt-2"},to={class:"flex flex-wrap gap-1"},so={class:"flex-shrink-0 ml-4"},lo={key:0,class:"flex-shrink-0 border-t pt-4 space-y-4"},ao={class:"font-medium"},oo={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},no={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},ro=fe({__name:"VendorSelectionModal",props:{projectId:{},open:{type:Boolean}},emits:["update:open","vendor-assigned"],setup(R,{emit:i}){const c=R,b=i,{formatStatus:n}=et(),M=O([]),k=O(!1),B=O(null),A=O(!1),V=O(""),L=O(""),Z=O(""),x=O(null),a=O({role:"",contract_value:null,start_date:"",end_date:""}),h=F({get:()=>c.open,set:U=>b("update:open",U)}),d=async()=>{var U;try{k.value=!0,B.value=null;const p=new URLSearchParams;V.value&&p.append("search",V.value),L.value&&p.append("capability",L.value),Z.value&&p.append("status",Z.value),p.append("limit","50");const m=await Zt.get(`/vendors?${p.toString()}`);if(m.success)M.value=m.data||[];else throw new Error(((U=m.error)==null?void 0:U.message)||"Failed to load vendors")}catch(p){console.error("Error loading vendors:",p),B.value=p instanceof Error?p.message:"Failed to load vendors"}finally{k.value=!1}},v=(()=>{let U;return()=>{clearTimeout(U),U=setTimeout(()=>{d()},300)}})(),f=U=>{x.value=U,a.value={role:"",contract_value:null,start_date:"",end_date:""}},r=async()=>{var U;if(!(!x.value||!a.value.role))try{A.value=!0;const p={vendor_id:x.value.id,role:a.value.role,contract_value:a.value.contract_value,start_date:a.value.start_date||null,end_date:a.value.end_date||null},m=await Zt.post(`/projects/${c.projectId}/vendors`,p);if(m.success)b("vendor-assigned",x.value,a.value),P();else throw new Error(((U=m.error)==null?void 0:U.message)||"Failed to assign vendor")}catch(p){console.error("Error assigning vendor:",p),B.value=p instanceof Error?p.message:"Failed to assign vendor"}finally{A.value=!1}},T=()=>{V.value="",L.value="",Z.value="",d()},P=()=>{x.value=null,a.value={role:"",contract_value:null,start_date:"",end_date:""},B.value=null,b("update:open",!1)},ne=U=>U?U.split(",").map(p=>p.trim()).filter(Boolean):[],ge=U=>{switch(U){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return Re(()=>c.open,U=>{U&&d()}),Pe(()=>{c.open&&d()}),(U,p)=>{const m=me("SelectValue"),W=me("SelectTrigger"),D=me("SelectItem"),y=me("SelectContent");return u(),Q(t(Ye),{open:h.value,"onUpdate:open":p[7]||(p[7]=ee=>h.value=ee)},{default:s(()=>[e(t(Ze),{class:"sm:max-w-4xl max-h-[80vh] overflow-hidden flex flex-col"},{default:s(()=>[e(t(Je),null,{default:s(()=>[e(t(We),null,{default:s(()=>p[8]||(p[8]=[o("Select Vendor for Project",-1)])),_:1,__:[8]}),e(t(Xe),null,{default:s(()=>p[9]||(p[9]=[o(" Choose from existing vendors to assign to this project. You can search by name or filter by capabilities. ",-1)])),_:1,__:[9]})]),_:1}),l("div",Ma,[l("div",Da,[l("div",null,[e(t(I),{for:"vendor-search"},{default:s(()=>p[10]||(p[10]=[o("Search Vendors",-1)])),_:1,__:[10]}),l("div",Ea,[e(t($s),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e(t(q),{id:"vendor-search",modelValue:V.value,"onUpdate:modelValue":p[0]||(p[0]=ee=>V.value=ee),placeholder:"Search by name or description...",class:"pl-10",onInput:t(v)},null,8,["modelValue","onInput"])])]),l("div",null,[e(t(I),{for:"capability-filter"},{default:s(()=>p[11]||(p[11]=[o("Capability",-1)])),_:1,__:[11]}),e(t(pe),{modelValue:L.value,"onUpdate:modelValue":[p[1]||(p[1]=ee=>L.value=ee),d]},{default:s(()=>[e(W,null,{default:s(()=>[e(m,{placeholder:"All Capabilities"})]),_:1}),e(y,null,{default:s(()=>[e(D,{value:""},{default:s(()=>p[12]||(p[12]=[o("All Capabilities",-1)])),_:1,__:[12]}),e(D,{value:"construction"},{default:s(()=>p[13]||(p[13]=[o("Construction",-1)])),_:1,__:[13]}),e(D,{value:"design"},{default:s(()=>p[14]||(p[14]=[o("Design",-1)])),_:1,__:[14]}),e(D,{value:"consulting"},{default:s(()=>p[15]||(p[15]=[o("Consulting",-1)])),_:1,__:[15]}),e(D,{value:"engineering"},{default:s(()=>p[16]||(p[16]=[o("Engineering",-1)])),_:1,__:[16]}),e(D,{value:"architecture"},{default:s(()=>p[17]||(p[17]=[o("Architecture",-1)])),_:1,__:[17]}),e(D,{value:"electrical"},{default:s(()=>p[18]||(p[18]=[o("Electrical",-1)])),_:1,__:[18]}),e(D,{value:"plumbing"},{default:s(()=>p[19]||(p[19]=[o("Plumbing",-1)])),_:1,__:[19]}),e(D,{value:"hvac"},{default:s(()=>p[20]||(p[20]=[o("HVAC",-1)])),_:1,__:[20]})]),_:1})]),_:1},8,["modelValue"])]),l("div",null,[e(t(I),{for:"status-filter"},{default:s(()=>p[21]||(p[21]=[o("Status",-1)])),_:1,__:[21]}),e(t(pe),{modelValue:Z.value,"onUpdate:modelValue":[p[2]||(p[2]=ee=>Z.value=ee),d]},{default:s(()=>[e(W,null,{default:s(()=>[e(m,{placeholder:"All Statuses"})]),_:1}),e(y,null,{default:s(()=>[e(D,{value:""},{default:s(()=>p[22]||(p[22]=[o("All Statuses",-1)])),_:1,__:[22]}),e(D,{value:"active"},{default:s(()=>p[23]||(p[23]=[o("Active",-1)])),_:1,__:[23]}),e(D,{value:"inactive"},{default:s(()=>p[24]||(p[24]=[o("Inactive",-1)])),_:1,__:[24]}),e(D,{value:"pending"},{default:s(()=>p[25]||(p[25]=[o("Pending",-1)])),_:1,__:[25]})]),_:1})]),_:1},8,["modelValue"])])]),l("div",Aa,[l("p",Pa,_(M.value.length)+" vendor"+_(M.value.length!==1?"s":"")+" found ",1),e(t(Y),{variant:"outline",onClick:T,size:"sm"},{default:s(()=>p[26]||(p[26]=[o(" Clear Filters ",-1)])),_:1,__:[26]})])]),l("div",Ta,[k.value?(u(),g("div",Ua,p[27]||(p[27]=[l("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):B.value?(u(),g("div",Ia,[l("p",Na,_(B.value),1),e(t(Y),{variant:"outline",onClick:d,size:"sm"},{default:s(()=>p[28]||(p[28]=[o(" Try Again ",-1)])),_:1,__:[28]})])):M.value.length===0?(u(),g("div",Ra,[e(t(bt),{class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),p[29]||(p[29]=l("p",{class:"text-gray-500 mb-2"},"No vendors found",-1)),p[30]||(p[30]=l("p",{class:"text-sm text-gray-400"},"Try adjusting your search criteria",-1))])):(u(),g("div",Ba,[(u(!0),g(_e,null,ye(M.value,ee=>{var w;return u(),g("div",{key:ee.id,class:re(["border rounded-lg p-4 hover:bg-gray-50 transition-colors cursor-pointer",{"ring-2 ring-blue-500 bg-blue-50":((w=x.value)==null?void 0:w.id)===ee.id}]),onClick:G=>f(ee)},[l("div",Fa,[l("div",La,[l("div",Ga,[l("div",qa,[e(t(bt),{class:"h-5 w-5 text-blue-600"})]),l("div",za,[l("h4",Ha,_(ee.name),1),l("p",Ja,_(ee.description||"No description available"),1)])]),l("div",Wa,[ee.contact_email?(u(),g("div",Xa,[e(t(Rt),{class:"h-4 w-4 mr-2 flex-shrink-0"}),l("span",Ka,_(ee.contact_email),1)])):E("",!0),ee.contact_phone?(u(),g("div",Za,[e(t(as),{class:"h-4 w-4 mr-2 flex-shrink-0"}),l("span",null,_(ee.contact_phone),1)])):E("",!0),ee.certification_level?(u(),g("div",Ya,[e(t(os),{class:"h-4 w-4 mr-2 flex-shrink-0"}),l("span",null,_(ee.certification_level),1)])):E("",!0),ee.performance_rating?(u(),g("div",Qa,[e(t(ns),{class:"h-4 w-4 mr-2 flex-shrink-0"}),l("span",null,_(ee.performance_rating)+"/5.0",1)])):E("",!0)]),ee.capabilities?(u(),g("div",eo,[l("div",to,[(u(!0),g(_e,null,ye(ne(ee.capabilities),G=>(u(),g("span",{key:G,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},_(G),1))),128))])])):E("",!0)]),l("div",so,[l("span",{class:re(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",ge(ee.status)])},_(t(n)(ee.status)),3)])])],10,Oa)}),128))]))]),x.value?(u(),g("div",lo,[l("h4",ao,"Assignment Details for "+_(x.value.name),1),l("div",oo,[l("div",null,[e(t(I),{for:"vendor-role"},{default:s(()=>p[31]||(p[31]=[o("Role/Specialization *",-1)])),_:1,__:[31]}),e(t(pe),{modelValue:a.value.role,"onUpdate:modelValue":p[3]||(p[3]=ee=>a.value.role=ee),required:""},{default:s(()=>[e(W,null,{default:s(()=>[e(m,{placeholder:"Select role"})]),_:1}),e(y,null,{default:s(()=>[e(D,{value:"General Contractor"},{default:s(()=>p[32]||(p[32]=[o("General Contractor",-1)])),_:1,__:[32]}),e(D,{value:"Architect"},{default:s(()=>p[33]||(p[33]=[o("Architect",-1)])),_:1,__:[33]}),e(D,{value:"Engineer"},{default:s(()=>p[34]||(p[34]=[o("Engineer",-1)])),_:1,__:[34]}),e(D,{value:"Electrical Contractor"},{default:s(()=>p[35]||(p[35]=[o("Electrical Contractor",-1)])),_:1,__:[35]}),e(D,{value:"Plumbing Contractor"},{default:s(()=>p[36]||(p[36]=[o("Plumbing Contractor",-1)])),_:1,__:[36]}),e(D,{value:"HVAC Contractor"},{default:s(()=>p[37]||(p[37]=[o("HVAC Contractor",-1)])),_:1,__:[37]}),e(D,{value:"Consultant"},{default:s(()=>p[38]||(p[38]=[o("Consultant",-1)])),_:1,__:[38]}),e(D,{value:"Supplier"},{default:s(()=>p[39]||(p[39]=[o("Supplier",-1)])),_:1,__:[39]}),e(D,{value:"Other"},{default:s(()=>p[40]||(p[40]=[o("Other",-1)])),_:1,__:[40]})]),_:1})]),_:1},8,["modelValue"])]),l("div",null,[e(t(I),{for:"contract-value"},{default:s(()=>p[41]||(p[41]=[o("Contract Value",-1)])),_:1,__:[41]}),e(t(q),{id:"contract-value",modelValue:a.value.contract_value,"onUpdate:modelValue":p[4]||(p[4]=ee=>a.value.contract_value=ee),type:"number",min:"0",step:"1000",placeholder:"0"},null,8,["modelValue"])]),l("div",null,[e(t(I),{for:"start-date"},{default:s(()=>p[42]||(p[42]=[o("Start Date",-1)])),_:1,__:[42]}),e(t(q),{id:"start-date",modelValue:a.value.start_date,"onUpdate:modelValue":p[5]||(p[5]=ee=>a.value.start_date=ee),type:"date"},null,8,["modelValue"])]),l("div",null,[e(t(I),{for:"end-date"},{default:s(()=>p[43]||(p[43]=[o("End Date",-1)])),_:1,__:[43]}),e(t(q),{id:"end-date",modelValue:a.value.end_date,"onUpdate:modelValue":p[6]||(p[6]=ee=>a.value.end_date=ee),type:"date"},null,8,["modelValue"])])])])):E("",!0),e(t(Ke),null,{default:s(()=>[e(t(Y),{variant:"outline",onClick:P},{default:s(()=>p[44]||(p[44]=[o(" Cancel ",-1)])),_:1,__:[44]}),e(t(Y),{onClick:r,disabled:!x.value||!a.value.role||A.value},{default:s(()=>[A.value?(u(),g("div",no)):E("",!0),o(" "+_(A.value?"Assigning...":"Assign Vendor"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])}}}),io={class:"space-y-6"},uo={class:"flex items-center justify-between"},po={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},co={class:"flex items-center space-x-2"},mo={class:"text-2xl font-bold"},fo={class:"flex items-center space-x-2"},go={class:"text-2xl font-bold"},vo={class:"flex items-center space-x-2"},_o={class:"text-2xl font-bold"},yo={class:"flex items-center space-x-2"},bo={class:"text-2xl font-bold"},xo={key:0,class:"flex justify-center py-8"},wo={key:1,class:"text-center py-8"},ko={class:"text-red-600"},ho={key:0,class:"text-center py-8"},$o={key:1,class:"space-y-4"},Co={class:"flex-shrink-0"},Vo={class:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center"},jo={class:"flex-1 min-w-0"},So={class:"flex items-center justify-between"},Mo={class:"text-lg font-medium text-gray-900"},Do={class:"flex items-center space-x-2"},Eo={class:"mt-1 flex items-center space-x-4 text-sm text-gray-500"},Ao={key:0,class:"flex items-center"},Po={key:1,class:"flex items-center"},To={key:2,class:"flex items-center"},Uo=["href"],Io={key:0,class:"mt-1 flex items-center text-sm text-gray-500"},No={class:"mt-2 flex items-center space-x-6 text-sm"},Ro={class:"ml-1 font-medium"},Bo={key:0},Oo={class:"ml-1 font-medium"},Fo={key:1},Lo={class:"ml-1 font-medium"},Go={key:2},qo={class:"ml-1 font-medium"},zo={class:"mt-2 flex items-center space-x-6 text-sm"},Ho={key:0},Jo={class:"ml-1 font-medium flex items-center"},Wo={key:1},Xo={class:"ml-1 font-medium flex items-center"},Ko={key:1,class:"mt-2 text-sm text-gray-700"},Zo={key:2,class:"mt-2"},Yo={class:"flex flex-wrap gap-1"},Qo={class:"flex-shrink-0"},en={key:0,class:"space-y-4"},tn={class:"grid grid-cols-2 gap-4"},sn=fe({__name:"VendorsTab",props:{projectId:{},viewMode:{},canEdit:{type:Boolean}},emits:["vendor-updated","vendor-removed"],setup(R,{emit:i}){const c=i,b=O([]),n=O(!1),M=O(null),k=O(!1),B=O(!1),A=O(null),V=F(()=>b.value.filter(D=>D.assignment_status==="active")),L=F(()=>b.value.filter(D=>D.assignment_status==="pending")),Z=F(()=>b.value.reduce((D,y)=>D+(y.contract_value||0),0)),x=async()=>{n.value=!0,M.value=null;try{b.value=[{assignment_id:"1",vendor_id:"v1",company_name:"ABC Construction Ltd.",description:"Leading construction company specializing in government projects",capabilities:"Construction, Project Management, Safety",contact_email:"contact@abcconstruction.com",contact_phone:"(403) 555-0123",website:"https://abcconstruction.com",address:"123 Main St, Calgary, AB T2P 1A1",certification_level:"Gold",performance_rating:4.5,status:"active",role:"General Contractor",contract_value:25e5,start_date:"2024-01-15",end_date:"2024-12-31",assignment_status:"active"}]}catch(D){M.value="Failed to load vendors",console.error("Error loading vendors:",D)}finally{n.value=!1}},a=D=>new Intl.NumberFormat("en-CA",{style:"currency",currency:"CAD"}).format(D),h=D=>new Date(D).toLocaleDateString("en-CA"),d=D=>D.replace(/_/g," ").replace(/\b\w/g,y=>y.toUpperCase()),v=D=>{switch(D){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"suspended":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},f=D=>{switch(D){case"active":return"bg-blue-100 text-blue-800";case"suspended":return"bg-orange-100 text-orange-800";case"closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},r=(D,y)=>D.length<=y?D:D.slice(0,y)+"...",T=D=>D.split(",").map(y=>y.trim()).filter(y=>y.length>0),P=D=>{console.log("View vendor:",D)},ne=D=>{A.value={...D},B.value=!0},ge=D=>{D.contact_email&&(window.location.href=`mailto:${D.contact_email}`)},U=async D=>{if(confirm(`Are you sure you want to remove ${D.company_name} from this project?`))try{b.value=b.value.filter(y=>y.assignment_id!==D.assignment_id),c("vendor-removed",D.vendor_id)}catch(y){console.error("Error removing vendor:",y)}},p=D=>{b.value.push(D),k.value=!1},m=async()=>{if(A.value)try{const D=b.value.findIndex(y=>y.assignment_id===A.value.assignment_id);D!==-1&&(b.value[D]={...A.value},c("vendor-updated",A.value)),B.value=!1,A.value=null}catch(D){console.error("Error updating assignment:",D)}},W=()=>{B.value=!1,A.value=null};return Pe(()=>{x()}),(D,y)=>{const ee=me("SelectValue"),w=me("SelectTrigger"),G=me("SelectItem"),J=me("SelectContent");return u(),g("div",io,[l("div",uo,[y[10]||(y[10]=l("div",null,[l("h3",{class:"text-lg font-semibold"},"Project Vendors"),l("p",{class:"text-sm text-gray-600"},"Manage vendors and contractors assigned to this project")],-1)),D.canEdit?(u(),Q(t(Y),{key:0,onClick:y[0]||(y[0]=j=>k.value=!0),class:"flex items-center space-x-2"},{default:s(()=>[e(t(ds),{class:"h-4 w-4"}),y[9]||(y[9]=l("span",null,"Add Vendor",-1))]),_:1,__:[9]})):E("",!0)]),l("div",po,[e(t(K),null,{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",co,[e(t(Qe),{class:"h-5 w-5 text-blue-600"}),l("div",null,[y[11]||(y[11]=l("p",{class:"text-sm font-medium"},"Total Vendors",-1)),l("p",mo,_(b.value.length),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",fo,[e(t(Se),{class:"h-5 w-5 text-green-600"}),l("div",null,[y[12]||(y[12]=l("p",{class:"text-sm font-medium"},"Active",-1)),l("p",go,_(V.value.length),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",vo,[e(t(ht),{class:"h-5 w-5 text-orange-600"}),l("div",null,[y[13]||(y[13]=l("p",{class:"text-sm font-medium"},"Pending",-1)),l("p",_o,_(L.value.length),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",yo,[e(t(we),{class:"h-5 w-5 text-purple-600"}),l("div",null,[y[14]||(y[14]=l("p",{class:"text-sm font-medium"},"Total Value",-1)),l("p",bo,_(a(Z.value)),1)])])]),_:1})]),_:1})]),n.value?(u(),g("div",xo,y[15]||(y[15]=[l("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):M.value?(u(),g("div",wo,[l("p",ko,_(M.value),1),e(t(Y),{variant:"outline",onClick:x,class:"mt-2"},{default:s(()=>y[16]||(y[16]=[o(" Try Again ",-1)])),_:1,__:[16]})])):(u(),Q(t(K),{key:2},{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>y[17]||(y[17]=[o("Assigned Vendors",-1)])),_:1,__:[17]})]),_:1}),e(t(X),null,{default:s(()=>[b.value.length===0?(u(),g("div",ho,[e(t(Qe),{class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),y[19]||(y[19]=l("p",{class:"text-gray-500"},"No vendors assigned to this project yet.",-1)),D.canEdit?(u(),Q(t(Y),{key:0,variant:"outline",onClick:y[1]||(y[1]=j=>k.value=!0),class:"mt-4"},{default:s(()=>y[18]||(y[18]=[o(" Add First Vendor ",-1)])),_:1,__:[18]})):E("",!0)])):(u(),g("div",$o,[(u(!0),g(_e,null,ye(b.value,j=>(u(),g("div",{key:j.assignment_id,class:"flex items-start space-x-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors"},[l("div",Co,[l("div",Vo,[e(t(bt),{class:"h-6 w-6 text-blue-600"})])]),l("div",jo,[l("div",So,[l("h4",Mo,_(j.company_name),1),l("div",Do,[l("span",{class:re(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",v(j.status)])},_(d(j.status)),3),j.assignment_status?(u(),g("span",{key:0,class:re(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",f(j.assignment_status)])},_(d(j.assignment_status)),3)):E("",!0)])]),l("div",Eo,[j.contact_email?(u(),g("span",Ao,[e(t(Rt),{class:"h-4 w-4 mr-1"}),o(" "+_(j.contact_email),1)])):E("",!0),j.contact_phone?(u(),g("span",Po,[e(t(as),{class:"h-4 w-4 mr-1"}),o(" "+_(j.contact_phone),1)])):E("",!0),j.website?(u(),g("span",To,[e(t(Ms),{class:"h-4 w-4 mr-1"}),l("a",{href:j.website,target:"_blank",class:"text-blue-600 hover:underline"}," Website ",8,Uo)])):E("",!0)]),j.address?(u(),g("div",Io,[e(t(Bt),{class:"h-4 w-4 mr-1"}),o(" "+_(j.address),1)])):E("",!0),l("div",No,[l("div",null,[y[20]||(y[20]=l("span",{class:"text-gray-500"},"Role:",-1)),l("span",Ro,_(j.role),1)]),j.contract_value?(u(),g("div",Bo,[y[21]||(y[21]=l("span",{class:"text-gray-500"},"Contract Value:",-1)),l("span",Oo,_(a(j.contract_value)),1)])):E("",!0),j.start_date?(u(),g("div",Fo,[y[22]||(y[22]=l("span",{class:"text-gray-500"},"Start Date:",-1)),l("span",Lo,_(h(j.start_date)),1)])):E("",!0),j.end_date?(u(),g("div",Go,[y[23]||(y[23]=l("span",{class:"text-gray-500"},"End Date:",-1)),l("span",qo,_(h(j.end_date)),1)])):E("",!0)]),l("div",zo,[j.certification_level?(u(),g("div",Ho,[y[24]||(y[24]=l("span",{class:"text-gray-500"},"Certification:",-1)),l("span",Jo,[e(t(os),{class:"h-4 w-4 mr-1"}),o(" "+_(j.certification_level),1)])])):E("",!0),j.performance_rating?(u(),g("div",Wo,[y[25]||(y[25]=l("span",{class:"text-gray-500"},"Performance:",-1)),l("span",Xo,[e(t(ns),{class:"h-4 w-4 mr-1 text-yellow-500"}),o(" "+_(j.performance_rating)+"/5.0 ",1)])])):E("",!0)]),j.description?(u(),g("p",Ko,_(r(j.description,150)),1)):E("",!0),j.capabilities?(u(),g("div",Zo,[l("div",Yo,[(u(!0),g(_e,null,ye(T(j.capabilities),ae=>(u(),g("span",{key:ae,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},_(ae),1))),128))])])):E("",!0)]),l("div",Qo,[e(t(nt),null,{default:s(()=>[e(t(rt),{asChild:""},{default:s(()=>[e(t(Y),{variant:"ghost",size:"sm"},{default:s(()=>[e(t($t),{class:"h-4 w-4"})]),_:1})]),_:1}),e(t(dt),{align:"end"},{default:s(()=>[e(t(ce),{onClick:ae=>P(j)},{default:s(()=>[e(t(ot),{class:"h-4 w-4 mr-2"}),y[26]||(y[26]=o(" View Details ",-1))]),_:2,__:[26]},1032,["onClick"]),D.canEdit?(u(),Q(t(ce),{key:0,onClick:ae=>ne(j)},{default:s(()=>[e(t(He),{class:"h-4 w-4 mr-2"}),y[27]||(y[27]=o(" Edit Assignment ",-1))]),_:2,__:[27]},1032,["onClick"])):E("",!0),e(t(ce),{onClick:ae=>ge(j)},{default:s(()=>[e(t(Rt),{class:"h-4 w-4 mr-2"}),y[28]||(y[28]=o(" Send Email ",-1))]),_:2,__:[28]},1032,["onClick"]),e(t(Ge)),D.canEdit?(u(),Q(t(ce),{key:1,onClick:ae=>U(j),class:"text-red-600"},{default:s(()=>[e(t(Vt),{class:"h-4 w-4 mr-2"}),y[29]||(y[29]=o(" Remove from Project ",-1))]),_:2,__:[29]},1032,["onClick"])):E("",!0)]),_:2},1024)]),_:2},1024)])]))),128))]))]),_:1})]),_:1})),e(ro,{open:k.value,"onUpdate:open":y[2]||(y[2]=j=>k.value=j),"project-id":D.projectId,onVendorAssigned:p},null,8,["open","project-id"]),e(t(Ye),{open:B.value,"onUpdate:open":y[8]||(y[8]=j=>B.value=j)},{default:s(()=>[e(t(Ze),{class:"sm:max-w-md"},{default:s(()=>[e(t(Je),null,{default:s(()=>[e(t(We),null,{default:s(()=>y[30]||(y[30]=[o("Edit Vendor Assignment",-1)])),_:1,__:[30]}),e(t(Xe),null,{default:s(()=>{var j;return[o(" Update the assignment details for "+_((j=A.value)==null?void 0:j.company_name)+". ",1)]}),_:1})]),_:1}),A.value?(u(),g("div",en,[l("div",null,[e(t(I),{for:"assignment-role"},{default:s(()=>y[31]||(y[31]=[o("Role",-1)])),_:1,__:[31]}),e(t(q),{id:"assignment-role",modelValue:A.value.role,"onUpdate:modelValue":y[3]||(y[3]=j=>A.value.role=j),placeholder:"e.g., General Contractor, Architect",class:"mt-1"},null,8,["modelValue"])]),l("div",null,[e(t(I),{for:"contract-value"},{default:s(()=>y[32]||(y[32]=[o("Contract Value",-1)])),_:1,__:[32]}),e(t(q),{id:"contract-value",modelValue:A.value.contract_value,"onUpdate:modelValue":y[4]||(y[4]=j=>A.value.contract_value=j),type:"number",step:"0.01",placeholder:"0.00",class:"mt-1"},null,8,["modelValue"])]),l("div",tn,[l("div",null,[e(t(I),{for:"start-date"},{default:s(()=>y[33]||(y[33]=[o("Start Date",-1)])),_:1,__:[33]}),e(t(q),{id:"start-date",modelValue:A.value.start_date,"onUpdate:modelValue":y[5]||(y[5]=j=>A.value.start_date=j),type:"date",class:"mt-1"},null,8,["modelValue"])]),l("div",null,[e(t(I),{for:"end-date"},{default:s(()=>y[34]||(y[34]=[o("End Date",-1)])),_:1,__:[34]}),e(t(q),{id:"end-date",modelValue:A.value.end_date,"onUpdate:modelValue":y[6]||(y[6]=j=>A.value.end_date=j),type:"date",class:"mt-1"},null,8,["modelValue"])])]),l("div",null,[e(t(I),{for:"assignment-status"},{default:s(()=>y[35]||(y[35]=[o("Assignment Status",-1)])),_:1,__:[35]}),e(t(pe),{modelValue:A.value.assignment_status,"onUpdate:modelValue":y[7]||(y[7]=j=>A.value.assignment_status=j)},{default:s(()=>[e(w,{class:"mt-1"},{default:s(()=>[e(ee,{placeholder:"Select status"})]),_:1}),e(J,null,{default:s(()=>[e(G,{value:"active"},{default:s(()=>y[36]||(y[36]=[o("Active",-1)])),_:1,__:[36]}),e(G,{value:"suspended"},{default:s(()=>y[37]||(y[37]=[o("Suspended",-1)])),_:1,__:[37]}),e(G,{value:"closed"},{default:s(()=>y[38]||(y[38]=[o("Closed",-1)])),_:1,__:[38]})]),_:1})]),_:1},8,["modelValue"])])])):E("",!0),e(t(Ke),null,{default:s(()=>[e(t(Y),{variant:"outline",onClick:W},{default:s(()=>y[39]||(y[39]=[o(" Cancel ",-1)])),_:1,__:[39]}),e(t(Y),{onClick:m},{default:s(()=>y[40]||(y[40]=[o(" Save Changes ",-1)])),_:1,__:[40]})]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Ft=[{id:"business_case",name:"Business Case Approval",phase:"Planning",hasBaseline:!1,description:"Business case approved by stakeholders",gateMeetingType:"Gate 1 - Project Initiation"},{id:"project_announced",name:"Project Announced",phase:"Planning",hasBaseline:!1,description:"Public announcement of the project"},{id:"par",name:"PAR",phase:"Planning",hasBaseline:!1,description:"Project Authorization Request approved"},{id:"site_selection",name:"Site Selection",phase:"Planning",hasBaseline:!1,description:"Project site selected and confirmed"},{id:"functional_program",name:"Functional Program Approval",phase:"Planning",hasBaseline:!1,description:"Functional program requirements approved"},{id:"prime_consultant",name:"Prime Consultant/Designer Contract Award",phase:"Planning",hasBaseline:!1,description:"Main design consultant contract awarded"}],Lt=[{id:"schematic_design",name:"Schematic Design Completion",phase:"Design",hasBaseline:!0,description:"Schematic design phase completed",gateMeetingType:"Gate 2 - Design Approval"},{id:"design_development",name:"Design Development Completion",phase:"Design",hasBaseline:!0,description:"Design development phase completed"},{id:"contract_documents",name:"Contract Documents/Pre-Tender Estimate Completion",phase:"Design",hasBaseline:!0,description:"Contract documents and pre-tender estimate completed"}],Gt=[{id:"site_mobilisation",name:"Site/Construction Mobilisation",phase:"Construction",hasBaseline:!0,description:"Construction site mobilization and setup"},{id:"construction_25",name:"25% Construction",phase:"Construction",hasBaseline:!0,description:"25% construction completion milestone",gateMeetingType:"Gate 3 - Construction Progress Review"},{id:"construction_50",name:"50% Construction",phase:"Construction",hasBaseline:!0,description:"50% construction completion milestone",gateMeetingType:"Gate 3 - Construction Progress Review"},{id:"construction_85",name:"85% Construction",phase:"Construction",hasBaseline:!0,description:"85% construction completion milestone",gateMeetingType:"Gate 3 - Construction Progress Review"},{id:"construction_100",name:"100% Construction Completion/Interim Acceptance",phase:"Construction",hasBaseline:!0,description:"Construction completion and interim acceptance"}],qt=[{id:"turnover_occupancy",name:"Turnover/Occupancy",phase:"Post Construction",hasBaseline:!0,description:"Building turnover and occupancy",gateMeetingType:"Gate 4 - Project Completion"},{id:"grand_opening",name:"Grand Opening",phase:"Post Construction",hasBaseline:!1,description:"Official grand opening ceremony"},{id:"total_performance",name:"Total Performance/Completion",phase:"Post Construction",hasBaseline:!0,description:"Total performance and project completion",gateMeetingType:"Gate 4 - Project Completion"}],ln=[...Ft,...Lt,...Gt,...qt];function is(){return{is_na:!1,planned_date:null,actual_date:null,baseline_date:null,notes:""}}function an(){const R={};return ln.forEach(i=>{R[i.id]=is()}),R}function on(R){const i=[];if(!R.is_na&&!R.planned_date&&i.push("Planned date is required when milestone is not marked as N/A"),R.planned_date&&R.actual_date){const c=new Date(R.planned_date);new Date(R.actual_date)<c&&i.push("Actual date cannot be before planned date")}return R.notes&&R.notes.length>500&&i.push("Notes cannot exceed 500 characters"),i}function zt(R){if(R.is_na)return"not-applicable";if(R.actual_date)return"completed";if(!R.planned_date)return"not-started";const i=new Date(R.planned_date);return new Date>i?"overdue":"planned"}function nn(R){const i={"not-applicable":"bg-gray-100 text-gray-600","not-started":"bg-gray-100 text-gray-600",planned:"bg-blue-100 text-blue-700",completed:"bg-green-100 text-green-700",overdue:"bg-red-100 text-red-700"};return i[R]||i["not-started"]}const rn={class:"space-y-4"},dn={class:"flex items-center justify-between"},un={class:"text-md font-semibold"},pn={class:"text-sm text-gray-600"},cn={class:"overflow-x-auto"},mn={class:"w-full"},fn={class:"bg-gray-50 border-b"},gn={key:0,class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-36"},vn={key:1,class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24"},_n={class:"bg-white divide-y divide-gray-200"},yn={class:"px-4 py-4"},bn=["onUpdate:modelValue","onChange","disabled"],xn={class:"px-4 py-4"},wn={class:"text-sm font-medium text-gray-900"},kn={key:0,class:"text-xs text-gray-500 mt-1"},hn={class:"px-4 py-4"},$n={class:"px-4 py-4"},Cn=["onUpdate:modelValue","disabled"],Vn={class:"px-4 py-4"},jn=["onUpdate:modelValue","disabled"],Sn={key:0,class:"px-4 py-4"},Mn=["onUpdate:modelValue","disabled"],Dn={key:1,class:"text-gray-400 text-sm"},En={class:"px-4 py-4"},An=["onUpdate:modelValue","disabled"],Pn={key:0,class:"text-xs text-gray-400 mt-1"},Tn={key:1,class:"px-4 py-4"},Un={key:1,class:"text-gray-400 text-sm"},In={key:0,class:"bg-red-50 border border-red-200 rounded-md p-4"},Nn={class:"flex"},Rn={class:"ml-3"},Bn={class:"mt-2 text-sm text-red-700"},On={class:"list-disc pl-5 space-y-1"},Fn={key:1,class:"bg-green-50 border border-green-200 rounded-md p-4"},Ln={class:"flex"},Gn=fe({__name:"MilestoneGrid",props:{phase:{},milestoneDefinitions:{},milestoneData:{},canEdit:{type:Boolean},viewMode:{default:"approved"}},emits:["update:milestoneData","save-milestones","view-gate-meeting"],setup(R,{emit:i}){const c=R,b=i,n=O(!1),M=O(!1),k=O(!1),B=O([]),A=F(()=>c.milestoneDefinitions.map(f=>({...f,data:c.milestoneData[f.id]||is()}))),V=F(()=>c.milestoneDefinitions.some(f=>f.hasBaseline)),L=F(()=>c.milestoneDefinitions.some(f=>f.gateMeetingType)),Z=()=>{n.value=!0,a()},x=f=>{f.data.is_na&&(f.data.planned_date=null,f.data.actual_date=null,f.data.baseline_date=null,f.data.notes=""),Z()},a=()=>{const f=[];A.value.forEach(r=>{on(r.data).forEach(P=>{f.push(`${r.name}: ${P}`)})}),B.value=f},h=async()=>{if(!(B.value.length>0)){M.value=!0;try{const f={...c.milestoneData};A.value.forEach(r=>{f[r.id]={...r.data}}),b("save-milestones",c.phase,f),b("update:milestoneData",f),n.value=!1,k.value=!0,setTimeout(()=>{k.value=!1},3e3)}catch(f){console.error("Failed to save milestones:",f)}finally{M.value=!1}}},d=f=>{b("view-gate-meeting",f)},v=f=>({"not-applicable":"N/A","not-started":"Not Started",planned:"Planned",completed:"Completed",overdue:"Overdue"})[f]||"Unknown";return Re(()=>c.milestoneData,()=>{a()},{deep:!0,immediate:!0}),Re(()=>c.canEdit,f=>{f||(n.value=!1)}),(f,r)=>(u(),g("div",rn,[l("div",dn,[l("div",null,[l("h4",un,_(f.phase)+" Milestones",1),l("p",pn,"Track "+_(f.phase.toLowerCase())+" phase milestones and dates",1)]),f.canEdit&&n.value?(u(),Q(t(Y),{key:0,onClick:h,disabled:M.value,class:"flex items-center space-x-2"},{default:s(()=>[e(t(Ct),{class:"h-4 w-4"}),l("span",null,_(M.value?"Saving...":"Save Milestones"),1)]),_:1},8,["disabled"])):E("",!0)]),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-0"},{default:s(()=>[l("div",cn,[l("table",mn,[l("thead",fn,[l("tr",null,[r[1]||(r[1]=l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12"}," N/A ",-1)),r[2]||(r[2]=l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[200px]"}," Milestone ",-1)),r[3]||(r[3]=l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32"}," Status ",-1)),r[4]||(r[4]=l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-36"}," Planned Date ",-1)),r[5]||(r[5]=l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-36"}," Actual Date ",-1)),V.value?(u(),g("th",gn,r[0]||(r[0]=[l("span",{class:"text-blue-600"},"Baseline Date",-1)]))):E("",!0),r[6]||(r[6]=l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[200px]"}," Notes ",-1)),L.value?(u(),g("th",vn," Meeting ")):E("",!0)])]),l("tbody",_n,[(u(!0),g(_e,null,ye(A.value,T=>(u(),g("tr",{key:T.id,class:re(["hover:bg-gray-50 transition-colors",{"opacity-50":T.data.is_na}])},[l("td",yn,[Oe(l("input",{type:"checkbox","onUpdate:modelValue":P=>T.data.is_na=P,onChange:P=>x(T),disabled:!f.canEdit,class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded disabled:opacity-50"},null,40,bn),[[ys,T.data.is_na]])]),l("td",xn,[l("div",null,[l("div",wn,_(T.name),1),T.description?(u(),g("div",kn,_(T.description),1)):E("",!0)])]),l("td",hn,[l("span",{class:re(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",t(nn)(t(zt)(T.data))])},_(v(t(zt)(T.data))),3)]),l("td",$n,[Oe(l("input",{type:"date","onUpdate:modelValue":P=>T.data.planned_date=P,onChange:Z,disabled:!f.canEdit||T.data.is_na,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed"},null,40,Cn),[[ze,T.data.planned_date]])]),l("td",Vn,[Oe(l("input",{type:"date","onUpdate:modelValue":P=>T.data.actual_date=P,onChange:Z,disabled:!f.canEdit||T.data.is_na,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed"},null,40,jn),[[ze,T.data.actual_date]])]),V.value?(u(),g("td",Sn,[T.hasBaseline?Oe((u(),g("input",{key:0,type:"date","onUpdate:modelValue":P=>T.data.baseline_date=P,onChange:Z,disabled:!f.canEdit||T.data.is_na,class:"w-full px-2 py-1 text-sm border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed bg-blue-50"},null,40,Mn)),[[ze,T.data.baseline_date]]):(u(),g("span",Dn,"â€”"))])):E("",!0),l("td",En,[Oe(l("textarea",{"onUpdate:modelValue":P=>T.data.notes=P,onInput:Z,disabled:!f.canEdit||T.data.is_na,maxlength:500,rows:"2",placeholder:"Add notes...",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed resize-none"},null,40,An),[[ze,T.data.notes]]),T.data.notes?(u(),g("div",Pn,_(T.data.notes.length)+"/500 ",1)):E("",!0)]),L.value?(u(),g("td",Tn,[T.gateMeetingType?(u(),Q(t(Y),{key:0,variant:"outline",size:"sm",onClick:P=>d(T),class:"text-xs"},{default:s(()=>[e(t(Ue),{class:"h-3 w-3 mr-1"}),r[7]||(r[7]=o(" View ",-1))]),_:2,__:[7]},1032,["onClick"])):(u(),g("span",Un,"â€”"))])):E("",!0)],2))),128))])])])]),_:1})]),_:1}),B.value.length>0?(u(),g("div",In,[l("div",Nn,[e(t(kt),{class:"h-5 w-5 text-red-400"}),l("div",Rn,[r[8]||(r[8]=l("h3",{class:"text-sm font-medium text-red-800"}," Please fix the following issues: ",-1)),l("div",Bn,[l("ul",On,[(u(!0),g(_e,null,ye(B.value,T=>(u(),g("li",{key:T},_(T),1))),128))])])])])])):E("",!0),k.value?(u(),g("div",Fn,[l("div",Ln,[e(t(Se),{class:"h-5 w-5 text-green-400"}),r[9]||(r[9]=l("div",{class:"ml-3"},[l("p",{class:"text-sm font-medium text-green-800"}," Milestones saved successfully! ")],-1))])])):E("",!0)]))}});const gt=Jt(Gn,[["__scopeId","data-v-aa4ec4eb"]]),qn={class:"space-y-6"},zn={class:"flex items-center justify-between"},Hn={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Jn={class:"flex items-center space-x-2"},Wn={class:"text-2xl font-bold"},Xn={class:"flex items-center space-x-2"},Kn={class:"text-2xl font-bold"},Zn={class:"flex items-center space-x-2"},Yn={class:"text-2xl font-bold"},Qn={class:"flex items-center space-x-2"},er={class:"text-2xl font-bold"},tr={key:0,class:"flex justify-center py-8"},sr={key:1,class:"text-center py-8"},lr={class:"text-red-600"},ar={key:0,class:"text-center py-8"},or={key:1,class:"space-y-4"},nr={class:"flex-shrink-0 mt-1"},rr={class:"flex-1 min-w-0"},dr={class:"flex items-center justify-between"},ir={class:"text-sm font-medium text-gray-900"},ur={class:"mt-1 flex items-center space-x-4 text-sm text-gray-500"},pr={class:"flex items-center"},cr={key:0,class:"flex items-center"},mr={key:0,class:"mt-2 text-sm text-gray-700"},fr={key:1,class:"mt-2"},gr={class:"flex items-center space-x-2 text-sm"},vr={class:"text-green-700"},_r={key:0,class:"text-gray-500"},yr={class:"flex-shrink-0"},br=fe({__name:"MilestonesTab_Enhanced",props:{projectId:{},canEdit:{type:Boolean},userRole:{},viewMode:{default:"approved"},projectMilestones:{default:()=>an()}},emits:["meeting-completed","meeting-created","meeting-updated","meeting-deleted","milestones-updated"],setup(R,{emit:i}){const c=R,b=i,{meetings:n,loading:M,error:k,upcomingMeetings:B,overdueMeetings:A,fetchUpcomingMeetings:V,createMeeting:L,updateMeeting:Z,deleteMeeting:x,formatMeetingDate:a,getMeetingStatus:h,getMeetingStatusClass:d}=rs(),{formatDate:v,truncateText:f}=et(),r=O("timeline"),T=O(!1),P=O({gate_type:"",planned_date:"",agenda:""}),ne=O(c.projectMilestones),ge=F(()=>c.canEdit&&["Project Manager","Senior Project Manager","Director","Admin"].includes(c.userRole)),U=F(()=>c.canEdit&&c.viewMode==="draft"),p=F(()=>n.value.filter(se=>se.status==="completed")),m=F(()=>[...n.value].sort((se,S)=>new Date(se.planned_date).getTime()-new Date(S.planned_date).getTime())),W=F(()=>P.value.gate_type&&P.value.planned_date),D=F(()=>Ft.length+Lt.length+Gt.length+qt.length),y=F(()=>{let se=0;return Object.values(ne.value).forEach(S=>{zt(S)==="completed"&&se++}),se}),ee=async()=>{await V({projectId:c.projectId,userRole:c.userRole})},w=async()=>{if(!W.value)return;await L({project_id:c.projectId,gate_type:P.value.gate_type,planned_date:P.value.planned_date,agenda:P.value.agenda||void 0})&&(T.value=!1,P.value={gate_type:"",planned_date:"",agenda:""},b("meeting-created",n.value[n.value.length-1]))},G=se=>{},J=se=>{},j=async se=>{await Z(se.id,{status:"completed",actual_date:new Date().toISOString()})&&b("meeting-completed",se)},ae=async se=>{confirm("Are you sure you want to delete this meeting?")&&await x(se.id)&&b("meeting-deleted",se.id)},N=se=>c.canEdit&&se.status==="scheduled",te=se=>c.canEdit&&se.status==="scheduled",oe=se=>c.canEdit&&["Project Manager","Senior Project Manager","Admin"].includes(c.userRole),ke=se=>({scheduled:Ue,completed:Se,cancelled:kt})[se]||Ue,De=(se,S)=>{if(S==="completed")return"text-green-600";if(S==="cancelled")return"text-red-600";const z=h(se);return{Overdue:"text-red-600",Today:"text-orange-600",Soon:"text-yellow-600",Upcoming:"text-blue-600"}[z]||"text-blue-600"},je=(se,S)=>{if(S==="completed")return"bg-green-100";if(S==="cancelled")return"bg-red-100";const z=h(se);return{Overdue:"bg-red-100",Today:"bg-orange-100",Soon:"bg-yellow-100",Upcoming:"bg-blue-100"}[z]||"bg-blue-100"},ue=(se,S)=>{if(S==="completed")return"border-green-200";if(S==="cancelled")return"border-red-200";const z=h(se);return{Overdue:"border-red-200",Today:"border-orange-200",Soon:"border-yellow-200",Upcoming:"border-blue-200"}[z]||"border-gray-200"},$e=se=>{ne.value=se},be=async(se,S)=>{ne.value={...ne.value,...S},b("milestones-updated",ne.value)},Ae=se=>{if(se.gateMeetingType){r.value="timeline";const S=n.value.find(z=>z.gate_type===se.gateMeetingType);S&&console.log("Found related meeting:",S)}};return Pe(()=>{ee()}),(se,S)=>(u(),g("div",qn,[l("div",zn,[S[9]||(S[9]=l("div",null,[l("h3",{class:"text-lg font-semibold"},"Gate Meetings & Milestones"),l("p",{class:"text-sm text-gray-600"},"Track project milestones and gate meeting progress")],-1)),ge.value?(u(),Q(t(Y),{key:0,onClick:S[0]||(S[0]=z=>T.value=!0),class:"flex items-center space-x-2"},{default:s(()=>[e(t(ds),{class:"h-4 w-4"}),S[8]||(S[8]=l("span",null,"Schedule Meeting",-1))]),_:1,__:[8]})):E("",!0)]),l("div",Hn,[e(t(K),null,{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",Jn,[e(t(Ue),{class:"h-5 w-5 text-blue-600"}),l("div",null,[S[10]||(S[10]=l("p",{class:"text-sm font-medium"},"Total Meetings",-1)),l("p",Wn,_(t(n).length),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",Xn,[e(t(Se),{class:"h-5 w-5 text-green-600"}),l("div",null,[S[11]||(S[11]=l("p",{class:"text-sm font-medium"},"Completed",-1)),l("p",Kn,_(p.value.length),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",Zn,[e(t(ht),{class:"h-5 w-5 text-orange-600"}),l("div",null,[S[12]||(S[12]=l("p",{class:"text-sm font-medium"},"Upcoming",-1)),l("p",Yn,_(t(B).length),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",Qn,[e(t(As),{class:"h-5 w-5 text-purple-600"}),l("div",null,[S[13]||(S[13]=l("p",{class:"text-sm font-medium"},"Milestones",-1)),l("p",er,_(y.value)+"/"+_(D.value),1)])])]),_:1})]),_:1})]),e(t(ls),{value:r.value,"onUpdate:value":S[2]||(S[2]=z=>r.value=z),"default-value":"timeline"},{default:s(()=>[e(t(ss),{class:"grid w-full grid-cols-5"},{default:s(()=>[e(t(Ce),{value:"timeline"},{default:s(()=>S[14]||(S[14]=[o("Timeline",-1)])),_:1,__:[14]}),e(t(Ce),{value:"planning"},{default:s(()=>S[15]||(S[15]=[o("Planning",-1)])),_:1,__:[15]}),e(t(Ce),{value:"design"},{default:s(()=>S[16]||(S[16]=[o("Design",-1)])),_:1,__:[16]}),e(t(Ce),{value:"construction"},{default:s(()=>S[17]||(S[17]=[o("Construction",-1)])),_:1,__:[17]}),e(t(Ce),{value:"post-construction"},{default:s(()=>S[18]||(S[18]=[o("Post Construction",-1)])),_:1,__:[18]})]),_:1}),e(t(Ve),{value:"timeline"},{default:s(()=>[t(M)?(u(),g("div",tr,S[19]||(S[19]=[l("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):t(k)?(u(),g("div",sr,[l("p",lr,_(t(k)),1),e(t(Y),{variant:"outline",onClick:ee,class:"mt-2"},{default:s(()=>S[20]||(S[20]=[o(" Try Again ",-1)])),_:1,__:[20]})])):(u(),Q(t(K),{key:2},{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>S[21]||(S[21]=[o("Gate Meetings Timeline",-1)])),_:1,__:[21]})]),_:1}),e(t(X),null,{default:s(()=>[t(n).length===0?(u(),g("div",ar,[e(t(Ue),{class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),S[23]||(S[23]=l("p",{class:"text-gray-500"},"No gate meetings scheduled yet.",-1)),ge.value?(u(),Q(t(Y),{key:0,variant:"outline",onClick:S[1]||(S[1]=z=>T.value=!0),class:"mt-4"},{default:s(()=>S[22]||(S[22]=[o(" Schedule First Meeting ",-1)])),_:1,__:[22]})):E("",!0)])):(u(),g("div",or,[(u(!0),g(_e,null,ye(m.value,z=>{var Ee;return u(),g("div",{key:z.id,class:re(["flex items-start space-x-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors",ue(z.planned_date,z.status)])},[l("div",nr,[l("div",{class:re(["w-8 h-8 rounded-full flex items-center justify-center",je(z.planned_date,z.status)])},[(u(),Q(Fe(ke(z.status)),{class:re(["h-4 w-4",De(z.planned_date,z.status)])},null,8,["class"]))],2)]),l("div",rr,[l("div",dr,[l("h4",ir,_(z.gate_type),1),l("span",{class:re(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",t(d)(z.planned_date)])},_(t(h)(z.planned_date)),3)]),l("div",ur,[l("span",pr,[e(t(Ue),{class:"h-4 w-4 mr-1"}),o(" "+_(t(a)(z.planned_date)),1)]),(Ee=z.attendees)!=null&&Ee.length?(u(),g("span",cr,[e(t(Qe),{class:"h-4 w-4 mr-1"}),o(" "+_(z.attendees.length)+" attendees ",1)])):E("",!0)]),z.agenda?(u(),g("p",mr,_(t(f)(z.agenda,150)),1)):E("",!0),z.status==="completed"?(u(),g("div",fr,[l("div",gr,[e(t(Se),{class:"h-4 w-4 text-green-600"}),l("span",vr,"Completed on "+_(t(v)(z.actual_date)),1),z.decision?(u(),g("span",_r,"â€¢ Decision: "+_(z.decision),1)):E("",!0)])])):E("",!0)]),l("div",yr,[e(t(nt),null,{default:s(()=>[e(t(rt),{asChild:""},{default:s(()=>[e(t(Y),{variant:"ghost",size:"sm"},{default:s(()=>[e(t($t),{class:"h-4 w-4"})]),_:1})]),_:1}),e(t(dt),{align:"end"},{default:s(()=>[e(t(ce),{onClick:Te=>G(z)},{default:s(()=>[e(t(ot),{class:"h-4 w-4 mr-2"}),S[24]||(S[24]=o(" View Details ",-1))]),_:2,__:[24]},1032,["onClick"]),N(z)?(u(),Q(t(ce),{key:0,onClick:Te=>J(z)},{default:s(()=>[e(t(He),{class:"h-4 w-4 mr-2"}),S[25]||(S[25]=o(" Edit Meeting ",-1))]),_:2,__:[25]},1032,["onClick"])):E("",!0),te(z)?(u(),Q(t(ce),{key:1,onClick:Te=>j(z)},{default:s(()=>[e(t(Se),{class:"h-4 w-4 mr-2"}),S[26]||(S[26]=o(" Mark Complete ",-1))]),_:2,__:[26]},1032,["onClick"])):E("",!0),e(t(Ge)),oe(z)?(u(),Q(t(ce),{key:2,onClick:Te=>ae(z),class:"text-red-600"},{default:s(()=>[e(t(Vt),{class:"h-4 w-4 mr-2"}),S[27]||(S[27]=o(" Delete Meeting ",-1))]),_:2,__:[27]},1032,["onClick"])):E("",!0)]),_:2},1024)]),_:2},1024)])],2)}),128))]))]),_:1})]),_:1}))]),_:1}),e(t(Ve),{value:"planning"},{default:s(()=>[e(gt,{phase:"Planning","milestone-definitions":t(Ft),"milestone-data":ne.value,"can-edit":U.value,"view-mode":se.viewMode,"onUpdate:milestoneData":$e,onSaveMilestones:be,onViewGateMeeting:Ae},null,8,["milestone-definitions","milestone-data","can-edit","view-mode"])]),_:1}),e(t(Ve),{value:"design"},{default:s(()=>[e(gt,{phase:"Design","milestone-definitions":t(Lt),"milestone-data":ne.value,"can-edit":U.value,"view-mode":se.viewMode,"onUpdate:milestoneData":$e,onSaveMilestones:be,onViewGateMeeting:Ae},null,8,["milestone-definitions","milestone-data","can-edit","view-mode"])]),_:1}),e(t(Ve),{value:"construction"},{default:s(()=>[e(gt,{phase:"Construction","milestone-definitions":t(Gt),"milestone-data":ne.value,"can-edit":U.value,"view-mode":se.viewMode,"onUpdate:milestoneData":$e,onSaveMilestones:be,onViewGateMeeting:Ae},null,8,["milestone-definitions","milestone-data","can-edit","view-mode"])]),_:1}),e(t(Ve),{value:"post-construction"},{default:s(()=>[e(gt,{phase:"Post Construction","milestone-definitions":t(qt),"milestone-data":ne.value,"can-edit":U.value,"view-mode":se.viewMode,"onUpdate:milestoneData":$e,onSaveMilestones:be,onViewGateMeeting:Ae},null,8,["milestone-definitions","milestone-data","can-edit","view-mode"])]),_:1})]),_:1},8,["value"]),e(t(Ye),{open:T.value,"onUpdate:open":S[7]||(S[7]=z=>T.value=z)},{default:s(()=>[e(t(Ze),{class:"sm:max-w-md"},{default:s(()=>[e(t(Je),null,{default:s(()=>[e(t(We),null,{default:s(()=>S[28]||(S[28]=[o("Schedule Gate Meeting",-1)])),_:1,__:[28]}),e(t(Xe),null,{default:s(()=>S[29]||(S[29]=[o(" Schedule a new gate meeting for this project. ",-1)])),_:1,__:[29]})]),_:1}),l("form",{onSubmit:xt(w,["prevent"]),class:"space-y-4"},[l("div",null,[S[31]||(S[31]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Gate Type",-1)),Oe(l("select",{"onUpdate:modelValue":S[3]||(S[3]=z=>P.value.gate_type=z),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},S[30]||(S[30]=[l("option",{value:""},"Select Gate Type",-1),l("option",{value:"Gate 1 - Project Initiation"},"Gate 1 - Project Initiation",-1),l("option",{value:"Gate 2 - Design Approval"},"Gate 2 - Design Approval",-1),l("option",{value:"Gate 3 - Construction Progress Review"},"Gate 3 - Construction Progress Review",-1),l("option",{value:"Gate 4 - Project Completion"},"Gate 4 - Project Completion",-1)]),512),[[bs,P.value.gate_type]])]),l("div",null,[S[32]||(S[32]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Planned Date",-1)),Oe(l("input",{"onUpdate:modelValue":S[4]||(S[4]=z=>P.value.planned_date=z),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[ze,P.value.planned_date]])]),l("div",null,[S[33]||(S[33]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Agenda (Optional)",-1)),Oe(l("textarea",{"onUpdate:modelValue":S[5]||(S[5]=z=>P.value.agenda=z),rows:"3",placeholder:"Meeting agenda and topics to discuss...",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[ze,P.value.agenda]])])],32),e(t(Ke),null,{default:s(()=>[e(t(Y),{variant:"outline",onClick:S[6]||(S[6]=z=>T.value=!1)},{default:s(()=>S[34]||(S[34]=[o(" Cancel ",-1)])),_:1,__:[34]}),e(t(Y),{onClick:w,disabled:!W.value},{default:s(()=>S[35]||(S[35]=[o(" Schedule Meeting ",-1)])),_:1,__:[35]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]))}});const xr=Jt(br,[["__scopeId","data-v-c18f3579"]]),wr={class:"space-y-6"},kr={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},hr={class:"flex items-center space-x-2"},$r={class:"text-2xl font-bold text-green-600"},Cr={class:"flex items-center space-x-2"},Vr={class:"text-2xl font-bold text-blue-600"},jr={class:"flex items-center space-x-2"},Sr={class:"text-2xl font-bold text-orange-600"},Mr={class:"flex items-center space-x-2"},Dr={class:"space-y-4"},Er={class:"flex items-center justify-between text-sm"},Ar={class:"font-medium"},Pr={class:"w-full bg-gray-200 rounded-full h-3"},Tr={class:"flex justify-between text-xs text-gray-500"},Ur={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ir={class:"relative mt-1"},Nr={class:"relative mt-1"},Rr={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Br={class:"relative mt-1"},Or={class:"relative mt-1"},Fr={class:"space-y-4"},Lr={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Gr={class:"relative mt-1"},qr={class:"relative mt-1"},zr={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Hr={class:"relative mt-1"},Jr={class:"relative mt-1"},Wr={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Xr={class:"relative mt-1"},Kr={class:"relative mt-1"},Zr={class:"space-y-3"},Yr={class:"flex-shrink-0"},Qr={class:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center"},ed={class:"flex-1 min-w-0"},td={class:"text-sm text-gray-900"},sd={class:"flex items-center space-x-4 text-xs text-gray-500 mt-1"},ld={key:0,class:"font-medium"},ad={key:1,class:"flex items-center justify-end space-x-2"},od=fe({__name:"BudgetTab",props:{project:{},viewMode:{},canEdit:{type:Boolean},budgetHistory:{default:()=>[]}},emits:["update:project","save-changes"],setup(R,{emit:i}){const c=R,b=i,{formatCurrency:n,formatDate:M}=et(),k=O({total_approved_funding:0,current_budget:0,amount_spent:0,...c.project}),B=O({...k.value}),A=F(()=>JSON.stringify(k.value)!==JSON.stringify(B.value)),V=F(()=>k.value.current_budget-k.value.amount_spent),L=F(()=>{const v=V.value;return v<0?"text-red-600":v<k.value.current_budget*.1?"text-orange-600":"text-green-600"}),Z=F(()=>k.value.current_budget?Math.round(k.value.amount_spent/k.value.current_budget*100):0),x=F(()=>{const v=Z.value;return v>=100?"bg-red-500":v>=90?"bg-orange-500":v>=75?"bg-yellow-500":"bg-green-500"}),a=()=>{k.value={...B.value}},h=()=>{const v={};Object.keys(k.value).forEach(f=>{k.value[f]!==B.value[f]&&(v[f]=k.value[f])}),b("save-changes",v),B.value={...k.value}},d=()=>{!k.value.current_budget&&k.value.total_approved_funding&&(k.value.current_budget=k.value.total_approved_funding)};return Re(()=>c.project,v=>{k.value={total_approved_funding:0,current_budget:0,amount_spent:0,...v},B.value={...k.value}},{deep:!0}),Re(k,v=>{b("update:project",{...v})},{deep:!0}),Pe(()=>{k.value={total_approved_funding:0,current_budget:0,amount_spent:0,...c.project},B.value={...k.value}}),(v,f)=>(u(),g("div",wr,[l("div",kr,[e(t(K),null,{default:s(()=>[e(t(X),{class:"p-6"},{default:s(()=>[l("div",hr,[e(t(we),{class:"h-5 w-5 text-green-600"}),l("div",null,[f[11]||(f[11]=l("p",{class:"text-sm font-medium text-gray-600"},"Total Approved",-1)),l("p",$r,_(t(n)(k.value.total_approved_funding)),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-6"},{default:s(()=>[l("div",Cr,[e(t(hs),{class:"h-5 w-5 text-blue-600"}),l("div",null,[f[12]||(f[12]=l("p",{class:"text-sm font-medium text-gray-600"},"Current Budget",-1)),l("p",Vr,_(t(n)(k.value.current_budget)),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-6"},{default:s(()=>[l("div",jr,[e(t(Ps),{class:"h-5 w-5 text-orange-600"}),l("div",null,[f[13]||(f[13]=l("p",{class:"text-sm font-medium text-gray-600"},"Amount Spent",-1)),l("p",Sr,_(t(n)(k.value.amount_spent)),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-6"},{default:s(()=>[l("div",Mr,[e(t(Vs),{class:re(["h-5 w-5",L.value])},null,8,["class"]),l("div",null,[f[14]||(f[14]=l("p",{class:"text-sm font-medium text-gray-600"},"Remaining",-1)),l("p",{class:re(["text-2xl font-bold",L.value])},_(t(n)(V.value)),3)])])]),_:1})]),_:1})]),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>f[15]||(f[15]=[o("Budget Utilization",-1)])),_:1,__:[15]})]),_:1}),e(t(X),null,{default:s(()=>[l("div",Dr,[l("div",Er,[f[16]||(f[16]=l("span",null,"Budget Utilization",-1)),l("span",Ar,_(Z.value)+"%",1)]),l("div",Pr,[l("div",{class:re(["h-3 rounded-full transition-all duration-300",x.value]),style:wt({width:`${Math.min(Z.value,100)}%`})},null,6)]),l("div",Tr,[l("span",null,_(t(n)(0)),1),l("span",null,_(t(n)(k.value.current_budget)),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>f[17]||(f[17]=[o("Budget Information",-1)])),_:1,__:[17]}),v.canEdit?(u(),Q(t(he),{key:1},{default:s(()=>f[19]||(f[19]=[o(" Update budget allocations and financial details. ",-1)])),_:1,__:[19]})):(u(),Q(t(he),{key:0},{default:s(()=>f[18]||(f[18]=[o(" View detailed budget breakdown and financial information. ",-1)])),_:1,__:[18]}))]),_:1}),e(t(X),{class:"space-y-6"},{default:s(()=>[l("div",Ur,[l("div",null,[e(t(I),{for:"total-approved"},{default:s(()=>f[20]||(f[20]=[o("Total Approved Funding *",-1)])),_:1,__:[20]}),l("div",Ir,[e(t(we),{class:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e(t(q),{id:"total-approved",modelValue:k.value.total_approved_funding,"onUpdate:modelValue":f[0]||(f[0]=r=>k.value.total_approved_funding=r),disabled:!v.canEdit,type:"number",min:"0",step:"1000",placeholder:"0",class:"pl-10",onInput:d},null,8,["modelValue","disabled"])])]),l("div",null,[e(t(I),{for:"current-budget"},{default:s(()=>f[21]||(f[21]=[o("Current Budget",-1)])),_:1,__:[21]}),l("div",Nr,[e(t(we),{class:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e(t(q),{id:"current-budget",modelValue:k.value.current_budget,"onUpdate:modelValue":f[1]||(f[1]=r=>k.value.current_budget=r),disabled:!v.canEdit,type:"number",min:"0",step:"1000",placeholder:"0",class:"pl-10",onInput:d},null,8,["modelValue","disabled"])])])]),l("div",Rr,[l("div",null,[e(t(I),{for:"amount-spent"},{default:s(()=>f[22]||(f[22]=[o("Amount Spent",-1)])),_:1,__:[22]}),l("div",Br,[e(t(we),{class:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e(t(q),{id:"amount-spent",modelValue:k.value.amount_spent,"onUpdate:modelValue":f[2]||(f[2]=r=>k.value.amount_spent=r),disabled:!v.canEdit,type:"number",min:"0",step:"1000",placeholder:"0",class:"pl-10",onInput:d},null,8,["modelValue","disabled"])])]),l("div",null,[e(t(I),{for:"eac"},{default:s(()=>f[23]||(f[23]=[o("Estimate at Completion (EAC)",-1)])),_:1,__:[23]}),l("div",Or,[e(t(we),{class:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e(t(q),{id:"eac",modelValue:k.value.eac,"onUpdate:modelValue":f[3]||(f[3]=r=>k.value.eac=r),disabled:!v.canEdit,type:"number",min:"0",step:"1000",placeholder:"0",class:"pl-10"},null,8,["modelValue","disabled"])])])]),l("div",Fr,[f[30]||(f[30]=l("h4",{class:"text-sm font-medium text-gray-900"},"Budget Breakdown",-1)),l("div",Lr,[l("div",null,[e(t(I),{for:"design-budget"},{default:s(()=>f[24]||(f[24]=[o("Design & Engineering",-1)])),_:1,__:[24]}),l("div",Gr,[e(t(we),{class:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e(t(q),{id:"design-budget",modelValue:k.value.design_budget,"onUpdate:modelValue":f[4]||(f[4]=r=>k.value.design_budget=r),disabled:!v.canEdit,type:"number",min:"0",step:"1000",placeholder:"0",class:"pl-10"},null,8,["modelValue","disabled"])])]),l("div",null,[e(t(I),{for:"construction-budget"},{default:s(()=>f[25]||(f[25]=[o("Construction",-1)])),_:1,__:[25]}),l("div",qr,[e(t(we),{class:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e(t(q),{id:"construction-budget",modelValue:k.value.construction_budget,"onUpdate:modelValue":f[5]||(f[5]=r=>k.value.construction_budget=r),disabled:!v.canEdit,type:"number",min:"0",step:"1000",placeholder:"0",class:"pl-10"},null,8,["modelValue","disabled"])])])]),l("div",zr,[l("div",null,[e(t(I),{for:"equipment-budget"},{default:s(()=>f[26]||(f[26]=[o("Equipment & Furnishing",-1)])),_:1,__:[26]}),l("div",Hr,[e(t(we),{class:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e(t(q),{id:"equipment-budget",modelValue:k.value.equipment_budget,"onUpdate:modelValue":f[6]||(f[6]=r=>k.value.equipment_budget=r),disabled:!v.canEdit,type:"number",min:"0",step:"1000",placeholder:"0",class:"pl-10"},null,8,["modelValue","disabled"])])]),l("div",null,[e(t(I),{for:"contingency-budget"},{default:s(()=>f[27]||(f[27]=[o("Contingency",-1)])),_:1,__:[27]}),l("div",Jr,[e(t(we),{class:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e(t(q),{id:"contingency-budget",modelValue:k.value.contingency_budget,"onUpdate:modelValue":f[7]||(f[7]=r=>k.value.contingency_budget=r),disabled:!v.canEdit,type:"number",min:"0",step:"1000",placeholder:"0",class:"pl-10"},null,8,["modelValue","disabled"])])])]),l("div",Wr,[l("div",null,[e(t(I),{for:"management-budget"},{default:s(()=>f[28]||(f[28]=[o("Project Management",-1)])),_:1,__:[28]}),l("div",Xr,[e(t(we),{class:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e(t(q),{id:"management-budget",modelValue:k.value.management_budget,"onUpdate:modelValue":f[8]||(f[8]=r=>k.value.management_budget=r),disabled:!v.canEdit,type:"number",min:"0",step:"1000",placeholder:"0",class:"pl-10"},null,8,["modelValue","disabled"])])]),l("div",null,[e(t(I),{for:"other-budget"},{default:s(()=>f[29]||(f[29]=[o("Other Costs",-1)])),_:1,__:[29]}),l("div",Kr,[e(t(we),{class:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e(t(q),{id:"other-budget",modelValue:k.value.other_budget,"onUpdate:modelValue":f[9]||(f[9]=r=>k.value.other_budget=r),disabled:!v.canEdit,type:"number",min:"0",step:"1000",placeholder:"0",class:"pl-10"},null,8,["modelValue","disabled"])])])])]),l("div",null,[e(t(I),{for:"budget-notes"},{default:s(()=>f[31]||(f[31]=[o("Budget Notes & Assumptions",-1)])),_:1,__:[31]}),e(t(Ne),{id:"budget-notes",modelValue:k.value.budget_notes,"onUpdate:modelValue":f[10]||(f[10]=r=>k.value.budget_notes=r),disabled:!v.canEdit,placeholder:"Additional budget information, assumptions, or notes...",rows:"3",class:"mt-1"},null,8,["modelValue","disabled"])])]),_:1})]),_:1}),v.budgetHistory.length>0?(u(),Q(t(K),{key:0},{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>f[32]||(f[32]=[o("Budget Change History",-1)])),_:1,__:[32]})]),_:1}),e(t(X),null,{default:s(()=>[l("div",Zr,[(u(!0),g(_e,null,ye(v.budgetHistory,r=>(u(),g("div",{key:r.id,class:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg"},[l("div",Yr,[l("div",Qr,[e(t(we),{class:"h-4 w-4 text-blue-600"})])]),l("div",ed,[l("p",td,_(r.description),1),l("div",sd,[l("span",null,_(t(M)(r.date)),1),l("span",null,_(r.user),1),r.amount?(u(),g("span",ld,_(t(n)(r.amount)),1)):E("",!0)])])]))),128))])]),_:1})]),_:1})):E("",!0),v.canEdit?(u(),g("div",ad,[e(t(Y),{variant:"outline",onClick:a},{default:s(()=>f[33]||(f[33]=[o(" Reset Changes ",-1)])),_:1,__:[33]}),e(t(Y),{onClick:h,disabled:!A.value},{default:s(()=>[e(t(Ct),{class:"h-4 w-4 mr-2"}),f[34]||(f[34]=o(" Save Budget ",-1))]),_:1,__:[34]},8,["disabled"])])):E("",!0)]))}}),nd={class:"space-y-6"},rd={class:"flex items-center justify-between"},dd={class:"flex items-center space-x-2"},id={class:"flex items-center space-x-3"},ud={class:"text-sm font-medium"},pd={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},cd={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},md={key:0,class:"text-center py-6"},fd={key:1,class:"space-y-3"},gd={class:"flex-1 min-w-0"},vd={class:"text-sm font-medium text-gray-900 truncate"},_d={class:"text-xs text-gray-500"},yd={key:0,class:"text-center py-6"},bd={key:1,class:"space-y-3"},xd={class:"flex-1 min-w-0"},wd={class:"text-sm font-medium text-gray-900"},kd={class:"text-xs text-gray-500"},hd={class:"flex items-center space-x-1"},$d={class:"flex items-center space-x-4 mb-4"},Cd={class:"flex-1"},Vd={class:"border rounded-lg"},jd={class:"w-full"},Sd={class:"divide-y divide-gray-200"},Md={class:"px-4 py-3"},Dd={class:"flex items-center space-x-2"},Ed={class:"text-sm font-medium"},Ad={class:"px-4 py-3"},Pd={class:"px-4 py-3 text-sm text-gray-500"},Td={class:"px-4 py-3 text-sm text-gray-500"},Ud={class:"px-4 py-3"},Id={class:"flex items-center space-x-1"},Nd=fe({__name:"ReportsTab",props:{projectId:{},canEdit:{type:Boolean},userRole:{}},emits:["document-uploaded","document-deleted","report-generated"],setup(R,{emit:i}){const c=i,{formatDate:b,formatFileSize:n}=et(),M=O(!1),k=O(!1),B=O(""),A=O("all"),V=O(""),L=O({category:"",file:null,description:""}),Z=O([{id:"1",filename:"Project Charter.pdf",type:"pdf",category:"project",size:2048576,uploaded_at:"2024-01-15T10:00:00Z",uploaded_by:"John Smith",url:"/documents/project-charter.pdf"},{id:"2",filename:"Architectural Drawings.dwg",type:"dwg",category:"drawing",size:15728640,uploaded_at:"2024-01-20T14:30:00Z",uploaded_by:"Sarah Johnson",url:"/documents/architectural-drawings.dwg"}]),x=O([{id:"1",title:"Monthly Progress Report - January 2024",type:"progress",created_at:"2024-01-31T16:00:00Z",url:"/reports/progress-jan-2024.pdf"}]),a=F(()=>[...Z.value,...x.value.map(p=>({id:p.id,filename:p.title+".pdf",type:"pdf",category:"reports",size:1024e3,uploaded_at:p.created_at,uploaded_by:"System",url:p.url}))]),h=F(()=>{let p=a.value;if(A.value!=="all"&&(p=p.filter(m=>m.category===A.value)),V.value){const m=V.value.toLowerCase();p=p.filter(W=>W.filename.toLowerCase().includes(m)||W.category.toLowerCase().includes(m))}return p}),d=async p=>{k.value=!0,B.value=p;try{await new Promise(W=>setTimeout(W,2e3));const m={id:Date.now().toString(),title:`${p.replace("-"," ").replace(/\b\w/g,W=>W.toUpperCase())} - ${new Date().toLocaleDateString()}`,type:p,created_at:new Date().toISOString(),url:`/reports/${p}-${Date.now()}.pdf`};x.value.unshift(m),c("report-generated",m)}catch(m){console.error("Error generating report:",m)}finally{k.value=!1,B.value=""}},v=p=>{const m=p.target;m.files&&m.files.length>0&&(L.value.file=m.files[0])},f=async()=>{if(!L.value.file||!L.value.category)return;const p={id:Date.now().toString(),filename:L.value.file.name,type:L.value.file.name.split(".").pop()||"unknown",category:L.value.category,size:L.value.file.size,uploaded_at:new Date().toISOString(),uploaded_by:"Current User",url:`/documents/${L.value.file.name}`};Z.value.unshift(p),M.value=!1,L.value={category:"",file:null,description:""},c("document-uploaded",p)},r=p=>{window.open(p.url,"_blank")},T=p=>{const m=document.createElement("a");m.href=p.url,m.download=p.filename,m.click()},P=async p=>{confirm(`Are you sure you want to delete ${p.filename}?`)&&(Z.value=Z.value.filter(m=>m.id!==p.id),c("document-deleted",p.id))},ne=p=>{window.open(p.url,"_blank")},ge=p=>{const m=document.createElement("a");m.href=p.url,m.download=p.title+".pdf",m.click()},U=p=>({pdf:ve,doc:ve,docx:ve,xls:lt,xlsx:lt,ppt:ve,pptx:ve,txt:ve,dwg:ve,jpg:ve,jpeg:ve,png:ve})[p]||ve;return Pe(()=>{}),(p,m)=>{const W=me("SelectValue"),D=me("SelectTrigger"),y=me("SelectItem"),ee=me("SelectContent");return u(),g("div",nd,[l("div",rd,[m[23]||(m[23]=l("div",null,[l("h3",{class:"text-lg font-semibold"},"Project Reports & Documents"),l("p",{class:"text-sm text-gray-600"},"Generate reports and manage project documentation")],-1)),l("div",dd,[p.canEdit?(u(),Q(t(Y),{key:0,onClick:m[0]||(m[0]=w=>M.value=!0),variant:"outline"},{default:s(()=>[e(t(ks),{class:"h-4 w-4 mr-2"}),m[16]||(m[16]=o(" Upload Document ",-1))]),_:1,__:[16]})):E("",!0),e(t(nt),null,{default:s(()=>[e(t(rt),{asChild:""},{default:s(()=>[e(t(Y),null,{default:s(()=>[e(t(ve),{class:"h-4 w-4 mr-2"}),m[17]||(m[17]=o(" Generate Report ",-1))]),_:1,__:[17]})]),_:1}),e(t(dt),{align:"end"},{default:s(()=>[e(t(ce),{onClick:m[1]||(m[1]=w=>d("project-summary"))},{default:s(()=>[e(t(ve),{class:"h-4 w-4 mr-2"}),m[18]||(m[18]=o(" Project Summary ",-1))]),_:1,__:[18]}),e(t(ce),{onClick:m[2]||(m[2]=w=>d("budget-report"))},{default:s(()=>[e(t(we),{class:"h-4 w-4 mr-2"}),m[19]||(m[19]=o(" Budget Report ",-1))]),_:1,__:[19]}),e(t(ce),{onClick:m[3]||(m[3]=w=>d("milestone-report"))},{default:s(()=>[e(t(Ue),{class:"h-4 w-4 mr-2"}),m[20]||(m[20]=o(" Milestone Report ",-1))]),_:1,__:[20]}),e(t(ce),{onClick:m[4]||(m[4]=w=>d("vendor-report"))},{default:s(()=>[e(t(Qe),{class:"h-4 w-4 mr-2"}),m[21]||(m[21]=o(" Vendor Report ",-1))]),_:1,__:[21]}),e(t(Ge)),e(t(ce),{onClick:m[5]||(m[5]=w=>d("full-report"))},{default:s(()=>[e(t(lt),{class:"h-4 w-4 mr-2"}),m[22]||(m[22]=o(" Complete Project Report ",-1))]),_:1,__:[22]})]),_:1})]),_:1})])]),k.value?(u(),Q(t(K),{key:0},{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",id,[m[25]||(m[25]=l("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"},null,-1)),l("div",null,[l("p",ud,"Generating "+_(B.value)+" report...",1),m[24]||(m[24]=l("p",{class:"text-xs text-gray-500"},"This may take a few moments",-1))])])]),_:1})]),_:1})):E("",!0),l("div",pd,[e(t(K),{class:"cursor-pointer hover:shadow-md transition-shadow",onClick:m[6]||(m[6]=w=>d("project-summary"))},{default:s(()=>[e(t(X),{class:"p-4 text-center"},{default:s(()=>[e(t(ve),{class:"h-8 w-8 text-blue-600 mx-auto mb-2"}),m[26]||(m[26]=l("h4",{class:"text-sm font-medium"},"Project Summary",-1)),m[27]||(m[27]=l("p",{class:"text-xs text-gray-500 mt-1"},"Overview and key metrics",-1))]),_:1,__:[26,27]})]),_:1}),e(t(K),{class:"cursor-pointer hover:shadow-md transition-shadow",onClick:m[7]||(m[7]=w=>d("budget-report"))},{default:s(()=>[e(t(X),{class:"p-4 text-center"},{default:s(()=>[e(t(we),{class:"h-8 w-8 text-green-600 mx-auto mb-2"}),m[28]||(m[28]=l("h4",{class:"text-sm font-medium"},"Budget Report",-1)),m[29]||(m[29]=l("p",{class:"text-xs text-gray-500 mt-1"},"Financial breakdown and spending",-1))]),_:1,__:[28,29]})]),_:1}),e(t(K),{class:"cursor-pointer hover:shadow-md transition-shadow",onClick:m[8]||(m[8]=w=>d("milestone-report"))},{default:s(()=>[e(t(X),{class:"p-4 text-center"},{default:s(()=>[e(t(Ue),{class:"h-8 w-8 text-purple-600 mx-auto mb-2"}),m[30]||(m[30]=l("h4",{class:"text-sm font-medium"},"Milestone Report",-1)),m[31]||(m[31]=l("p",{class:"text-xs text-gray-500 mt-1"},"Progress and timeline status",-1))]),_:1,__:[30,31]})]),_:1}),e(t(K),{class:"cursor-pointer hover:shadow-md transition-shadow",onClick:m[9]||(m[9]=w=>d("vendor-report"))},{default:s(()=>[e(t(X),{class:"p-4 text-center"},{default:s(()=>[e(t(Qe),{class:"h-8 w-8 text-orange-600 mx-auto mb-2"}),m[32]||(m[32]=l("h4",{class:"text-sm font-medium"},"Vendor Report",-1)),m[33]||(m[33]=l("p",{class:"text-xs text-gray-500 mt-1"},"Contractor and vendor details",-1))]),_:1,__:[32,33]})]),_:1})]),l("div",cd,[e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),{class:"flex items-center justify-between"},{default:s(()=>[m[34]||(m[34]=l("span",null,"Project Documents",-1)),e(t(_t),{variant:"secondary"},{default:s(()=>[o(_(Z.value.length),1)]),_:1})]),_:1,__:[34]})]),_:1}),e(t(X),null,{default:s(()=>[Z.value.length===0?(u(),g("div",md,[e(t(ve),{class:"h-8 w-8 text-gray-400 mx-auto mb-2"}),m[35]||(m[35]=l("p",{class:"text-sm text-gray-500"},"No project documents uploaded",-1))])):(u(),g("div",fd,[(u(!0),g(_e,null,ye(Z.value.slice(0,5),w=>(u(),g("div",{key:w.id,class:"flex items-center space-x-3 p-2 hover:bg-gray-50 rounded"},[(u(),Q(Fe(U(w.type)),{class:"h-5 w-5 text-gray-500"})),l("div",gd,[l("p",vd,_(w.filename),1),l("p",_d,_(t(n)(w.size))+" â€¢ "+_(t(b)(w.uploaded_at)),1)]),e(t(Y),{variant:"ghost",size:"sm",onClick:G=>T(w)},{default:s(()=>[e(t(vt),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]))),128)),Z.value.length>5?(u(),Q(t(Y),{key:0,variant:"outline",size:"sm",class:"w-full"},{default:s(()=>[o(" View All Documents ("+_(Z.value.length)+") ",1)]),_:1})):E("",!0)]))]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),{class:"flex items-center justify-between"},{default:s(()=>[m[36]||(m[36]=l("span",null,"Generated Reports",-1)),e(t(_t),{variant:"secondary"},{default:s(()=>[o(_(x.value.length),1)]),_:1})]),_:1,__:[36]})]),_:1}),e(t(X),null,{default:s(()=>[x.value.length===0?(u(),g("div",yd,[e(t(lt),{class:"h-8 w-8 text-gray-400 mx-auto mb-2"}),m[37]||(m[37]=l("p",{class:"text-sm text-gray-500"},"No reports generated yet",-1))])):(u(),g("div",bd,[(u(!0),g(_e,null,ye(x.value.slice(0,5),w=>(u(),g("div",{key:w.id,class:"flex items-center space-x-3 p-2 hover:bg-gray-50 rounded"},[e(t(lt),{class:"h-5 w-5 text-blue-500"}),l("div",xd,[l("p",wd,_(w.title),1),l("p",kd,"Generated "+_(t(b)(w.created_at)),1)]),l("div",hd,[e(t(Y),{variant:"ghost",size:"sm",onClick:G=>ne(w)},{default:s(()=>[e(t(ot),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),e(t(Y),{variant:"ghost",size:"sm",onClick:G=>ge(w)},{default:s(()=>[e(t(vt),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])]))),128)),x.value.length>5?(u(),Q(t(Y),{key:0,variant:"outline",size:"sm",class:"w-full"},{default:s(()=>[o(" View All Reports ("+_(x.value.length)+") ",1)]),_:1})):E("",!0)]))]),_:1})]),_:1})]),e(t(K),null,{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>m[38]||(m[38]=[o("All Documents",-1)])),_:1,__:[38]}),e(t(he),null,{default:s(()=>m[39]||(m[39]=[o(" Manage all project documents and reports in one place ",-1)])),_:1,__:[39]})]),_:1}),e(t(X),null,{default:s(()=>[l("div",$d,[e(t(pe),{modelValue:A.value,"onUpdate:modelValue":m[10]||(m[10]=w=>A.value=w)},{default:s(()=>[e(D,{class:"w-48"},{default:s(()=>[e(W,{placeholder:"Filter by type"})]),_:1}),e(ee,null,{default:s(()=>[e(y,{value:"all"},{default:s(()=>m[40]||(m[40]=[o("All Documents",-1)])),_:1,__:[40]}),e(y,{value:"project"},{default:s(()=>m[41]||(m[41]=[o("Project Documents",-1)])),_:1,__:[41]}),e(y,{value:"reports"},{default:s(()=>m[42]||(m[42]=[o("Generated Reports",-1)])),_:1,__:[42]}),e(y,{value:"contracts"},{default:s(()=>m[43]||(m[43]=[o("Contracts",-1)])),_:1,__:[43]}),e(y,{value:"drawings"},{default:s(()=>m[44]||(m[44]=[o("Drawings",-1)])),_:1,__:[44]}),e(y,{value:"specifications"},{default:s(()=>m[45]||(m[45]=[o("Specifications",-1)])),_:1,__:[45]})]),_:1})]),_:1},8,["modelValue"]),l("div",Cd,[e(t(q),{modelValue:V.value,"onUpdate:modelValue":m[11]||(m[11]=w=>V.value=w),placeholder:"Search documents...",class:"max-w-sm"},null,8,["modelValue"])])]),l("div",Vd,[l("table",jd,[m[46]||(m[46]=l("thead",{class:"bg-gray-50"},[l("tr",null,[l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Name"),l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Type"),l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Size"),l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Uploaded"),l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Actions")])],-1)),l("tbody",Sd,[(u(!0),g(_e,null,ye(h.value,w=>(u(),g("tr",{key:w.id,class:"hover:bg-gray-50"},[l("td",Md,[l("div",Dd,[(u(),Q(Fe(U(w.type)),{class:"h-4 w-4 text-gray-500"})),l("span",Ed,_(w.filename),1)])]),l("td",Ad,[e(t(_t),{variant:"outline"},{default:s(()=>[o(_(w.category||"Document"),1)]),_:2},1024)]),l("td",Pd,_(t(n)(w.size)),1),l("td",Td,_(t(b)(w.uploaded_at)),1),l("td",Ud,[l("div",Id,[e(t(Y),{variant:"ghost",size:"sm",onClick:G=>r(w)},{default:s(()=>[e(t(ot),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),e(t(Y),{variant:"ghost",size:"sm",onClick:G=>T(w)},{default:s(()=>[e(t(vt),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),p.canEdit?(u(),Q(t(Y),{key:0,variant:"ghost",size:"sm",onClick:G=>P(w),class:"text-red-600 hover:text-red-700"},{default:s(()=>[e(t(Vt),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):E("",!0)])])]))),128))])])])]),_:1})]),_:1}),e(t(Ye),{open:M.value,"onUpdate:open":m[15]||(m[15]=w=>M.value=w)},{default:s(()=>[e(t(Ze),{class:"sm:max-w-md"},{default:s(()=>[e(t(Je),null,{default:s(()=>[e(t(We),null,{default:s(()=>m[47]||(m[47]=[o("Upload Document",-1)])),_:1,__:[47]}),e(t(Xe),null,{default:s(()=>m[48]||(m[48]=[o(" Upload a new document to this project. ",-1)])),_:1,__:[48]})]),_:1}),l("form",{onSubmit:xt(f,["prevent"]),class:"space-y-4"},[l("div",null,[m[55]||(m[55]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Document Category",-1)),e(t(pe),{modelValue:L.value.category,"onUpdate:modelValue":m[12]||(m[12]=w=>L.value.category=w),required:""},{default:s(()=>[e(D,null,{default:s(()=>[e(W,{placeholder:"Select category"})]),_:1}),e(ee,null,{default:s(()=>[e(y,{value:"project"},{default:s(()=>m[49]||(m[49]=[o("Project Document",-1)])),_:1,__:[49]}),e(y,{value:"contract"},{default:s(()=>m[50]||(m[50]=[o("Contract",-1)])),_:1,__:[50]}),e(y,{value:"drawing"},{default:s(()=>m[51]||(m[51]=[o("Drawing",-1)])),_:1,__:[51]}),e(y,{value:"specification"},{default:s(()=>m[52]||(m[52]=[o("Specification",-1)])),_:1,__:[52]}),e(y,{value:"report"},{default:s(()=>m[53]||(m[53]=[o("Report",-1)])),_:1,__:[53]}),e(y,{value:"other"},{default:s(()=>m[54]||(m[54]=[o("Other",-1)])),_:1,__:[54]})]),_:1})]),_:1},8,["modelValue"])]),l("div",null,[m[56]||(m[56]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"File",-1)),e(t(q),{type:"file",onChange:v,accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.jpg,.jpeg,.png",required:""}),m[57]||(m[57]=l("p",{class:"text-xs text-gray-500 mt-1"}," Supported formats: PDF, Word, Excel, PowerPoint, Text, Images ",-1))]),l("div",null,[m[58]||(m[58]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Description (Optional)",-1)),e(t(Ne),{modelValue:L.value.description,"onUpdate:modelValue":m[13]||(m[13]=w=>L.value.description=w),rows:"2",placeholder:"Brief description of the document..."},null,8,["modelValue"])])],32),e(t(Ke),null,{default:s(()=>[e(t(Y),{variant:"outline",onClick:m[14]||(m[14]=w=>M.value=!1)},{default:s(()=>m[59]||(m[59]=[o(" Cancel ",-1)])),_:1,__:[59]}),e(t(Y),{onClick:f,disabled:!L.value.file},{default:s(()=>m[60]||(m[60]=[o(" Upload Document ",-1)])),_:1,__:[60]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}});let Be=class us extends Error{constructor(c,b=500,n="Internal Server Error",M){super(c);tt(this,"status");tt(this,"statusText");tt(this,"data");this.name="ApiError",this.status=b,this.statusText=n,this.data=M}static async fromResponse(c){var M;let b,n=c.statusText||"Unknown error";try{b=await c.json(),b.message?n=b.message:(M=b.error)!=null&&M.message&&(n=b.error.message)}catch{}return new us(n,c.status,c.statusText,b)}isNetworkError(){return this.status===0||this.status>=500}isClientError(){return this.status>=400&&this.status<500}isUnauthorized(){return this.status===401}isForbidden(){return this.status===403}isNotFound(){return this.status===404}};class Xt{static getAuthHeaders(){const i={"Content-Type":"application/json"},c=this.getAuthToken();return c&&(i.Authorization=`Bearer ${c}`),i}static getAuthToken(){try{const i=JSON.parse(localStorage.getItem("auth")||"{}");if(i.token)return i.token}catch(i){console.warn("Failed to parse auth store:",i)}return localStorage.getItem("authToken")}static async request(i,c={}){var M;const b=i.startsWith("http")?i:`${this.API_BASE}${i}`,n={headers:this.getAuthHeaders(),...c,headers:{...this.getAuthHeaders(),...c.headers}};try{const k=await fetch(b,n);if(!k.ok)throw await Be.fromResponse(k);const B=await k.json();if(B.success===!1)throw new Be(((M=B.error)==null?void 0:M.message)||B.message||"API request failed",k.status,k.statusText,B);return B.data!==void 0?B.data:B}catch(k){throw k instanceof Be?k:k instanceof Error?new Be(k.message,0,"Network Error",{originalError:k}):new Be("Network error occurred",0,"Network Error",{originalError:k})}}static async get(i,c){let b=i;if(c){const n=new URLSearchParams;Object.entries(c).forEach(([M,k])=>{k!=null&&n.append(M,String(k))}),n.toString()&&(b+=`?${n.toString()}`)}return this.request(b,{method:"GET"})}static async post(i,c){return this.request(i,{method:"POST",body:c?JSON.stringify(c):void 0})}static async put(i,c){return this.request(i,{method:"PUT",body:c?JSON.stringify(c):void 0})}static async patch(i,c){return this.request(i,{method:"PATCH",body:c?JSON.stringify(c):void 0})}static async delete(i){return this.request(i,{method:"DELETE"})}static async upload(i,c,b){const n=new FormData;n.append("file",c),b&&Object.entries(b).forEach(([k,B])=>{n.append(k,String(B))});const M=this.getAuthHeaders();return delete M["Content-Type"],this.request(i,{method:"POST",headers:M,body:n})}static handleError(i){throw i instanceof Be?(i.isUnauthorized()&&console.warn("Unauthorized access - redirecting to login"),i):(console.error("Unexpected error:",i),i instanceof Error?new Be(i.message||"Unknown error"):new Be("An unexpected error occurred"))}}tt(Xt,"API_BASE","http://localhost:3002/api");class Nt extends Xt{static async getAll(i){const c={};i&&Object.entries(i).forEach(([n,M])=>{M!=null&&(c[n]=M)});const b=await this.get("/projects",c);return{projects:Array.isArray(b.data)?b.data:b.data?[b.data]:[],pagination:b.pagination}}static async getById(i){return(await this.get(`/projects/${i}`)).data}static async getMyProjects(){const i=await this.get("/projects/my");return Array.isArray(i.data)?i.data:i.data?[i.data]:[]}static async create(i){return(await this.post("/projects",i)).data}static async update(i,c){return(await this.put(`/projects/${i}`,c)).data}static async delete(i){await this.delete(`/projects/${i}`)}static async search(i,c){const b={q:i};c&&Object.entries(c).forEach(([M,k])=>{k!=null&&(b[M]=k)});const n=await this.get("/projects/search",b);return{projects:Array.isArray(n.data)?n.data:n.data?[n.data]:[],pagination:n.pagination}}static async getStatistics(){return(await this.get("/projects/statistics")).data}static async getTeam(i){return(await this.get(`/projects/${i}/team`)).data}static async addTeamMember(i,c,b){await this.post(`/projects/${i}/team`,{user_id:c,role:b})}static async removeTeamMember(i,c){await this.delete(`/projects/${i}/team/${c}`)}static async uploadDocument(i,c,b){const n={};return b&&(n.document_type=b),(await this.upload(`/projects/${i}/documents`,c,n)).data}static async getDocuments(i){return(await this.get(`/projects/${i}/documents`)).data}static async deleteDocument(i,c){await this.delete(`/projects/${i}/documents/${c}`)}static async exportToCsv(i){const c={format:"csv"};i&&Object.entries(i).forEach(([n,M])=>{M!=null&&(c[n]=M)});const b=await fetch(`${this.API_BASE}/projects/export`,{method:"GET",headers:this.getAuthHeaders(),...c&&{body:new URLSearchParams(c).toString()}});if(!b.ok)throw await ApiError.fromResponse(b);return await b.blob()}}class Ie extends Xt{static async getTasks(i){const c=i?new URLSearchParams(i).toString():"";return this.request(`/api/workflow/tasks${c?`?${c}`:""}`)}static async getTaskById(i){return this.request(`/api/workflow/tasks/${i}`)}static async createTask(i){return this.request("/api/workflow/tasks",{method:"POST",body:JSON.stringify(i)})}static async updateTask(i,c){return this.request(`/api/workflow/tasks/${i}`,{method:"PUT",body:JSON.stringify(c)})}static async deleteTask(i){return this.request(`/api/workflow/tasks/${i}`,{method:"DELETE"})}static async assignTask(i,c){return this.request(`/api/workflow/tasks/${i}/assign`,{method:"POST",body:JSON.stringify({userId:c})})}static async getApprovals(i){const c=i?new URLSearchParams(i).toString():"";return this.request(`/api/workflow/approvals${c?`?${c}`:""}`)}static async getApprovalById(i){return this.request(`/api/workflow/approvals/${i}`)}static async createApproval(i){return this.request("/api/workflow/approvals",{method:"POST",body:JSON.stringify(i)})}static async processApproval(i,c,b){return this.request(`/api/workflow/approvals/${i}/${c}`,{method:"POST",body:JSON.stringify({comments:b})})}static async cancelApproval(i){return this.request(`/api/workflow/approvals/${i}/cancel`,{method:"POST"})}static async getNotifications(){return this.request("/api/workflow/notifications")}static async markNotificationAsRead(i){return this.request(`/api/workflow/notifications/${i}/read`,{method:"POST"})}static async markAllNotificationsAsRead(){return this.request("/api/workflow/notifications/read-all",{method:"POST"})}static async deleteNotification(i){return this.request(`/api/workflow/notifications/${i}`,{method:"DELETE"})}static async getWorkflowMetrics(i){const c=i?`?projectId=${i}`:"";return this.request(`/api/workflow/metrics${c}`)}static async getWorkflowDashboard(){return this.request("/api/workflow/dashboard")}static async bulkUpdateTasks(i){return this.request("/api/workflow/tasks/bulk-update",{method:"POST",body:JSON.stringify({updates:i})})}static async getTaskTemplates(){return this.request("/api/workflow/task-templates")}static async createTaskFromTemplate(i,c,b){return this.request("/api/workflow/tasks/from-template",{method:"POST",body:JSON.stringify({templateId:i,projectId:c,customizations:b})})}static async getApprovalWorkflow(i){return this.request(`/api/workflow/approval-workflows/${i}`)}static async getWorkflowAnalytics(i){return this.request("/api/workflow/analytics",{method:"POST",body:JSON.stringify({timeframe:i})})}static async exportWorkflowData(i,c){return this.request("/api/workflow/export",{method:"POST",body:JSON.stringify({filters:i,format:c}),headers:{...this.getAuthHeaders(),Accept:"application/octet-stream"}})}static async getWorkflowCalendar(i,c){return this.request("/api/workflow/calendar",{method:"POST",body:JSON.stringify({startDate:i,endDate:c})})}}function Rd(){const R=O([]),i=O([]),c=O([]),b=O(!1),n=O(null),M=F(()=>R.value.reduce((U,p)=>(U[p.status]||(U[p.status]=[]),U[p.status].push(p),U),{})),k=F(()=>i.value.reduce((U,p)=>(U[p.status]||(U[p.status]=[]),U[p.status].push(p),U),{})),B=F(()=>c.value.filter(U=>!U.read)),A=F(()=>{const U=new Date;return R.value.filter(p=>p.status!=="completed"&&p.status!=="cancelled"&&new Date(p.dueDate)<U)}),V=F(()=>i.value.filter(U=>U.status==="pending"&&U.priority==="urgent")),L=async U=>{b.value=!0,n.value=null;try{const[p,m,W]=await Promise.all([Ie.getTasks(U),Ie.getApprovals(U),Ie.getNotifications()]);R.value=p,i.value=m,c.value=W}catch(p){n.value=p instanceof Error?p.message:"Failed to fetch workflow items"}finally{b.value=!1}},Z=async U=>{b.value=!0,n.value=null;try{const p=await Ie.createTask(U);return R.value.push(p),p}catch(p){throw n.value=p instanceof Error?p.message:"Failed to create task",p}finally{b.value=!1}},x=async(U,p)=>{b.value=!0,n.value=null;try{const m=await Ie.updateTask(U,p),W=R.value.findIndex(D=>D.id===U);return W!==-1&&(R.value[W]=m),m}catch(m){throw n.value=m instanceof Error?m.message:"Failed to update task",m}finally{b.value=!1}},a=async(U,p)=>{var m;return x(U,{status:"completed",completedAt:new Date().toISOString(),description:p?`${(m=R.value.find(W=>W.id===U))==null?void 0:m.description}

Completion notes: ${p}`:void 0})},h=async U=>{b.value=!0,n.value=null;try{const p=await Ie.createApproval(U);return i.value.push(p),p}catch(p){throw n.value=p instanceof Error?p.message:"Failed to submit for approval",p}finally{b.value=!1}},d=async(U,p,m)=>{b.value=!0,n.value=null;try{const W=await Ie.processApproval(U,p,m),D=i.value.findIndex(y=>y.id===U);return D!==-1&&(i.value[D]=W),W}catch(W){throw n.value=W instanceof Error?W.message:`Failed to ${p} approval`,W}finally{b.value=!1}},v=async U=>{try{await Ie.markNotificationAsRead(U);const p=c.value.findIndex(m=>m.id===U);p!==-1&&(c.value[p].read=!0)}catch(p){n.value=p instanceof Error?p.message:"Failed to mark notification as read"}},f=async()=>{try{await Ie.markAllNotificationsAsRead(),c.value.forEach(U=>{U.read=!0})}catch(U){n.value=U instanceof Error?U.message:"Failed to mark all notifications as read"}},r=U=>{switch(U){case"pending":return"bg-yellow-100 text-yellow-800";case"in_progress":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},T=U=>{switch(U){case"low":return"bg-gray-100 text-gray-800";case"medium":return"bg-blue-100 text-blue-800";case"high":return"bg-orange-100 text-orange-800";case"urgent":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},P=U=>{switch(U){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},ne=U=>{const p=new Date,W=(new Date(U).getTime()-p.getTime())/(1e3*60*60);if(Math.abs(W)<24)return W>0?`Due in ${Math.ceil(W)} hours`:`Overdue by ${Math.ceil(Math.abs(W))} hours`;{const D=Math.ceil(W/24);return D>0?`Due in ${D} days`:`Overdue by ${Math.abs(D)} days`}},ge=U=>U.status!=="completed"&&U.status!=="cancelled"&&new Date(U.dueDate)<new Date;return{tasks:st(R),approvals:st(i),notifications:st(c),loading:st(b),error:st(n),tasksByStatus:M,approvalsByStatus:k,unreadNotifications:B,overdueTasks:A,urgentApprovals:V,fetchWorkflowItems:L,createTask:Z,updateTask:x,completeTask:a,submitForApproval:h,processApproval:d,markNotificationAsRead:v,markAllNotificationsAsRead:f,getTaskStatusClass:r,getPriorityClass:T,getApprovalStatusClass:P,formatWorkflowDate:ne,isTaskOverdue:ge}}const Bd={class:"space-y-6"},Od={class:"bg-white rounded-lg shadow-sm border p-6"},Fd={class:"flex items-center justify-between mb-4"},Ld={class:"flex items-center space-x-2"},Gd={class:"mb-6"},qd={class:"flex items-center justify-between text-sm text-gray-600 mb-2"},zd={class:"w-full bg-gray-200 rounded-full h-2"},Hd={key:0,class:"flex flex-wrap gap-2"},Jd={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Wd={class:"bg-white rounded-lg shadow-sm border p-6"},Xd={key:0,class:"flex justify-center py-4"},Kd={key:1,class:"text-center py-4 text-gray-500"},Zd={key:2,class:"space-y-3"},Yd={class:"flex items-center justify-between mb-2"},Qd={class:"font-medium text-gray-900"},ei={class:"text-sm text-gray-600 mb-2"},ti={class:"flex items-center justify-between text-xs text-gray-500"},si={key:0,class:"mt-3 flex space-x-2"},li=["onClick"],ai=["onClick"],oi={class:"bg-white rounded-lg shadow-sm border p-6"},ni={key:0,class:"text-center py-4 text-gray-500"},ri={key:1,class:"space-y-3"},di={class:"flex items-center justify-between mb-2"},ii={class:"font-medium text-gray-900"},ui={class:"text-sm text-gray-600 mb-2"},pi={key:0},ci={key:0,class:"mt-3 flex space-x-2"},mi=["onClick"],fi=["onClick"],gi={class:"bg-white rounded-lg shadow-sm border p-6"},vi={key:0,class:"text-center py-4 text-gray-500"},_i={key:1,class:"space-y-3"},yi={class:"flex-shrink-0"},bi={class:"text-xs font-medium"},xi={class:"flex-1 min-w-0"},wi={class:"text-sm text-gray-900"},ki={class:"text-xs text-gray-500"},hi={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4"},$i={class:"text-red-700"},Ci=fe({__name:"WorkflowTab",props:{projectId:{},canEdit:{type:Boolean},userRole:{}},setup(R){const i=R,{tasks:c,loading:b,error:n,fetchProjectTasks:M,createTask:k,updateTask:B,completeTask:A,getTasksByStatus:V}=Rd(),{upcomingMeetings:L,formatMeetingDate:Z,getMeetingStatus:x,getMeetingStatusClass:a,fetchProjectMeetings:h,completeMeeting:d,rescheduleMeeting:v}=rs(),f=O(!1),r=O(!1),T=O([]),P=F(()=>V("active")),ne=F(()=>V("completed").length),ge=F(()=>c.value.length),U=F(()=>ge.value>0?Math.round(ne.value/ge.value*100):0),p=F(()=>U.value===100?"Completed":U.value>=75?"Nearly Complete":U.value>=50?"In Progress":U.value>=25?"Getting Started":"Not Started"),m=async()=>{await Promise.all([M(i.projectId),h(i.projectId)])},W=async N=>{try{await A(N),await m()}catch(te){console.error("Failed to complete task:",te)}},D=N=>{console.log("Edit task:",N)},y=async N=>{try{await d(N,{actual_date:new Date().toISOString(),decision:"Approved",notes:"Meeting completed successfully"}),await m()}catch(te){console.error("Failed to complete meeting:",te)}},ee=async N=>{console.log("Reschedule meeting:",N)},w=N=>new Date(N).toLocaleDateString("en-CA",{year:"numeric",month:"short",day:"numeric"}),G=N=>({Completed:"bg-green-100 text-green-800","Nearly Complete":"bg-blue-100 text-blue-800","In Progress":"bg-yellow-100 text-yellow-800","Getting Started":"bg-orange-100 text-orange-800","Not Started":"bg-gray-100 text-gray-800"})[N]||"bg-gray-100 text-gray-800",J=N=>({High:"bg-red-100 text-red-800",Medium:"bg-yellow-100 text-yellow-800",Low:"bg-green-100 text-green-800"})[N]||"bg-gray-100 text-gray-800",j=N=>({task_completed:"bg-green-100 text-green-600",meeting_scheduled:"bg-blue-100 text-blue-600",meeting_completed:"bg-purple-100 text-purple-600",task_created:"bg-yellow-100 text-yellow-600"})[N]||"bg-gray-100 text-gray-600",ae=N=>({task_completed:"âœ“",meeting_scheduled:"ðŸ“…",meeting_completed:"âœ…",task_created:"+"})[N]||"â€¢";return Pe(()=>{m()}),(N,te)=>(u(),g("div",Bd,[l("div",Od,[l("div",Fd,[te[3]||(te[3]=l("h3",{class:"text-lg font-semibold text-gray-900"},"Project Workflow",-1)),l("div",Ld,[te[2]||(te[2]=l("span",{class:"text-sm text-gray-500"},"Status:",-1)),l("span",{class:re([G(p.value),"px-2 py-1 rounded-full text-xs font-medium"])},_(p.value),3)])]),l("div",Gd,[l("div",qd,[te[4]||(te[4]=l("span",null,"Workflow Progress",-1)),l("span",null,_(ne.value)+"/"+_(ge.value)+" tasks completed",1)]),l("div",zd,[l("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:wt({width:`${U.value}%`})},null,4)])]),N.canEdit?(u(),g("div",Hd,[l("button",{onClick:te[0]||(te[0]=oe=>f.value=!0),class:"px-3 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 transition-colors"}," Add Task "),l("button",{onClick:te[1]||(te[1]=oe=>r.value=!0),class:"px-3 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 transition-colors"}," Schedule Meeting "),l("button",{onClick:m,class:"px-3 py-2 bg-gray-600 text-white text-sm rounded-md hover:bg-gray-700 transition-colors"}," Refresh ")])):E("",!0)]),l("div",Jd,[l("div",Wd,[te[6]||(te[6]=l("h4",{class:"text-md font-semibold text-gray-900 mb-4"},"Active Tasks",-1)),t(b)?(u(),g("div",Xd,te[5]||(te[5]=[l("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"},null,-1)]))):P.value.length===0?(u(),g("div",Kd," No active tasks ")):(u(),g("div",Zd,[(u(!0),g(_e,null,ye(P.value,oe=>(u(),g("div",{key:oe.id,class:"border rounded-lg p-4 hover:bg-gray-50 transition-colors"},[l("div",Yd,[l("h5",Qd,_(oe.title),1),l("span",{class:re([J(oe.priority),"px-2 py-1 rounded text-xs font-medium"])},_(oe.priority),3)]),l("p",ei,_(oe.description),1),l("div",ti,[l("span",null,"Due: "+_(w(oe.dueDate)),1),l("span",null,"Assigned to: "+_(oe.assignedTo),1)]),N.canEdit?(u(),g("div",si,[l("button",{onClick:ke=>W(oe.id),class:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded hover:bg-green-200 transition-colors"}," Complete ",8,li),l("button",{onClick:ke=>D(oe),class:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded hover:bg-blue-200 transition-colors"}," Edit ",8,ai)])):E("",!0)]))),128))]))]),l("div",oi,[te[7]||(te[7]=l("h4",{class:"text-md font-semibold text-gray-900 mb-4"},"Upcoming Meetings",-1)),t(L).length===0?(u(),g("div",ni," No upcoming meetings ")):(u(),g("div",ri,[(u(!0),g(_e,null,ye(t(L),oe=>(u(),g("div",{key:oe.id,class:"border rounded-lg p-4 hover:bg-gray-50 transition-colors"},[l("div",di,[l("h5",ii,_(oe.gate_type),1),l("span",{class:re([t(a)(oe.planned_date),"px-2 py-1 rounded text-xs font-medium"])},_(t(x)(oe.planned_date)),3)]),l("div",ui,[l("p",null,"Date: "+_(t(Z)(oe.planned_date)),1),oe.agenda?(u(),g("p",pi,"Agenda: "+_(oe.agenda),1)):E("",!0)]),N.canEdit?(u(),g("div",ci,[l("button",{onClick:ke=>y(oe.id),class:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded hover:bg-green-200 transition-colors"}," Complete ",8,mi),l("button",{onClick:ke=>ee(oe.id),class:"px-2 py-1 bg-yellow-100 text-yellow-700 text-xs rounded hover:bg-yellow-200 transition-colors"}," Reschedule ",8,fi)])):E("",!0)]))),128))]))])]),l("div",gi,[te[8]||(te[8]=l("h4",{class:"text-md font-semibold text-gray-900 mb-4"},"Recent Workflow Activity",-1)),T.value.length===0?(u(),g("div",vi," No recent activity ")):(u(),g("div",_i,[(u(!0),g(_e,null,ye(T.value,oe=>(u(),g("div",{key:oe.id,class:"flex items-start space-x-3 p-3 border rounded-lg"},[l("div",yi,[l("div",{class:re([j(oe.type),"w-8 h-8 rounded-full flex items-center justify-center"])},[l("span",bi,_(ae(oe.type)),1)],2)]),l("div",xi,[l("p",wi,_(oe.description),1),l("p",ki,_(w(oe.createdAt))+" by "+_(oe.user),1)])]))),128))]))]),t(n)?(u(),g("div",hi,[l("p",$i,_(t(n)),1)])):E("",!0)]))}});function ps(){const R=ts(),i=O(!1),c=O(null),b=O(null),n=O([]),M=O([]),k=F(()=>{const w=R.currentUser;return w&&["Project Manager","Senior Project Manager","Director","Admin"].includes(w.role)}),B=F(()=>{const w=R.currentUser;return w?["Project Manager","Senior Project Manager","Director","Admin"].includes(w.role)&&a.value:!1}),A=F(()=>{const w=R.currentUser;return w?["Project Manager","Senior Project Manager","Director","Admin"].includes(w.role)&&a.value:!1}),V=F(()=>{const w=R.currentUser;return w?["Director","Senior Project Manager","Admin"].includes(w.role)&&h.value:!1}),L=F(()=>{const w=R.currentUser;return w?["Director","Senior Project Manager","Admin"].includes(w.role)&&h.value:!1}),Z=F(()=>{const w=R.currentUser;return w?["Project Manager","Senior Project Manager","Director","Admin"].includes(w.role)&&a.value:!1}),x=F(()=>!!R.currentUser),a=F(()=>n.value.some(w=>w.status==="Draft")),h=F(()=>n.value.some(w=>w.status==="PendingApproval")),d=F(()=>n.value.find(w=>w.status==="Draft")),v=F(()=>n.value.find(w=>w.status==="PendingApproval")),f="http://localhost:3002/api/phase2",r=()=>{const w=R.currentUser,G={"Content-Type":"application/json"};return w&&(G["X-User-Id"]=w.id.toString(),G["X-User-Role"]=w.role,G["X-User-Name"]=w.name),G},T=async w=>{i.value=!0,c.value=null;try{const G=await fetch(f,{method:"POST",headers:r(),body:JSON.stringify(w)});if(!G.ok){const j=await G.json();throw new Error(j.error||"Failed to create project")}return(await G.json()).data}catch(G){throw c.value=G.message,G}finally{i.value=!1}},P=async w=>{var G,J;i.value=!0,c.value=null;try{const j=await fetch(`${f}/${w}`,{headers:r()});if(!j.ok){const N=await j.json();throw new Error(((G=N.error)==null?void 0:G.message)||"Failed to get project")}const ae=await j.json();if(ae.success&&((J=ae.data)!=null&&J.project)){const N=ae.data.project;b.value={project:{id:N.id,name:N.projectName||"Red Deer Justice Centre",description:N.projectDescription||"Justice facility construction project"},currentVersion:{name:N.projectName||"Red Deer Justice Centre",description:N.projectDescription||"Justice facility construction project",projectPhase:N.projectPhase||"Construction",region:N.geographicRegion||"Central",totalApprovedFunding:N.totalApprovedFunding||15e6,currentBudget:N.currentBudget||15e6,amountSpent:N.amountSpent||85e5}}}return b.value}catch(j){throw c.value=j.message,j}finally{i.value=!1}},ne=async w=>{var G;i.value=!0,c.value=null;try{const J=await fetch(`${f}/projects/${w}/versions`,{headers:r()});if(!J.ok){const ae=await J.json();throw new Error(((G=ae.error)==null?void 0:G.message)||"Failed to get version history")}const j=await J.json();if(j.success&&j.data){const ae=j.data.map(N=>{var te,oe,ke,De,je,ue,$e,be,Ae,se,S,z,Ee,Te,Le;return{projectVersionId:N.id,projectId:N.project_id,versionNumber:N.version_number,status:N.status,createdBy:N.created_by,createdAt:N.created_at,updatedAt:N.updated_at,submittedBy:N.submitted_by,submittedAt:N.submitted_at,approvedBy:N.approved_by,approvedAt:N.approved_at,rejectedBy:N.rejected_by,rejectedAt:N.rejected_at,rejectionReason:N.rejection_reason,...N.version_data||{},name:((te=N.version_data)==null?void 0:te.name)||((oe=N.version_data)==null?void 0:oe.project_name)||"Project",description:((ke=N.version_data)==null?void 0:ke.description)||"",reportStatus:((De=N.version_data)==null?void 0:De.report_status)||"Active",projectStatus:((je=N.version_data)==null?void 0:je.project_status)||((ue=N.version_data)==null?void 0:ue.status)||"Active",projectPhase:(($e=N.version_data)==null?void 0:$e.project_phase)||((be=N.version_data)==null?void 0:be.phase)||"Planning",totalApprovedFunding:((Ae=N.version_data)==null?void 0:Ae.total_approved_funding)||((se=N.version_data)==null?void 0:se.totalApprovedFunding)||0,currentBudget:((S=N.version_data)==null?void 0:S.current_budget)||((z=N.version_data)==null?void 0:z.currentBudget)||0,eac:((Ee=N.version_data)==null?void 0:Ee.eac)||0,amountSpent:((Te=N.version_data)==null?void 0:Te.amount_spent)||((Le=N.version_data)==null?void 0:Le.amountSpent)||0}});return n.value=ae,ae}return n.value=[],[]}catch(J){return c.value=J.message,n.value=[],[]}finally{i.value=!1}};return{loading:i,error:c,currentProject:b,versions:n,pendingApprovals:M,canCreateDraft:k,canEdit:B,canSubmitForApproval:A,canApprove:V,canReject:L,canDeleteDraft:Z,canViewVersionHistory:x,hasDraftVersion:a,hasPendingVersion:h,latestDraft:d,latestPending:v,createProject:T,getProject:P,getVersionHistory:ne,createDraftVersion:async w=>{var G;i.value=!0,c.value=null;try{const J=await fetch(`http://localhost:3002/api/projects/${w}`,{headers:r()});let j={};if(J.ok){const te=await J.json();te.success&&((G=te.data)!=null&&G.project)&&(j=te.data.project)}const ae=await fetch(`${f}/projects/${w}/versions`,{method:"POST",headers:r(),body:JSON.stringify({versionNumber:n.value.length+1,dataSnapshot:j,changeSummary:"Draft version created"})});if(!ae.ok){const te=await ae.json();throw new Error(te.error||"Failed to create draft version")}const N=await ae.json();return await ne(w),N.data}catch(J){throw c.value=J.message,J}finally{i.value=!1}},updateDraftVersion:async(w,G,J)=>{i.value=!0,c.value=null;try{const j=await fetch(`${f}/${w}/versions/${G}`,{method:"PUT",headers:r(),body:JSON.stringify(J)});if(!j.ok){const N=await j.json();throw new Error(N.error||"Failed to update draft version")}const ae=await j.json();return await ne(w),ae.data}catch(j){throw c.value=j.message,j}finally{i.value=!1}},submitForApproval:async(w,G)=>{i.value=!0,c.value=null;try{const J=await fetch(`${f}/versions/${G}/submit`,{method:"PUT",headers:r()});if(!J.ok){const ae=await J.json();throw new Error(ae.error||"Failed to submit for approval")}const j=await J.json();return await ne(w),await P(w),j.data}catch(J){throw c.value=J.message,J}finally{i.value=!1}},approveVersion:async(w,G)=>{i.value=!0,c.value=null;try{const J=await fetch(`${f}/versions/${G}/approve`,{method:"PUT",headers:r()});if(!J.ok){const ae=await J.json();throw new Error(ae.error||"Failed to approve version")}const j=await J.json();return await ne(w),await P(w),j.data}catch(J){throw c.value=J.message,J}finally{i.value=!1}},rejectVersion:async(w,G,J)=>{i.value=!0,c.value=null;try{const j=await fetch(`${f}/versions/${G}/reject`,{method:"PUT",headers:r(),body:JSON.stringify({rejectionReason:J})});if(!j.ok){const N=await j.json();throw new Error(N.error||"Failed to reject version")}const ae=await j.json();return await ne(w),ae.data}catch(j){throw c.value=j.message,j}finally{i.value=!1}},deleteDraftVersion:async(w,G)=>{i.value=!0,c.value=null;try{const J=await fetch(`${f}/${w}/versions/${G}`,{method:"DELETE",headers:r()});if(!J.ok){const j=await J.json();throw new Error(j.error||"Failed to delete draft version")}return await ne(w),await P(w),!0}catch(J){throw c.value=J.message,J}finally{i.value=!1}},getPendingApprovals:async()=>{i.value=!0,c.value=null;try{const w=await fetch(`${f}/pending-approvals`,{headers:r()});if(!w.ok){const J=await w.json();throw new Error(J.error||"Failed to get pending approvals")}const G=await w.json();return M.value=G.data,G.data}catch(w){throw c.value=w.message,w}finally{i.value=!1}},compareVersions:async(w,G,J)=>{i.value=!0,c.value=null;try{const j=await fetch(`${f}/projects/${w}/versions/compare?currentVersionId=${G}&compareVersionId=${J}`,{headers:r()});if(!j.ok){const N=await j.json();throw new Error(N.error||"Failed to compare versions")}return(await j.json()).data}catch(j){throw c.value=j.message,j}finally{i.value=!1}}}}const Vi={class:"space-y-6"},ji={class:"flex items-center justify-between"},Si={class:"flex items-center space-x-2"},Mi={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Di={class:"flex items-center space-x-2"},Ei={class:"text-2xl font-bold"},Ai={class:"flex items-center space-x-2"},Pi={class:"text-2xl font-bold"},Ti={class:"flex items-center space-x-2"},Ui={class:"text-2xl font-bold"},Ii={class:"flex items-center space-x-2"},Ni={class:"text-2xl font-bold"},Ri={class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},Bi={class:"flex items-center space-x-4"},Oi={class:"text-lg font-medium"},Fi={class:"text-sm text-gray-600"},Li={class:"text-right"},Gi={key:1,class:"flex justify-center py-8"},qi={key:2,class:"text-center py-8"},zi={class:"text-red-600"},Hi={key:0,class:"text-center py-8"},Ji={key:1,class:"space-y-4"},Wi={class:"flex-shrink-0 mt-1"},Xi={class:"flex-1 min-w-0"},Ki={class:"flex items-center justify-between"},Zi={class:"flex items-center space-x-2"},Yi={class:"text-sm font-medium text-gray-900"},Qi={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},eu={class:"mt-1 flex items-center space-x-4 text-sm text-gray-500"},tu={class:"flex items-center"},su={key:0,class:"flex items-center"},lu={key:1,class:"flex items-center"},au={key:0,class:"mt-1 text-sm text-gray-600"},ou={key:1,class:"mt-2 p-2 bg-red-50 border border-red-200 rounded"},nu={class:"text-sm text-red-700"},ru={class:"flex-shrink-0"},du={key:0,class:"flex justify-center py-8"},iu={key:1,class:"text-center py-8"},uu={class:"text-red-600"},pu={key:2,class:"space-y-6"},cu={class:"grid grid-cols-2 gap-4"},mu={class:"bg-red-50 border border-red-200 rounded-lg p-4"},fu={class:"font-medium text-red-900"},gu={class:"text-sm text-red-700"},vu={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 mt-2"},_u={class:"bg-green-50 border border-green-200 rounded-lg p-4"},yu={class:"font-medium text-green-900"},bu={class:"text-sm text-green-700"},xu={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 mt-2"},wu={key:0},ku={class:"bg-gray-50 border rounded-lg p-4"},hu={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center"},$u={class:"text-2xl font-bold text-blue-600"},Cu={class:"text-2xl font-bold text-green-600"},Vu={class:"text-2xl font-bold text-red-600"},ju={key:1},Su={class:"space-y-3"},Mu={class:"flex items-start justify-between"},Du={class:"flex-1"},Eu={class:"mt-2 space-y-2"},Au={key:0,class:"flex items-start space-x-2"},Pu={class:"text-sm text-gray-700"},Tu={key:1,class:"flex items-start space-x-2"},Uu={class:"text-sm text-gray-700"},Iu={key:2,class:"text-center py-8"},Nu=fe({__name:"VersionsTab",props:{projectId:{},canEdit:{type:Boolean},canApprove:{type:Boolean},userRole:{}},emits:["version-created","version-submitted","version-approved","version-rejected","edit-version"],setup(R,{emit:i}){const c=R,b=i,{currentProject:n,versions:M,loading:k,error:B,canCreateDraft:A,canEdit:V,canSubmitForApproval:L,canApprove:Z,canReject:x,canDeleteDraft:a,canViewVersionHistory:h,hasDraftVersion:d,approvedVersions:v,draftVersions:f,submittedVersions:r,createDraft:T,submitForApproval:P,approveVersion:ne,rejectVersion:ge,compareVersions:U,fetchProject:p,fetchVersions:m}=ps(),{formatDate:W,formatStatus:D}=et(),{getVersionStatusClass:y,getVersionStatusIcon:ee}=Wt(),{versionCreated:w,versionSubmitted:G,versionApproved:J,versionRejected:j,error:ae}=Ht(),N=O(!1),te=O(""),oe=O(null),ke=O(!1),De=O(!1),je=O(null),ue=O(null),$e=F(()=>M.value.find(H=>H.is_current)),be=F(()=>d.value?"draft":r.value.length>0?"submitted":"approved"),Ae=F(()=>[...M.value].sort((H,C)=>H.is_current?-1:C.is_current?1:new Date(C.created_at).getTime()-new Date(H.created_at).getTime()));F(()=>M.value.length>1);const se=async()=>{await p(c.projectId),await m(c.projectId)},S=async()=>{try{const H=await T(c.projectId);H&&(w(H.versionNumber||M.value.length),b("version-created"))}catch(H){ae("Failed to Create Draft",H.message||"An error occurred while creating the draft version.")}},z=async()=>{try{const H=M.value.find($=>$.status==="Draft");if(!H){ae("No Draft Found","No draft version available to submit for approval.");return}await P(c.projectId,H.projectVersionId)&&(G(H.versionNumber),b("version-submitted"))}catch(H){ae("Failed to Submit for Approval",H.message||"An error occurred while submitting the version for approval.")}},Ee=async H=>{try{await ne(c.projectId,H.projectVersionId)&&(J(H.versionNumber),b("version-approved"))}catch(C){ae("Failed to Approve Version",C.message||"An error occurred while approving the version.")}},Te=H=>{oe.value=H,te.value="",N.value=!0},Le=async()=>{if(!(!oe.value||!te.value.trim()))try{await ge(c.projectId,oe.value.projectVersionId,te.value)&&(j(oe.value.versionNumber,te.value),N.value=!1,oe.value=null,te.value="",b("version-rejected"))}catch(H){ae("Failed to Reject Version",H.message||"An error occurred while rejecting the version.")}},jt=H=>{b("edit-version",H)},St=async H=>{if(confirm("Are you sure you want to delete this draft version? This action cannot be undone."))try{w(H.version_number,"Draft deleted successfully"),await se()}catch(C){ae("Failed to Delete Draft",C.message||"An error occurred while deleting the draft version.")}},Mt=H=>{},Dt=async H=>{if($e.value){De.value=!0,je.value=null,ke.value=!0;try{const C=await U(c.projectId,H.projectVersionId,$e.value.projectVersionId);ue.value={version1:H,version2:$e.value,differences:C.differences||[]}}catch(C){je.value=C.message||"Failed to compare versions",ae("Comparison Failed",C.message||"Failed to compare versions")}finally{De.value=!1}}},it=H=>{var C;return(C=ue.value)!=null&&C.differences?ue.value.differences.filter($=>$.type===H).length:0},Et=H=>({added:"border-green-200 bg-green-50",modified:"border-yellow-200 bg-yellow-50",removed:"border-red-200 bg-red-50"})[H]||"border-gray-200 bg-gray-50",At=H=>({added:"text-green-900",modified:"text-yellow-900",removed:"text-red-900"})[H]||"text-gray-900",Pt=H=>({added:"bg-green-100 text-green-800",modified:"bg-yellow-100 text-yellow-800",removed:"bg-red-100 text-red-800"})[H]||"bg-gray-100 text-gray-800",Tt=H=>H.replace(/_/g," ").replace(/\b\w/g,C=>C.toUpperCase()),ut=H=>ee(H),pt=H=>({draft:"text-yellow-600",submitted:"text-blue-600",approved:"text-green-600",rejected:"text-red-600"})[H]||"text-gray-600",ct=H=>({draft:"bg-yellow-100",submitted:"bg-blue-100",approved:"bg-green-100",rejected:"bg-red-100"})[H]||"bg-gray-100",Ut=H=>({draft:"Draft in Progress",submitted:"Pending Approval",approved:"Current Version",rejected:"Version Rejected"})[H]||"Unknown Status",It=H=>({draft:"You have unsaved changes that can be edited.",submitted:"Version is awaiting approval from a director.",approved:"This is the current approved version.",rejected:"The submitted version was rejected and needs revision."})[H]||"";return Pe(()=>{se()}),(H,C)=>(u(),g("div",Vi,[l("div",ji,[C[7]||(C[7]=l("div",null,[l("h3",{class:"text-lg font-semibold"},"Project Versions"),l("p",{class:"text-sm text-gray-600"},"Manage project versions and approval workflow")],-1)),l("div",Si,[t(A)&&!t(d)?(u(),Q(t(Y),{key:0,onClick:S,variant:"outline"},{default:s(()=>[e(t(He),{class:"h-4 w-4 mr-2"}),C[5]||(C[5]=o(" Create Draft ",-1))]),_:1,__:[5]})):E("",!0),t(L)?(u(),Q(t(Y),{key:1,onClick:z},{default:s(()=>[e(t(Ot),{class:"h-4 w-4 mr-2"}),C[6]||(C[6]=o(" Submit for Approval ",-1))]),_:1,__:[6]})):E("",!0)])]),l("div",Mi,[e(t(K),null,{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",Di,[e(t(ve),{class:"h-5 w-5 text-blue-600"}),l("div",null,[C[8]||(C[8]=l("p",{class:"text-sm font-medium"},"Total Versions",-1)),l("p",Ei,_(t(M).length),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",Ai,[e(t(Se),{class:"h-5 w-5 text-green-600"}),l("div",null,[C[9]||(C[9]=l("p",{class:"text-sm font-medium"},"Approved",-1)),l("p",Pi,_(t(v).length),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",Ti,[e(t(ht),{class:"h-5 w-5 text-yellow-600"}),l("div",null,[C[10]||(C[10]=l("p",{class:"text-sm font-medium"},"Pending",-1)),l("p",Ui,_(t(r).length),1)])])]),_:1})]),_:1}),e(t(K),null,{default:s(()=>[e(t(X),{class:"p-4"},{default:s(()=>[l("div",Ii,[e(t(He),{class:"h-5 w-5 text-orange-600"}),l("div",null,[C[11]||(C[11]=l("p",{class:"text-sm font-medium"},"Drafts",-1)),l("p",Ni,_(t(f).length),1)])])]),_:1})]),_:1})]),$e.value?(u(),Q(t(K),{key:0},{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>C[12]||(C[12]=[o("Current Version Status",-1)])),_:1,__:[12]})]),_:1}),e(t(X),null,{default:s(()=>[l("div",Ri,[l("div",Bi,[l("div",{class:re(["w-12 h-12 rounded-full flex items-center justify-center",ct(be.value)])},[(u(),Q(Fe(ut(be.value)),{class:re(["h-6 w-6",pt(be.value)])},null,8,["class"]))],2),l("div",null,[l("h4",Oi,_(Ut(be.value)),1),l("p",Fi,_(It(be.value)),1)])]),l("div",Li,[l("span",{class:re(["inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",t(y)(be.value)])},_(t(D)(be.value)),3)])])]),_:1})]),_:1})):E("",!0),t(k)?(u(),g("div",Gi,C[13]||(C[13]=[l("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):t(B)?(u(),g("div",qi,[l("p",zi,_(t(B)),1),e(t(Y),{variant:"outline",onClick:se,class:"mt-2"},{default:s(()=>C[14]||(C[14]=[o(" Try Again ",-1)])),_:1,__:[14]})])):(u(),Q(t(K),{key:3},{default:s(()=>[e(t(de),null,{default:s(()=>[e(t(ie),null,{default:s(()=>C[15]||(C[15]=[o("Version History",-1)])),_:1,__:[15]})]),_:1}),e(t(X),null,{default:s(()=>[t(M).length===0?(u(),g("div",Hi,[e(t(ve),{class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),C[16]||(C[16]=l("p",{class:"text-gray-500"},"No version history available.",-1))])):(u(),g("div",Ji,[(u(!0),g(_e,null,ye(Ae.value,$=>(u(),g("div",{key:$.id,class:re(["flex items-start space-x-4 p-4 border rounded-lg",$.is_current?"border-blue-200 bg-blue-50":"hover:bg-gray-50"])},[l("div",Wi,[l("div",{class:re(["w-10 h-10 rounded-full flex items-center justify-center",ct($.status)])},[(u(),Q(Fe(ut($.status)),{class:re(["h-5 w-5",pt($.status)])},null,8,["class"]))],2)]),l("div",Xi,[l("div",Ki,[l("div",Zi,[l("h4",Yi," Version "+_($.version_number),1),$.is_current?(u(),g("span",Qi," Current ")):E("",!0)]),l("span",{class:re(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",t(y)($.status)])},_(t(D)($.status)),3)]),l("div",eu,[l("span",tu,[e(t(Ue),{class:"h-4 w-4 mr-1"}),o(" Created "+_(t(W)($.created_at)),1)]),$.submitted_at?(u(),g("span",su,[e(t(Ot),{class:"h-4 w-4 mr-1"}),o(" Submitted "+_(t(W)($.submitted_at)),1)])):E("",!0),$.approved_at?(u(),g("span",lu,[e(t(Se),{class:"h-4 w-4 mr-1"}),o(" Approved "+_(t(W)($.approved_at)),1)])):E("",!0)]),$.approved_by?(u(),g("div",au," Approved by "+_($.approved_by),1)):E("",!0),$.rejection_reason?(u(),g("div",ou,[l("p",nu,[C[17]||(C[17]=l("strong",null,"Rejection Reason:",-1)),o(" "+_($.rejection_reason),1)])])):E("",!0)]),l("div",ru,[e(t(nt),null,{default:s(()=>[e(t(rt),{asChild:""},{default:s(()=>[e(t(Y),{variant:"ghost",size:"sm"},{default:s(()=>[e(t($t),{class:"h-4 w-4"})]),_:1})]),_:1}),e(t(dt),{align:"end"},{default:s(()=>[t(V)&&$.status==="Draft"?(u(),Q(t(ce),{key:0,onClick:le=>jt($)},{default:s(()=>[e(t(He),{class:"h-4 w-4 mr-2"}),C[18]||(C[18]=o(" Edit Draft ",-1))]),_:2,__:[18]},1032,["onClick"])):E("",!0),t(a)&&$.status==="Draft"?(u(),Q(t(ce),{key:1,onClick:le=>St($),class:"text-red-600"},{default:s(()=>[e(t(yt),{class:"h-4 w-4 mr-2"}),C[19]||(C[19]=o(" Delete Draft ",-1))]),_:2,__:[19]},1032,["onClick"])):E("",!0),(t(V)||t(a))&&$.status==="Draft"?(u(),Q(t(Ge),{key:2})):E("",!0),e(t(ce),{onClick:le=>Mt($)},{default:s(()=>[e(t(ot),{class:"h-4 w-4 mr-2"}),C[20]||(C[20]=o(" View Version ",-1))]),_:2,__:[20]},1032,["onClick"]),t(h)&&!$.is_current?(u(),Q(t(ce),{key:3,onClick:le=>Dt($)},{default:s(()=>[e(t(Ss),{class:"h-4 w-4 mr-2"}),C[21]||(C[21]=o(" Compare to Current ",-1))]),_:2,__:[21]},1032,["onClick"])):E("",!0),(t(Z)||t(x))&&$.status==="submitted"?(u(),Q(t(Ge),{key:4})):E("",!0),t(Z)&&$.status==="submitted"?(u(),Q(t(ce),{key:5,onClick:le=>Ee($)},{default:s(()=>[e(t(Se),{class:"h-4 w-4 mr-2"}),C[22]||(C[22]=o(" Approve Version ",-1))]),_:2,__:[22]},1032,["onClick"])):E("",!0),t(x)&&$.status==="submitted"?(u(),Q(t(ce),{key:6,onClick:le=>Te($),class:"text-red-600"},{default:s(()=>[e(t(yt),{class:"h-4 w-4 mr-2"}),C[23]||(C[23]=o(" Reject Version ",-1))]),_:2,__:[23]},1032,["onClick"])):E("",!0)]),_:2},1024)]),_:2},1024)])],2))),128))]))]),_:1})]),_:1})),e(t(Ye),{open:N.value,"onUpdate:open":C[2]||(C[2]=$=>N.value=$)},{default:s(()=>[e(t(Ze),{class:"sm:max-w-md"},{default:s(()=>[e(t(Je),null,{default:s(()=>[e(t(We),null,{default:s(()=>C[24]||(C[24]=[o("Reject Version",-1)])),_:1,__:[24]}),e(t(Xe),null,{default:s(()=>C[25]||(C[25]=[o(" Please provide a reason for rejecting this version. ",-1)])),_:1,__:[25]})]),_:1}),l("form",{onSubmit:xt(Le,["prevent"]),class:"space-y-4"},[l("div",null,[C[26]||(C[26]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Rejection Reason",-1)),e(t(Ne),{modelValue:te.value,"onUpdate:modelValue":C[0]||(C[0]=$=>te.value=$),required:"",rows:"4",placeholder:"Explain why this version is being rejected..."},null,8,["modelValue"])])],32),e(t(Ke),null,{default:s(()=>[e(t(Y),{variant:"outline",onClick:C[1]||(C[1]=$=>N.value=!1)},{default:s(()=>C[27]||(C[27]=[o(" Cancel ",-1)])),_:1,__:[27]}),e(t(Y),{variant:"destructive",onClick:Le,disabled:!te.value.trim()},{default:s(()=>C[28]||(C[28]=[o(" Reject Version ",-1)])),_:1,__:[28]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),e(t(Ye),{open:ke.value,"onUpdate:open":C[4]||(C[4]=$=>ke.value=$)},{default:s(()=>[e(t(Ze),{class:"sm:max-w-4xl max-h-[80vh] overflow-y-auto"},{default:s(()=>[e(t(Je),null,{default:s(()=>[e(t(We),null,{default:s(()=>C[29]||(C[29]=[o("Version Comparison",-1)])),_:1,__:[29]}),e(t(Xe),null,{default:s(()=>{var $,le,qe,mt;return[o(" Comparing Version "+_((le=($=ue.value)==null?void 0:$.version1)==null?void 0:le.version_number)+" with Version "+_((mt=(qe=ue.value)==null?void 0:qe.version2)==null?void 0:mt.version_number),1)]}),_:1})]),_:1}),De.value?(u(),g("div",du,C[30]||(C[30]=[l("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):je.value?(u(),g("div",iu,[l("p",uu,_(je.value),1)])):ue.value?(u(),g("div",pu,[l("div",cu,[l("div",mu,[l("h4",fu,"Version "+_(ue.value.version1.version_number),1),l("p",gu,_(t(W)(ue.value.version1.created_at)),1),l("span",vu,_(t(D)(ue.value.version1.status)),1)]),l("div",_u,[l("h4",yu,"Version "+_(ue.value.version2.version_number),1),l("p",bu,_(t(W)(ue.value.version2.created_at)),1),l("span",xu,_(t(D)(ue.value.version2.status)),1)])]),ue.value.differences&&ue.value.differences.length>0?(u(),g("div",wu,[C[34]||(C[34]=l("h4",{class:"font-medium text-gray-900 mb-3"},"Changes Summary",-1)),l("div",ku,[l("div",hu,[l("div",null,[l("p",$u,_(ue.value.differences.length),1),C[31]||(C[31]=l("p",{class:"text-sm text-gray-600"},"Total Changes",-1))]),l("div",null,[l("p",Cu,_(it("added")),1),C[32]||(C[32]=l("p",{class:"text-sm text-gray-600"},"Additions",-1))]),l("div",null,[l("p",Vu,_(it("modified")),1),C[33]||(C[33]=l("p",{class:"text-sm text-gray-600"},"Modifications",-1))])])])])):E("",!0),ue.value.differences&&ue.value.differences.length>0?(u(),g("div",ju,[C[37]||(C[37]=l("h4",{class:"font-medium text-gray-900 mb-3"},"Detailed Changes",-1)),l("div",Su,[(u(!0),g(_e,null,ye(ue.value.differences,($,le)=>(u(),g("div",{key:le,class:re(["border rounded-lg p-4",Et($.type)])},[l("div",Mu,[l("div",Du,[l("h5",{class:re(["font-medium",At($.type)])},_(Tt($.field)),3),l("div",Eu,[$.oldValue?(u(),g("div",Au,[C[35]||(C[35]=l("span",{class:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded"},"OLD",-1)),l("span",Pu,_($.oldValue),1)])):E("",!0),$.newValue?(u(),g("div",Tu,[C[36]||(C[36]=l("span",{class:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded"},"NEW",-1)),l("span",Uu,_($.newValue),1)])):E("",!0)])]),l("span",{class:re(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",Pt($.type)])},_($.type),3)])],2))),128))])])):(u(),g("div",Iu,[e(t(Se),{class:"h-12 w-12 text-green-400 mx-auto mb-4"}),C[38]||(C[38]=l("p",{class:"text-gray-500"},"No differences found between these versions.",-1))]))])):E("",!0),e(t(Ke),null,{default:s(()=>[e(t(Y),{variant:"outline",onClick:C[3]||(C[3]=$=>ke.value=!1)},{default:s(()=>C[39]||(C[39]=[o(" Close ",-1)])),_:1,__:[39]})]),_:1})]),_:1})]),_:1},8,["open"])]))}}),Ru={class:"container mx-auto px-4 py-8"},Bu={key:0,class:"flex justify-center py-8"},Ou={key:2,class:"space-y-6"},Fu={class:"flex items-center space-x-1"},Lu={key:0,class:"inline-flex items-center justify-center w-2 h-2 bg-green-500 rounded-full"},Gu={class:"flex items-center space-x-1"},qu={key:0,class:"inline-flex items-center justify-center w-2 h-2 bg-green-500 rounded-full"},zu={class:"flex items-center space-x-1"},Hu={key:0,class:"inline-flex items-center justify-center w-2 h-2 bg-blue-500 rounded-full"},Ju={class:"mt-6"},g1=fe({__name:"ProjectDetailPage",setup(R){const i=xs(),c=ts(),b=Ht(),n=F(()=>i.params.id),M=O(null),k=O(!1),B=O(null),A=O("overview"),V=O("approved"),L=O([]),Z=O([]),{currentProject:x,versions:a,canCreateDraft:h,canApprove:d,hasDraftVersion:v,hasSubmittedVersion:f,canSubmitForApproval:r,versionStatus:T,getProject:P,createDraftVersion:ne,submitForApproval:ge,approveVersion:U,rejectVersion:p}=ps(),m=F(()=>c.currentUser),W=F(()=>{var $;return V.value==="draft"&&v.value&&(($=x.value)==null?void 0:$.draftVersion)||M.value}),D=F(()=>{var $,le;return((le=($=x.value)==null?void 0:$.currentVersion)==null?void 0:le.version_number)||"v1.0"}),y=F(()=>{const $=m.value;return $?V.value==="draft"&&["Project Manager","Senior Project Manager","Director","Admin"].includes($.role):!1}),ee=F(()=>v.value&&y.value),w=F(()=>{const $=m.value;return $&&["Director","Admin"].includes($.role)}),G=F(()=>v.value),J=F(()=>!1),j=F(()=>!1),ae=F(()=>f.value),N=async()=>{k.value=!0,B.value=null;try{const $=await Nt.getById(n.value);M.value=$,await P(parseInt(n.value)),await te(),await oe()}catch($){B.value=$.message||"Failed to load project",console.error("Error loading project:",$)}finally{k.value=!1}},te=async()=>{L.value=[{id:"1",type:"budget_updated",description:"Budget updated by John Smith",created_at:new Date(Date.now()-864e5).toISOString()},{id:"2",type:"meeting_scheduled",description:"Gate 2 meeting scheduled for next week",created_at:new Date(Date.now()-1728e5).toISOString()}]},oe=async()=>{Z.value=[{id:"1",description:"Initial budget approved",date:"2024-01-15",user:"Director Smith",amount:15e6}]},ke=$=>{V.value=$},De=$=>{V.value==="draft"&&Object.assign(M.value,$)},je=async $=>{try{V.value==="draft"||(await Nt.update(n.value,$),Object.assign(M.value,$))}catch(le){console.error("Error saving changes:",le)}},ue=async()=>{try{await ne(parseInt(n.value)),V.value="draft"}catch($){console.error("Error creating draft:",$)}},$e=async()=>{try{await ge(parseInt(n.value)),V.value="approved"}catch($){console.error("Error submitting for approval:",$)}},be=async()=>{try{const $=a.value.find(le=>le.status==="submitted");$&&await U(parseInt(n.value),$.id)}catch($){console.error("Error approving version:",$)}},Ae=async()=>{const $=prompt("Please provide a reason for rejection:");if($)try{const le=a.value.find(qe=>qe.status==="submitted");le&&await p(parseInt(n.value),le.id,$)}catch(le){console.error("Error rejecting version:",le)}},se=()=>{},S=()=>{window.print()},z=()=>{A.value="versions"},Ee=()=>{},Te=async()=>{if(confirm("Are you sure you want to delete this project? This action cannot be undone."))try{await Nt.delete(n.value),window.history.back()}catch($){console.error("Error deleting project:",$)}},Le=$=>{},jt=$=>{},St=$=>{},Mt=$=>{},Dt=$=>{},it=$=>{},Et=$=>{},At=$=>{},Pt=$=>{},Tt=$=>{},ut=()=>{N(),b.versionCreated(D.value+1)},pt=()=>{N(),b.versionSubmitted(D.value)},ct=()=>{N(),b.versionApproved(D.value)},Ut=()=>{N(),b.versionRejected(D.value,"Please review the feedback and make necessary changes.")},It=$=>{b.taskCompleted("Project task"),console.log("Task completed:",$)},H=$=>{b.taskAssigned($.title||"New task",$.assignedTo||"team member"),console.log("Task created:",$)},C=$=>{b.info("Task Updated",`"${$.title||"Task"}" has been updated.`),console.log("Task updated:",$)};return($,le)=>{var Kt;const qe=me("Loading"),mt=me("ErrorMessage");return u(),g("div",Ru,[k.value?(u(),g("div",Bu,[e(qe,{as:"",LoadingSpinner:"",size:"lg"})])):B.value?(u(),Q(mt,{key:1,message:`Failed to load project: ${B.value}`,onRetry:N},null,8,["message"])):M.value?(u(),g("div",Ou,[e(ol,{project:M.value,"view-mode":V.value,"current-version":D.value,"version-status":t(T),"has-draft-version":t(v),"has-submitted-version":t(f),"has-pending-changes":G.value,"can-edit":y.value,"can-view-draft":ee.value,"can-create-draft":t(h),"can-submit-for-approval":t(r),"can-approve":t(d),"can-delete":w.value,"user-role":((Kt=m.value)==null?void 0:Kt.role)||"","onUpdate:viewMode":ke,onCreateDraft:ue,onSubmitForApproval:$e,onApproveVersion:be,onRejectVersion:Ae,onExportProject:se,onPrintProject:S,onViewHistory:z,onDuplicateProject:Ee,onDeleteProject:Te},null,8,["project","view-mode","current-version","version-status","has-draft-version","has-submitted-version","has-pending-changes","can-edit","can-view-draft","can-create-draft","can-submit-for-approval","can-approve","can-delete","user-role"]),e(t(ls),{modelValue:A.value,"onUpdate:modelValue":le[0]||(le[0]=xe=>A.value=xe),class:"w-full"},{default:s(()=>[e(t(ss),{class:"grid w-full grid-cols-9"},{default:s(()=>[e(t(Ce),{value:"overview"},{default:s(()=>le[1]||(le[1]=[o("Overview",-1)])),_:1,__:[1]}),e(t(Ce),{value:"details"},{default:s(()=>le[2]||(le[2]=[o("Details",-1)])),_:1,__:[2]}),e(t(Ce),{value:"location"},{default:s(()=>le[3]||(le[3]=[o("Location",-1)])),_:1,__:[3]}),e(t(Ce),{value:"vendors"},{default:s(()=>le[4]||(le[4]=[o("Vendors",-1)])),_:1,__:[4]}),e(t(Ce),{value:"milestones"},{default:s(()=>le[5]||(le[5]=[o("Milestones",-1)])),_:1,__:[5]}),e(t(Ce),{value:"budget"},{default:s(()=>[l("div",Fu,[le[6]||(le[6]=l("span",null,"Budget",-1)),J.value?(u(),g("span",Lu)):E("",!0)])]),_:1}),e(t(Ce),{value:"reports"},{default:s(()=>le[7]||(le[7]=[o("Reports",-1)])),_:1,__:[7]}),e(t(Ce),{value:"workflow"},{default:s(()=>[l("div",Gu,[le[8]||(le[8]=l("span",null,"Workflow",-1)),j.value?(u(),g("span",qu)):E("",!0)])]),_:1}),e(t(Ce),{value:"versions"},{default:s(()=>[l("div",zu,[le[9]||(le[9]=l("span",null,"Versions",-1)),ae.value?(u(),g("span",Hu)):E("",!0)])]),_:1})]),_:1}),l("div",Ju,[e(t(Ve),{value:"overview"},{default:s(()=>[e(Il,{project:W.value,"recent-activity":L.value},null,8,["project","recent-activity"])]),_:1}),e(t(Ve),{value:"details"},{default:s(()=>[e(ia,{project:W.value,"view-mode":V.value,"can-edit":y.value,"onUpdate:project":De,onSaveChanges:je},null,8,["project","view-mode","can-edit"])]),_:1}),e(t(Ve),{value:"location"},{default:s(()=>[e(Sa,{project:W.value,"view-mode":V.value,"can-edit":y.value,"onUpdate:project":De,onSaveChanges:je},null,8,["project","view-mode","can-edit"])]),_:1}),e(t(Ve),{value:"vendors"},{default:s(()=>{var xe;return[e(sn,{"project-id":n.value,"can-edit":y.value,"user-role":((xe=m.value)==null?void 0:xe.role)||"",onVendorAdded:Le,onVendorUpdated:jt,onVendorRemoved:St},null,8,["project-id","can-edit","user-role"])]}),_:1}),e(t(Ve),{value:"milestones"},{default:s(()=>{var xe;return[e(xr,{"project-id":n.value,"can-edit":y.value,"user-role":((xe=m.value)==null?void 0:xe.role)||"","view-mode":V.value,onMeetingCompleted:Mt,onMeetingCreated:Dt,onMeetingUpdated:it,onMeetingDeleted:Et},null,8,["project-id","can-edit","user-role","view-mode"])]}),_:1}),e(t(Ve),{value:"budget"},{default:s(()=>[e(od,{project:W.value,"view-mode":V.value,"can-edit":y.value,"budget-history":Z.value,"onUpdate:project":De,onSaveChanges:je},null,8,["project","view-mode","can-edit","budget-history"])]),_:1}),e(t(Ve),{value:"reports"},{default:s(()=>{var xe;return[e(Nd,{"project-id":n.value,"can-edit":y.value,"user-role":((xe=m.value)==null?void 0:xe.role)||"",onDocumentUploaded:At,onDocumentDeleted:Pt,onReportGenerated:Tt},null,8,["project-id","can-edit","user-role"])]}),_:1}),e(t(Ve),{value:"workflow"},{default:s(()=>{var xe;return[e(Ci,{"project-id":n.value,"can-edit":y.value,"user-role":((xe=m.value)==null?void 0:xe.role)||"",onTaskCompleted:It,onTaskCreated:H,onTaskUpdated:C},null,8,["project-id","can-edit","user-role"])]}),_:1}),e(t(Ve),{value:"versions"},{default:s(()=>{var xe;return[e(Nu,{"project-id":n.value,"can-edit":y.value,"can-approve":t(d),"user-role":((xe=m.value)==null?void 0:xe.role)||"",onVersionCreated:ut,onVersionSubmitted:pt,onVersionApproved:ct,onVersionRejected:Ut},null,8,["project-id","can-edit","can-approve","user-role"])]}),_:1})])]),_:1},8,["modelValue"])])):E("",!0),e(t(Xs))])}}});export{g1 as default};
