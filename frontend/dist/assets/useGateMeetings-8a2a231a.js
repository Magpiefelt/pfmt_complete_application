import{g as I,r as m,s as x,h as c}from"./index-61977f9a.js";/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=I("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function H(){const d=m([]),o=m(!1),n=m(null),i=x(),f={"Project Manager":"pm","Senior Project Manager":"spm",Director:"director",Admin:"admin",Vendor:"vendor"},p=c(()=>{const e=i.currentUser;return e&&["Project Manager","Senior Project Manager","Director","Admin"].includes(e.role)}),y=c(()=>{const e=i.currentUser;return e&&["Project Manager","Senior Project Manager","Director","Admin"].includes(e.role)}),v=c(()=>{const e=i.currentUser;return e&&["Senior Project Manager","Director","Admin"].includes(e.role)}),h=c(()=>{const e=i.currentUser;return e&&["Project Manager","Senior Project Manager","Director","Admin"].includes(e.role)}),M=c(()=>{const e=i.currentUser;return e&&["Project Manager","Senior Project Manager","Director","Admin"].includes(e.role)}),j=c(()=>{const e=i.currentUser;return e&&["Project Manager","Senior Project Manager","Director","Admin"].includes(e.role)}),w=c(()=>{const e=i.currentUser;return e&&["Director","Admin"].includes(e.role)}),l=async(e={})=>{o.value=!0,n.value=null;try{const t=await(await fetch("/api/gate-meetings/upcoming")).json();if(t.success){let a=t.data;if(e.userRole&&e.userId){const s=f[e.userRole]||"vendor";s==="director"||s==="admin"?a=t.data:a=t.data.filter($=>$.project_manager_id===e.userId)}e.projectId&&(a=a.filter(s=>s.project_id===e.projectId)),e.status&&(a=a.filter(s=>s.status===e.status)),d.value=a}else n.value=t.message||"Failed to fetch meetings"}catch(r){n.value="Error loading upcoming meetings",console.error("Error loading upcoming meetings:",r)}finally{o.value=!1}},S=e=>{const r=new Date(e),t=new Date,a=r.getTime()-t.getTime(),s=Math.ceil(a/(1e3*60*60*24));return s===0?"Today":s===1?"Tomorrow":s===-1?"Yesterday":s<0?`${Math.abs(s)} days ago`:s<7?`In ${s} days`:r.toLocaleDateString("en-CA",{month:"short",day:"numeric",year:r.getFullYear()!==t.getFullYear()?"numeric":void 0})},u=e=>{const r=new Date(e),t=new Date,a=r.getTime()-t.getTime(),s=Math.ceil(a/(1e3*60*60*24));return s<0?"Overdue":s===0?"Today":s<=3?"Soon":"Upcoming"},T=e=>{switch(u(e)){case"Overdue":return"bg-red-100 text-red-800";case"Today":return"bg-orange-100 text-orange-800";case"Soon":return"bg-yellow-100 text-yellow-800";default:return"bg-blue-100 text-blue-800"}},E=async e=>{o.value=!0,n.value=null;try{const t=await(await fetch("/api/gate-meetings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return t.success?(await l(),!0):(n.value=t.message||"Failed to create meeting",!1)}catch(r){return n.value="Error creating meeting",console.error("Error creating meeting:",r),!1}finally{o.value=!1}},P=async(e,r)=>{o.value=!0,n.value=null;try{const a=await(await fetch(`/api/gate-meetings/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();return a.success?(await l(),!0):(n.value=a.message||"Failed to update meeting",!1)}catch(t){return n.value="Error updating meeting",console.error("Error updating meeting:",t),!1}finally{o.value=!1}},A=async e=>{o.value=!0,n.value=null;try{const t=await(await fetch(`/api/gate-meetings/${e}`,{method:"DELETE"})).json();return t.success?(await l(),!0):(n.value=t.message||"Failed to delete meeting",!1)}catch(r){return n.value="Error deleting meeting",console.error("Error deleting meeting:",r),!1}finally{o.value=!1}},D=async(e,r)=>{o.value=!0,n.value=null;try{const a=await(await fetch(`/api/gate-meetings/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({planned_date:r,status:"scheduled"})})).json();return a.success?(await l(),!0):(n.value=a.message||"Failed to reschedule meeting",!1)}catch(t){return n.value="Error rescheduling meeting",console.error("Error rescheduling meeting:",t),!1}finally{o.value=!1}},C=async(e,r)=>{o.value=!0,n.value=null;try{const a=await(await fetch(`/api/gate-meetings/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"cancelled",notes:r?`Cancelled: ${r}`:"Meeting cancelled"})})).json();return a.success?(await l(),!0):(n.value=a.message||"Failed to cancel meeting",!1)}catch(t){return n.value="Error cancelling meeting",console.error("Error cancelling meeting:",t),!1}finally{o.value=!1}},b=async(e,r)=>{o.value=!0,n.value=null;try{const a=await(await fetch(`/api/gate-meetings/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"completed",actual_date:r.actual_date||new Date().toISOString(),decision:r.decision,notes:r.notes,attendees:r.attendees})})).json();return a.success?(await l(),!0):(n.value=a.message||"Failed to complete meeting",!1)}catch(t){return n.value="Error completing meeting",console.error("Error completing meeting:",t),!1}finally{o.value=!1}},F=async e=>{o.value=!0,n.value=null;try{const t=await(await fetch(`/api/gate-meetings?project_id=${e}`)).json();return t.success?t.data:(n.value=t.message||"Failed to fetch project meetings",[])}catch(r){return n.value="Error loading project meetings",console.error("Error loading project meetings:",r),[]}finally{o.value=!1}},g=c(()=>d.value.filter(e=>e.status==="scheduled")),O=c(()=>g.value.filter(e=>u(e.planned_date)==="Overdue")),_=c(()=>g.value.filter(e=>u(e.planned_date)==="Today")),U=c(()=>g.value.filter(e=>u(e.planned_date)==="Soon"));return{meetings:d,loading:o,error:n,canCreateMeeting:p,canEditMeeting:y,canDeleteMeeting:v,canRescheduleMeeting:h,canCancelMeeting:M,canCompleteMeeting:j,canViewAllMeetings:w,upcomingMeetings:g,overdueMeetings:O,todayMeetings:_,soonMeetings:U,fetchUpcomingMeetings:l,fetchProjectMeetings:F,createMeeting:E,updateMeeting:P,deleteMeeting:A,rescheduleMeeting:D,cancelMeeting:C,completeMeeting:b,formatMeetingDate:S,getMeetingStatus:u,getMeetingStatusClass:T}}export{N as S,H as u};
