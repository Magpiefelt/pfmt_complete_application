import{d as $,o as p,c as P,m as w,n as R,b as t,p as I,q as U,g as i,s as q,v as L,f as E,e as S,w as n,i as o,a as s,l as g,t as c,x as O,y as M,j as F,F as k,h as A,z as H}from"./index-fcefbe48.js";import{c as J,A as x,_ as C}from"./AlbertaText-515bd883.js";import{d as G,_ as K,a as Q,b as W}from"./createLucideIcon-0cf0090d.js";import{f as X,D as Y,a as V,g as B}from"./index-a9baa61f.js";import{M as Z}from"./map-pin-4a4a8a9e.js";import{C as ee}from"./calendar-4612fcaf.js";import{U as te}from"./users-babec7fe.js";import{_ as se,a as ae}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-7165bd6b.js";const z=$({__name:"Badge",props:{variant:{default:"default"}},setup(_){const e=J("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-blue-600 text-white hover:bg-blue-700",secondary:"border-transparent bg-gray-100 text-gray-900 hover:bg-gray-200",destructive:"border-transparent bg-red-600 text-white hover:bg-red-700",outline:"text-gray-900 border-gray-300"}},defaultVariants:{variant:"default"}});return(u,f)=>(p(),P("span",R({class:t(G)(t(e)({variant:u.variant}),u.$attrs.class)},u.$attrs),[w(u.$slots,"default")],16))}}),oe=(_="all")=>{const e=I();U();const u=i(()=>e.filteredProjects),f=i(()=>e.loading),v=i(()=>e.error),r=i(()=>({currentPage:e.currentPage,pageSize:e.pageSize,totalProjects:e.totalProjects,totalPages:e.totalPages,hasNext:e.hasNext,hasPrev:e.hasPrev,goToNextPage:e.goToNextPage,goToPreviousPage:e.goToPreviousPage,goToPage:e.goToPage,setPageSize:e.setPageSize}));return q(()=>_,d=>{e.setFilter(d),e.fetchProjects()},{immediate:!0}),L(()=>{console.log("useProjects mounted, fetching projects"),e.fetchProjects()}),{projects:u,loading:f,error:v,pagination:r,refetch:async()=>{try{await e.fetchProjects(),console.log("✅ Projects refetched successfully")}catch(d){throw console.error("❌ Failed to refetch projects:",d),d}},updateProject:async(d,b)=>await e.updateProject(d,b),addProject:async d=>await e.addProject(d),removeProject:async d=>await e.removeProject(d)}},re={class:"flex items-start justify-between"},ne={class:"flex-1"},ce={class:"flex items-center space-x-2"},ie={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},le={class:"space-y-2"},ue={class:"flex items-center"},de={class:"flex items-center"},pe={class:"flex items-center"},ge={class:"space-y-2"},me={class:"flex items-center"},fe={class:"w-full bg-gray-200 rounded-full h-2"},_e={class:"space-y-2"},ve={class:"flex items-center space-x-2"},he={class:"flex items-center space-x-2"},Pe=$({__name:"ProjectCard",props:{project:{}},setup(_){const e=_,u=E(),f=i(()=>e.project.contractor||"ABC Construction Ltd."),v=i(()=>{var l;return((l=e.project.currentVersion)==null?void 0:l.projectPhase)||e.project.phase||e.project.projectPhase||"Construction"}),r=i(()=>e.project.region||"Central"),a=i(()=>e.project.startDate||e.project.createdAt||"2024-01-15"),m=i(()=>{var l,y;return e.project.projectManager||((y=(l=e.project.currentVersion)==null?void 0:l.team)==null?void 0:y.projectManager)||"Sarah Johnson"}),h=i(()=>{var l;return e.project.reportStatus||((l=e.project.currentVersion)==null?void 0:l.reportStatus)||"Update Required"}),j=i(()=>{var l;return((l=e.project.currentVersion)==null?void 0:l.totalApprovedFunding)||e.project.totalBudget||e.project.totalApprovedFunding||0}),d=i(()=>{var l;return((l=e.project.currentVersion)==null?void 0:l.amountSpent)||e.project.amountSpent||0}),b=i(()=>e.project.scheduleStatus||"On Track"),N=i(()=>e.project.budgetStatus||"On Track"),T=i(()=>j.value===0?0:d.value/j.value*100),D=()=>{u.push(`/projects/${e.project.id}`)};return(l,y)=>(p(),S(t(W),{class:"hover:shadow-md transition-shadow cursor-pointer",onClick:D},{default:n(()=>[o(t(K),null,{default:n(()=>[s("div",re,[s("div",ne,[o(t(x),{tag:"h3",size:"heading-s",mb:"xs"},{default:n(()=>[g(c(l.project.name),1)]),_:1}),o(t(x),{size:"body-s",color:"secondary"},{default:n(()=>[g(c(f.value)+" • "+c(v.value),1)]),_:1})]),s("div",ce,[o(z,{variant:"outline"},{default:n(()=>[g(c(l.project.projectStatus||l.project.status),1)]),_:1}),o(z,{variant:h.value==="Current"?"default":"destructive"},{default:n(()=>[g(c(h.value),1)]),_:1},8,["variant"])])])]),_:1}),o(t(Q),null,{default:n(()=>[s("div",ie,[s("div",le,[s("div",ue,[o(t(Z),{class:"h-4 w-4 mr-2 text-gray-600"}),o(t(x),{size:"body-s",color:"secondary"},{default:n(()=>[g(c(r.value),1)]),_:1})]),s("div",de,[o(t(ee),{class:"h-4 w-4 mr-2 text-gray-600"}),o(t(x),{size:"body-s",color:"secondary"},{default:n(()=>[g("Started "+c(t(X)(a.value)),1)]),_:1})]),s("div",pe,[o(t(te),{class:"h-4 w-4 mr-2 text-gray-600"}),o(t(x),{size:"body-s",color:"secondary"},{default:n(()=>[g("PM: "+c(m.value),1)]),_:1})])]),s("div",ge,[s("div",me,[o(t(Y),{class:"h-4 w-4 mr-2 text-gray-600"}),o(t(x),{size:"body-s"},{default:n(()=>[g(c(t(V)(j.value)),1)]),_:1})]),o(t(x),{size:"body-s",color:"secondary"},{default:n(()=>[g(" Spent: "+c(t(V)(d.value))+" ("+c(T.value.toFixed(1))+"%) ",1)]),_:1}),s("div",fe,[s("div",{class:"bg-blue-600 h-2 rounded-full",style:O({width:`${Math.min(T.value,100)}%`})},null,4)])]),s("div",_e,[s("div",ve,[y[0]||(y[0]=s("span",{class:"text-sm text-gray-600"},"Schedule:",-1)),o(z,{class:M(t(B)(b.value))},{default:n(()=>[g(c(b.value),1)]),_:1},8,["class"])]),s("div",he,[y[1]||(y[1]=s("span",{class:"text-sm text-gray-600"},"Budget:",-1)),o(z,{class:M(t(B)(N.value))},{default:n(()=>[g(c(N.value),1)]),_:1},8,["class"])])])])]),_:1})]),_:1}))}}),je={class:"text-center py-12"},ye={class:"mx-auto h-12 w-12 text-gray-400"},xe={class:"mt-2 text-sm font-medium text-gray-900"},Se={class:"mt-1 text-sm text-gray-500"},$e={key:0,class:"mt-6"},be=$({__name:"EmptyState",props:{title:{},description:{}},setup(_){return(e,u)=>(p(),P("div",je,[s("div",ye,[w(e.$slots,"icon",{},()=>[u[0]||(u[0]=s("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1))])]),s("h3",xe,c(e.title),1),s("p",Se,c(e.description),1),e.$slots.action?(p(),P("div",$e,[w(e.$slots,"action")])):F("",!0)]))}}),ze={class:"flex items-center justify-between"},Ce={class:"flex items-center space-x-2"},we={class:"text-sm text-gray-700"},ke={class:"flex items-center space-x-2"},Ne={class:"flex items-center space-x-1"},Te=$({__name:"Pagination",props:{currentPage:{},totalPages:{},hasNext:{type:Boolean},hasPrev:{type:Boolean},pageSize:{},totalItems:{}},emits:["nextPage","prevPage","pageChange","pageSizeChange"],setup(_){const e=_,u=i(()=>(e.currentPage-1)*e.pageSize+1),f=i(()=>Math.min(e.currentPage*e.pageSize,e.totalItems)),v=i(()=>{const r=[],a=Math.max(1,e.currentPage-2),m=Math.min(e.totalPages,e.currentPage+2);for(let h=a;h<=m;h++)r.push(h);return r});return(r,a)=>(p(),P("div",ze,[s("div",Ce,[s("span",we," Showing "+c(u.value)+" to "+c(f.value)+" of "+c(r.totalItems)+" results ",1)]),s("div",ke,[o(t(C),{onClick:a[0]||(a[0]=m=>r.$emit("prevPage")),disabled:!r.hasPrev,variant:"outline",size:"sm"},{default:n(()=>a[2]||(a[2]=[g(" Previous ",-1)])),_:1,__:[2]},8,["disabled"]),s("div",Ne,[(p(!0),P(k,null,A(v.value,m=>(p(),S(t(C),{key:m,onClick:h=>r.$emit("pageChange",m),variant:m===r.currentPage?"default":"outline",size:"sm",class:"w-8 h-8 p-0"},{default:n(()=>[g(c(m),1)]),_:2},1032,["onClick","variant"]))),128))]),o(t(C),{onClick:a[1]||(a[1]=m=>r.$emit("nextPage")),disabled:!r.hasNext,variant:"outline",size:"sm"},{default:n(()=>a[3]||(a[3]=[g(" Next ",-1)])),_:1,__:[3]},8,["disabled"])])]))}}),Me={class:"space-y-6"},Ve={key:0,class:"flex justify-center py-8"},Be={class:"space-y-4"},Fe=$({__name:"ProjectList",props:{filter:{default:"all"}},emits:["projectSelect"],setup(_,{emit:e}){const u=_,{projects:f,loading:v,error:r,pagination:a,refetch:m}=oe(u.filter);return(h,j)=>(p(),P("div",Me,[t(v)?(p(),P("div",Ve,[o(ae,{size:"lg"})])):t(r)?(p(),S(se,{key:1,message:`Failed to load projects: ${t(r)}`,onRetry:t(m)},null,8,["message","onRetry"])):t(f).length===0&&t(a).totalProjects===0?(p(),S(be,{key:2,title:"No projects found",description:"No projects match the current filter criteria."},{action:n(()=>[o(t(C),{onClick:t(m),variant:"outline"},{default:n(()=>j[0]||(j[0]=[g(" Refresh ",-1)])),_:1,__:[0]},8,["onClick"])]),_:1})):(p(),P(k,{key:3},[s("div",Be,[(p(!0),P(k,null,A(t(f),d=>(p(),S(Pe,{key:d.id,project:d,onSelect:b=>h.$emit("projectSelect",d)},null,8,["project","onSelect"]))),128))]),t(a).totalPages>1?(p(),S(Te,{key:0,"current-page":t(a).currentPage,"total-pages":t(a).totalPages,"has-next":t(a).hasNext,"has-prev":t(a).hasPrev,"page-size":t(a).pageSize,"total-items":t(a).totalProjects,onNextPage:t(a).goToNextPage,onPrevPage:t(a).goToPreviousPage,onPageChange:t(a).goToPage,onPageSizeChange:t(a).setPageSize,class:"mt-6"},null,8,["current-page","total-pages","has-next","has-prev","page-size","total-items","onNextPage","onPrevPage","onPageChange","onPageSizeChange"])):F("",!0)],64))]))}}),Ae={class:"p-6"},He=$({__name:"ProjectsPage",setup(_){const e=H(),u=i(()=>e.query.filter||"all"),f=v=>{console.log("Selected project:",v)};return(v,r)=>(p(),P("div",Ae,[r[0]||(r[0]=s("div",{class:"mb-6"},[s("h2",{class:"text-2xl font-bold text-gray-900"},"Projects"),s("p",{class:"text-gray-600"},"Manage and view project information")],-1)),o(Fe,{filter:u.value,onProjectSelect:f},null,8,["filter"])]))}});export{He as default};
