import{q as L,s as I,h as d,v as E,i as U,d as S,f as q,o as u,e as y,w as i,k as a,a as s,b as t,n as g,t as c,l as b,x as O,p as B,c as v,y as k,F as N,j as D,z as H}from"./index-61977f9a.js";import{_ as J,a as G,b as K,c as C}from"./VirtualScroll.vue_vue_type_style_index_0_scoped_a66a9b3d_lang-c469ee38.js";import{_ as w}from"./Badge.vue_vue_type_script_setup_true_lang-3121b11a.js";import{A as $}from"./AlbertaText-6ea44e06.js";import{f as Q,a as V,g as A,_ as W}from"./LoadingSpinner.vue_vue_type_script_setup_true_lang-f080e4bc.js";import{M as X}from"./map-pin-31ff5a0e.js";import{C as Y}from"./calendar-aaa52559.js";import{U as Z}from"./users-f13f2b3d.js";import{D as ee}from"./dollar-sign-179e4237.js";const te=(h="all")=>{const e=L();I();const r=d(()=>e.filteredProjects),_=d(()=>e.loading),j=d(()=>e.error),l=d(()=>({currentPage:e.currentPage,pageSize:e.pageSize,totalProjects:e.totalProjects,totalPages:e.totalPages,hasNext:e.hasNext,hasPrev:e.hasPrev,goToNextPage:e.goToNextPage,goToPreviousPage:e.goToPreviousPage,goToPage:e.goToPage,setPageSize:e.setPageSize}));return E(()=>h,p=>{e.setFilter(p),e.fetchProjects()},{immediate:!0}),U(()=>{e.fetchProjects()}),{projects:r,loading:_,error:j,pagination:l,refetch:async()=>{try{await e.fetchProjects()}catch(p){throw console.error("❌ Failed to refetch projects:",p),p}},updateProject:async(p,z)=>await e.updateProject(p,z),addProject:async p=>await e.addProject(p),removeProject:async p=>await e.removeProject(p)}},se={class:"flex items-start justify-between"},oe={class:"flex-1"},ae={class:"flex items-center space-x-2"},re={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ne={class:"space-y-2"},ie={class:"flex items-center"},le={class:"flex items-center"},ce={class:"flex items-center"},de={class:"space-y-2"},ue={class:"flex items-center"},pe={class:"w-full bg-gray-200 rounded-full h-2"},ge={class:"space-y-2"},me={class:"flex items-center space-x-2"},_e={class:"flex items-center space-x-2"},fe=S({__name:"ProjectCard",props:{project:{}},setup(h){const e=h,r=q(),_=d(()=>e.project.contractor||"ABC Construction Ltd."),j=d(()=>{var n;return((n=e.project.currentVersion)==null?void 0:n.projectPhase)||e.project.phase||e.project.projectPhase||"Construction"}),l=d(()=>e.project.region||"Central"),o=d(()=>e.project.startDate||e.project.createdAt||"2024-01-15"),m=d(()=>{var n,f;return e.project.projectManager||((f=(n=e.project.currentVersion)==null?void 0:n.team)==null?void 0:f.projectManager)||"Sarah Johnson"}),P=d(()=>{var n;return e.project.reportStatus||((n=e.project.currentVersion)==null?void 0:n.reportStatus)||"Update Required"}),x=d(()=>{var n;return((n=e.project.currentVersion)==null?void 0:n.totalApprovedFunding)||e.project.totalBudget||e.project.totalApprovedFunding||0}),p=d(()=>{var n;return((n=e.project.currentVersion)==null?void 0:n.amountSpent)||e.project.amountSpent||0}),z=d(()=>e.project.scheduleStatus||"On Track"),M=d(()=>e.project.budgetStatus||"On Track"),T=d(()=>x.value===0?0:p.value/x.value*100),R=d(()=>{var n;return e.project.hasPendingDraft||((n=e.project.versions)==null?void 0:n.some(f=>f.status==="PendingApproval"))||!1}),F=()=>{r.push(`/projects/${e.project.id}`)};return(n,f)=>(u(),y(t(K),{class:"hover:shadow-md transition-shadow cursor-pointer",onClick:F},{default:i(()=>[a(t(J),null,{default:i(()=>[s("div",se,[s("div",oe,[a(t($),{tag:"h3",size:"heading-s",mb:"xs"},{default:i(()=>[g(c(n.project.name),1)]),_:1}),a(t($),{size:"body-s",color:"secondary"},{default:i(()=>[g(c(_.value)+" • "+c(j.value),1)]),_:1})]),s("div",ae,[a(t(w),{variant:"outline"},{default:i(()=>[g(c(n.project.projectStatus||n.project.status),1)]),_:1}),a(t(w),{variant:P.value==="Current"?"default":"destructive"},{default:i(()=>[g(c(P.value),1)]),_:1},8,["variant"]),R.value?(u(),y(t(w),{key:0,variant:"secondary",class:"bg-yellow-100 text-yellow-800"},{default:i(()=>f[0]||(f[0]=[g(" Pending Draft ",-1)])),_:1,__:[0]})):b("",!0)])])]),_:1}),a(t(G),null,{default:i(()=>[s("div",re,[s("div",ne,[s("div",ie,[a(t(X),{class:"h-4 w-4 mr-2 text-gray-600"}),a(t($),{size:"body-s",color:"secondary"},{default:i(()=>[g(c(l.value),1)]),_:1})]),s("div",le,[a(t(Y),{class:"h-4 w-4 mr-2 text-gray-600"}),a(t($),{size:"body-s",color:"secondary"},{default:i(()=>[g("Started "+c(t(Q)(o.value)),1)]),_:1})]),s("div",ce,[a(t(Z),{class:"h-4 w-4 mr-2 text-gray-600"}),a(t($),{size:"body-s",color:"secondary"},{default:i(()=>[g("PM: "+c(m.value),1)]),_:1})])]),s("div",de,[s("div",ue,[a(t(ee),{class:"h-4 w-4 mr-2 text-gray-600"}),a(t($),{size:"body-s"},{default:i(()=>[g(c(t(V)(x.value)),1)]),_:1})]),a(t($),{size:"body-s",color:"secondary"},{default:i(()=>[g(" Spent: "+c(t(V)(p.value))+" ("+c(T.value.toFixed(1))+"%) ",1)]),_:1}),s("div",pe,[s("div",{class:"bg-blue-600 h-2 rounded-full",style:O({width:`${Math.min(T.value,100)}%`})},null,4)])]),s("div",ge,[s("div",me,[f[1]||(f[1]=s("span",{class:"text-sm text-gray-600"},"Schedule:",-1)),a(t(w),{class:B(t(A)(z.value))},{default:i(()=>[g(c(z.value),1)]),_:1},8,["class"])]),s("div",_e,[f[2]||(f[2]=s("span",{class:"text-sm text-gray-600"},"Budget:",-1)),a(t(w),{class:B(t(A)(M.value))},{default:i(()=>[g(c(M.value),1)]),_:1},8,["class"])])])])]),_:1})]),_:1}))}}),ve={class:"bg-red-50 border border-red-200 rounded-md p-4"},he={class:"flex"},Pe={class:"ml-3"},je={class:"mt-2 text-sm text-red-700"},ye={key:0,class:"mt-4"},xe=S({__name:"ErrorMessage",props:{message:{},showRetry:{type:Boolean,default:!0}},emits:["retry"],setup(h){return(e,r)=>(u(),v("div",ve,[s("div",he,[r[3]||(r[3]=s("div",{class:"flex-shrink-0"},[s("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),s("div",Pe,[r[2]||(r[2]=s("h3",{class:"text-sm font-medium text-red-800"}," Error ",-1)),s("div",je,c(e.message),1),e.$slots.action||e.showRetry?(u(),v("div",ye,[k(e.$slots,"action",{},()=>[e.showRetry?(u(),y(t(C),{key:0,onClick:r[0]||(r[0]=_=>e.$emit("retry")),variant:"outline",size:"sm"},{default:i(()=>r[1]||(r[1]=[g(" Try Again ",-1)])),_:1,__:[1]})):b("",!0)])])):b("",!0)])])]))}}),$e={class:"text-center py-12"},Se={class:"mx-auto h-12 w-12 text-gray-400"},ze={class:"mt-2 text-sm font-medium text-gray-900"},we={class:"mt-1 text-sm text-gray-500"},Ce={key:0,class:"mt-6"},be=S({__name:"EmptyState",props:{title:{},description:{}},setup(h){return(e,r)=>(u(),v("div",$e,[s("div",Se,[k(e.$slots,"icon",{},()=>[r[0]||(r[0]=s("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1))])]),s("h3",ze,c(e.title),1),s("p",we,c(e.description),1),e.$slots.action?(u(),v("div",Ce,[k(e.$slots,"action")])):b("",!0)]))}}),ke={class:"flex items-center justify-between"},Ne={class:"flex items-center space-x-2"},Me={class:"text-sm text-gray-700"},Te={class:"flex items-center space-x-2"},Be={class:"flex items-center space-x-1"},Ve=S({__name:"Pagination",props:{currentPage:{},totalPages:{},hasNext:{type:Boolean},hasPrev:{type:Boolean},pageSize:{},totalItems:{}},emits:["nextPage","prevPage","pageChange","pageSizeChange"],setup(h){const e=h,r=d(()=>(e.currentPage-1)*e.pageSize+1),_=d(()=>Math.min(e.currentPage*e.pageSize,e.totalItems)),j=d(()=>{const l=[],o=Math.max(1,e.currentPage-2),m=Math.min(e.totalPages,e.currentPage+2);for(let P=o;P<=m;P++)l.push(P);return l});return(l,o)=>(u(),v("div",ke,[s("div",Ne,[s("span",Me," Showing "+c(r.value)+" to "+c(_.value)+" of "+c(l.totalItems)+" results ",1)]),s("div",Te,[a(t(C),{onClick:o[0]||(o[0]=m=>l.$emit("prevPage")),disabled:!l.hasPrev,variant:"outline",size:"sm"},{default:i(()=>o[2]||(o[2]=[g(" Previous ",-1)])),_:1,__:[2]},8,["disabled"]),s("div",Be,[(u(!0),v(N,null,D(j.value,m=>(u(),y(t(C),{key:m,onClick:P=>l.$emit("pageChange",m),variant:m===l.currentPage?"default":"outline",size:"sm",class:"w-8 h-8 p-0"},{default:i(()=>[g(c(m),1)]),_:2},1032,["onClick","variant"]))),128))]),a(t(C),{onClick:o[1]||(o[1]=m=>l.$emit("nextPage")),disabled:!l.hasNext,variant:"outline",size:"sm"},{default:i(()=>o[3]||(o[3]=[g(" Next ",-1)])),_:1,__:[3]},8,["disabled"])])]))}}),Ae={class:"space-y-6"},De={key:0,class:"flex justify-center py-8"},Re={class:"space-y-4"},Fe=S({__name:"ProjectList",props:{filter:{default:"all"}},emits:["projectSelect"],setup(h,{emit:e}){const r=h,{projects:_,loading:j,error:l,pagination:o,refetch:m}=te(r.filter);return(P,x)=>(u(),v("div",Ae,[t(j)?(u(),v("div",De,[a(W,{size:"lg"})])):t(l)?(u(),y(xe,{key:1,message:`Failed to load projects: ${t(l)}`,onRetry:t(m)},null,8,["message","onRetry"])):t(_).length===0&&t(o).totalProjects===0?(u(),y(be,{key:2,title:"No projects found",description:"No projects match the current filter criteria."},{action:i(()=>[a(t(C),{onClick:t(m),variant:"outline"},{default:i(()=>x[0]||(x[0]=[g(" Refresh ",-1)])),_:1,__:[0]},8,["onClick"])]),_:1})):(u(),v(N,{key:3},[s("div",Re,[(u(!0),v(N,null,D(t(_),p=>(u(),y(fe,{key:p.id,project:p,onSelect:z=>P.$emit("projectSelect",p)},null,8,["project","onSelect"]))),128))]),t(o).totalPages>1?(u(),y(Ve,{key:0,"current-page":t(o).currentPage,"total-pages":t(o).totalPages,"has-next":t(o).hasNext,"has-prev":t(o).hasPrev,"page-size":t(o).pageSize,"total-items":t(o).totalProjects,onNextPage:t(o).goToNextPage,onPrevPage:t(o).goToPreviousPage,onPageChange:t(o).goToPage,onPageSizeChange:t(o).setPageSize,class:"mt-6"},null,8,["current-page","total-pages","has-next","has-prev","page-size","total-items","onNextPage","onPrevPage","onPageChange","onPageSizeChange"])):b("",!0)],64))]))}}),Le={class:"p-6"},Qe=S({__name:"ProjectsPage",setup(h){const e=H(),r=d(()=>e.query.filter||"all"),_=j=>{};return(j,l)=>(u(),v("div",Le,[l[0]||(l[0]=s("div",{class:"mb-6"},[s("h2",{class:"text-2xl font-bold text-gray-900"},"Projects"),s("p",{class:"text-gray-600"},"Manage and view project information")],-1)),a(Fe,{filter:r.value,onProjectSelect:_},null,8,["filter"])]))}});export{Qe as default};
